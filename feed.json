{
  "version": "https://jsonfeed.org/version/1.1",
  "title": "zenk's blog",
  "home_page_url": "https://flyginger.top/",
  "feed_url": "https://flyginger.top/feed.json",
  "description": "zenk's blog",
  "author": {
    "name": "zenk"
  },
  "items": [
    {
      "title": "个人介绍",
      "url": "https://flyginger.top/intro/",
      "id": "https://flyginger.top/intro/",
      "content_html": "<h1 id=\"个人介绍\"> 个人介绍</h1>\n<p>hidden now.</p>\n",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": []
    },
    {
      "title": "算法导论1 算法的概念",
      "url": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/1%20%E7%AE%97%E6%B3%95%E7%9A%84%E6%A6%82%E5%BF%B5/",
      "id": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/1%20%E7%AE%97%E6%B3%95%E7%9A%84%E6%A6%82%E5%BF%B5/",
      "content_html": "<h1 id=\"算法导论1-算法的概念\"> 算法导论1 算法的概念</h1>\n<p>通俗地讲，<strong>算法</strong>（algorithm）是以值或一组值作为<strong>输入</strong>（input），<strong>输出</strong>（output）值或一组值的计算步骤，也可以把算法看作解决<strong>计算问题</strong>（computational problem）的工具。举例来说，<strong>排序问题</strong>（sorting problem）的规范定义是：</p>\n<blockquote>\n<p><strong>输入</strong>：含有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个数字的序列 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⟨</span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>⟩</span></span></span></span>。</p>\n<p><strong>输出</strong>：输入序列的某个满足 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.24810799999999997em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.24810799999999997em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.24810799999999997em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.24810799999999997em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>⋯</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.998892em;vertical-align:-0.247em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span> 的排列 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.001892em;vertical-align:-0.25em;\"></span><span>⟨</span><span><span>a</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.24810799999999997em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.24810799999999997em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.247em;\"><span></span></span></span></span></span></span><span>⟩</span></span></span></span>。</p>\n</blockquote>\n<p>当向排序算法输入 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⟨</span><span>31</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>41</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>59</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>26</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>41</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>58</span><span>⟩</span></span></span></span> 时，它应该输出 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⟨</span><span>26</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>31</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>41</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>41</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>58</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>59</span><span>⟩</span></span></span></span>。其中，输入序列 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⟨</span><span>31</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>41</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>59</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>26</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>41</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>58</span><span>⟩</span></span></span></span> 称为排序问题的一个<strong>实例</strong>（instance）。</p>\n<p>当对于每个输入实例，算法都能停止并返回正确结果时，算法就是<strong>正确</strong>（correct）的。正确的算法<strong>解决</strong>（solve）了给定的计算问题。不正确的算法可能在某些输入实例上不能停止，或者虽然停止但返回了错误的结果。</p>\n<p><strong>数据结构</strong>（data structure）能够存储和组织数据，使其便于访问和修改。没有万能的数据结构，因此了解每种数据结构的优点和缺点十分重要。</p>\n<p>解决同一个问题的不同算法往往在效率上有巨大差异。以两个排序算法举例，<strong>插入排序</strong>（insertion sort）可以在大约 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.964108em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span></span></span></span> 步中排序 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个元素，其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是与 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 无关的常数。而<strong>归并排序</strong>（merge sort）可以在大约 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span> 步中排序 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个元素，其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span> 是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.93858em;vertical-align:-0.24414em;\"></span><span><span>lo<span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.20696799999999996em;\"><span style=\"top:-2.4558600000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.24414em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span> 的缩写，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是与 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 无关的常数。插入排序通常有更小的常数，即 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>。虽然在小规模的输入实例上，插入排序更快一些，但是当输入实例的规模增长时，归并排序会反超。这是因为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1000</span></span></span></span> 时， <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span> 只有大约 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>10</span></span></span></span>；而 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1000000</span></span></span></span> 时，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span> 只有大约 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>20</span></span></span></span>。当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 不断增长，最终会有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.964108em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span>。</p>\n<p>以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>3</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>100</span></span></span></span> 举例：</p>\n<p><img src=\"./../img/1-1.png\" alt=\"1-1\" /></p>\n",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": [
        "算法导论"
      ]
    },
    {
      "title": "算法导论10 基础数据结构",
      "url": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/10%20%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/",
      "id": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/10%20%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/",
      "content_html": "<h1 id=\"算法导论10-基础数据结构\"> 算法导论10 基础数据结构</h1>\n<p>集合是数学和计算机科学中常用的概念。算法中的集合往往是<strong>动态</strong>（dynamic）的：算法经常对集合进行添加新数据，删除旧数据等操作。某些动态集合把元素的某一个属性当作<strong>键</strong>（key），用以区分不同的元素。元素中除了键的其他数据称为<strong>卫星数据</strong>（satellite data）。</p>\n<p>对动态集合进行的操作可以分为两大类：<strong>查询</strong>（query）和<strong>修改</strong>（modify）。下面列出了典型的操作，大部分算法中只会用到其中的几种：</p>\n<ul>\n<li><code>SEARCH(S, k)</code>：返回满足 <code>x.key = k</code> 的 <code>x</code>；如果不存在这样的 <code>x</code>，返回 <code>nil</code>。</li>\n<li><code>INSERT(S, x)</code>：向集合中插入 <code>x</code>。</li>\n<li><code>DELETE(S, x)</code>：从集合中删除 <code>x</code>。</li>\n<li><code>MAXIMUM(S)</code>：返回集合中键最大的元素。</li>\n<li><code>MIMIMUM(S)</code>：返回集合中键最小的元素。</li>\n<li><code>SUCCESSOR(S, x)</code>：返回比 <code>x</code> 的键大的最小的元素。</li>\n<li><code>PREDECESSOR(S, x)</code>：返回比 <code>x</code> 的键小的最大的元素。</li>\n</ul>\n<h2 id=\"_10-1-栈和队列\"> 10.1 栈和队列</h2>\n<p>栈和队列是具有特殊 <code>DELETE</code> 操作的数据结构。在<strong>栈</strong>（stack）中，删除的是最后加入栈的元素，即<strong>后入先出</strong>（last-in-first-out，LIFO）。在<strong>队列</strong>（queue）中，删除的是最先加入队列的元素，即<strong>先入先出</strong>（first-in-first-out，FIFO）。</p>\n<h3 id=\"栈\"> 栈</h3>\n<p>对于栈的插入操作常被称为压入（push），删除操作常被称为弹出（pop）。假设 <code>S.top</code> 指向最近压入元素的位置，初始时 <code>S.top = 0</code>。<code>S.top = 0</code> 时栈<strong>空</strong>（empty），此时如果再进行弹出操作，则会发生<strong>下溢</strong>（underflow）。类似地，栈满时再进行压入操作，则会发生<strong>溢出</strong>（overflow）。</p>\n<div><pre><code>STACK-EMPTY(S)\n  if S.top == 0\n    return TRUE\n  return FALSE\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><div><pre><code>PUSH(S, x)\n  S.top = S.top + 1\n  S[S.top] = x\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><div><pre><code>POP(S)\n  if STACK-EMPTY(S)\n    error &quot;underflow&quot;\n  S.top = S.top - 1\n  return S[S.top + 1]\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div><p>栈的 <code>PUSH</code> 和 <code>POP</code> 操作都只花费 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span></span> 的时间。</p>\n<h3 id=\"队列\"> 队列</h3>\n<p>对于栈的插入操作常被称为<strong>入队</strong>（enqueue），删除操作常被称为<strong>出队</strong>（dequeue）。队列有<strong>头</strong>（head）和<strong>尾</strong>（tail），入队的元素被附加再队尾，出队时总是删除队头的元素。假设 <code>Q.head</code> 和 <code>Q.tail</code> 分别指向队头和队尾的位置，并且当二者相等时队列为空。</p>\n<p>一种典型的队列实现是循环队列。主要思路是，创建长度为 <code>N</code> 的数组。入队时，从数组第一个位置开始逐个地使用数组中的位置。当使用完数组最后一个位置时，回到数组第一个位置，这里的空间可能已经由于出队而空闲。如果 <code>Q.head</code> 碰到了 <code>Q.tail</code>（贪吃蛇咬到了自己的尾巴），那么就发生了溢出。以下的伪代码中，没有处理和溢出相关的错误：</p>\n<div><pre><code>ENQUEUE(Q, x)\n  Q[Q.tail] = x\n  if Q.tail == Q.length\n    Q.tail = 1\n  else\n    Q.tail = Q.tail + 1\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div><div><pre><code>DEQUEUE(Q, x)\n  x = Q[Q.head]\n  if Q.head == Q.length\n    Q.head = 1\n  else\n    Q.head = Q.head + 1\n  return x\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></div></div><p>队列的 <code>ENQUEUE</code> 和 <code>DEQUEUE</code> 操作都只花费 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span></span> 的时间。</p>\n<h2 id=\"_10-2-链表\"> 10.2 链表</h2>\n<p><strong>链表</strong>（linked list）是节点串连成链的数据结构。相邻的节点之间由单向的指针相连的链表称为<strong>单向链表</strong>（singly linked list），由双向的指针相连的链表称为<strong>双向链表</strong>（doubly linked list），首尾相连的称为<strong>循环链表</strong>（circular linked list）。</p>\n<h3 id=\"链表中搜索\"> 链表中搜索</h3>\n<p><code>LIST-SEARCH(L, k)</code> 在链表中线性地搜索键为 <code>k</code> 的元素。</p>\n<div><pre><code>LIST-SEARCH(L, k)\n  x = L.head\n  while x != nil and x.key != k\n    x = x.next\n  return x\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div><p><code>LIST-SEARCH(L, k)</code> 花费 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span> 的最坏情况运行时间。</p>\n<h3 id=\"链表中插入\"> 链表中插入</h3>\n<p><code>LIST-INSERT(L, x)</code> 在双向链表的第一个位置插入 <code>x</code>。</p>\n<div><pre><code>LIST-INSERT(L, x)\n  x.next = L.head\n  if L.head != nil\n    L.head.prev = x\n  L.head = x\n  x.prev = nil\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div><p><code>LIST-INSERT(L, x)</code> 花费 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span></span> 的时间。</p>\n<h3 id=\"链表中删除\"> 链表中删除</h3>\n<p><code>LIST-DELETE(L, x)</code> 从链表中删除节点 <code>x</code>。当然，需要先使用 <code>LIST-SEARCH</code> 根据键找到该元素。</p>\n<div><pre><code>LIST-DELETE(L, x)\n  if x.prev != nil\n    x.prev.next = x.next\n  else\n    L.head = x.next\n  if x.next != nil\n    x.next.prev = x.prev\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></div></div><p>不算搜索的部分，<code>LIST-DELETE(L, x)</code> 花费 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span></span> 的时间。如果算上搜索的时间，删除操作实际上需要 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span> 的最坏情况运行时间。</p>\n<h3 id=\"哨兵\"> 哨兵</h3>\n<p>哨兵是为了简化边界条件而添加的空节点，可以简化代码逻辑，但是并不影响运行时间的增长率。</p>\n",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": [
        "算法导论"
      ]
    },
    {
      "title": "算法导论3 函数的增长",
      "url": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/3%20%E5%87%BD%E6%95%B0%E7%9A%84%E5%A2%9E%E9%95%BF/",
      "id": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/3%20%E5%87%BD%E6%95%B0%E7%9A%84%E5%A2%9E%E9%95%BF/",
      "content_html": "<h1 id=\"算法导论3-函数的增长\"> 算法导论3 函数的增长</h1>\n<p>算法的<strong>渐近</strong>（asymptotic）效率关注的是算法的运行时间如何随着输入规模的增长而增长。本章介绍了分析渐近效率时使用的数学符号和定义，并且给出了一些常用函数之间的渐近效率关系。</p>\n<h2 id=\"_3-1-渐近符号\"> 3.1 渐近符号</h2>\n<h3 id=\"符号\"> <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>Θ</span></span></span></span> 符号</h3>\n<p><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>Θ</span></span></span></span> 是希腊大写字母，英文写作 theta。对于给定函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span></span></span></span> 是一个函数集合：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>{</span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span><span>：存在正的常量</span><span> </span></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span>，</span></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span> </span><span>和</span><span> </span></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span>，使得任意</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span>，</span></span></span><span></span><span><span style=\"height:0.8200000000000001em;vertical-align:-0.13667em;\"></span><span><span>满足</span><span> </span></span><span>0</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)}</span></span></span></span></span></p>\n<p>如果 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> 满足条件，那么可以写作 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span></span></span></span>，不过通常会被写成 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span></span></span></span>。此时，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)</span></span></span></span> 被称作 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> 的一个<strong>渐近紧界</strong>（asymptotically tight bound）。</p>\n<p>在该定义中，每一个 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span></span></span></span> 都是<strong>渐近非负</strong>（asymptotically nonnegative）的。也就是说存在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 使得任意 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 满足 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>。<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)</span></span></span></span> 必须是渐近非负的，否则 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span></span></span></span> 就是空集了。类似地，还有<strong>渐近正</strong>的定义：存在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 使得任意 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 满足 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>。</p>\n<h3 id=\"符号-2\"> <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.02778em;\">O</span></span></span></span> 符号</h3>\n<p><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>Θ</span></span></span></span> 符号渐近地把函数约束在一个渐近上界和渐近下界范围内。当只有<strong>渐近上界</strong>（asymptotic upper bound）时，可以使用 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.02778em;\">O</span></span></span></span> 符号。对于给定函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span></span></span></span> 是一个函数集合：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>{</span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span><span>：存在正的常量</span><span> </span></span><span>c</span><span><span> </span><span>和</span><span> </span></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span>，使得任意</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span>，</span></span></span><span></span><span><span style=\"height:0.8200000000000001em;vertical-align:-0.13667em;\"></span><span><span>满足</span><span> </span></span><span>0</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>c</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)}</span></span></span></span></span></p>\n<p>通常可以通过观察算法的整体结构直接得到渐近上界。举例来说，根据插入排序二层嵌套循环，可以直接得到它在最坏情况下具有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span> 的运行时间上界。</p>\n<h3 id=\"符号-3\"> <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>Ω</span></span></span></span> 符号</h3>\n<p><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>Ω</span></span></span></span> 是希腊大写字母，英语写作 omega。类似地，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>Ω</span></span></span></span> 只提供<strong>渐近下界</strong>（asymptotic lower bound）。对于给定函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Ω</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span></span></span></span> 是一个函数集合：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Ω</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>{</span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span><span>：存在正的常量</span><span> </span></span><span>c</span><span><span> </span><span>和</span><span> </span></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span>，使得任意</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span>，</span></span></span><span></span><span><span style=\"height:0.8200000000000001em;vertical-align:-0.13667em;\"></span><span><span>满足</span><span> </span></span><span>0</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>c</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)}</span></span></span></span></span></p>\n<h3 id=\"定理-3-1\"> 定理 3.1</h3>\n<p>对于两个函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span></span></span></span> 当且仅当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span></span></span></span> 且 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Ω</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span></span></span></span>。</p>\n<h3 id=\"符号-4\"> <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>o</span></span></span></span> 符号</h3>\n<p><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.02778em;\">O</span></span></span></span> 符号提供的渐近上界可能是不紧的。比如 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span>2</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span> 是紧的，但是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span> 不是。因此使用 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>o</span></span></span></span> 符号来特指不紧的渐近上界，其正式定义是：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>o</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>{</span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span><span>：对于任意正的常数</span><span> </span></span><span>c</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span>0</span><span><span>，总存在一个常数</span><span> </span></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>0</span><span><span>，</span></span></span><span></span><span><span style=\"height:0.8200000000000001em;vertical-align:-0.13667em;\"></span><span><span>使得任意</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span>，</span></span><span><span>满足</span><span> </span></span><span>0</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>c</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)}</span></span></span></span></span></p>\n<p>从上述定义可知，当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 逐渐趋向无限大时，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span>/</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)</span></span></span></span> 会越来越小（否则对于很小的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span></span></span></span> 就无法找到 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>了）。因此有：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:2.363em;vertical-align:-0.936em;\"></span><span><span><span><span style=\"height:0.69444em;\"><span style=\"top:-2.4em;margin-left:0em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span>→</span><span>∞</span></span></span></span><span style=\"top:-3em;\"><span style=\"height:3em;\"></span><span><span>lim</span></span></span></span><span>​</span></span><span><span style=\"height:0.7em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:0.936em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span></span></p>\n<p>也有某些教材把这个极限用作 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>o</span></span></span></span> 符号的定义。</p>\n<h3 id=\"符号-5\"> <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.03588em;\">ω</span></span></span></span> 符号</h3>\n<p><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.03588em;\">ω</span></span></span></span> 是希腊小写字母，英语写作 omega。与 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>o</span></span></span></span> 符号类似，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.03588em;\">ω</span></span></span></span> 符号用于表示不紧的渐近下界。</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03588em;\">ω</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>{</span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span><span>：对于任意正的常数</span><span> </span></span><span>c</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span>0</span><span><span>，总存在一个常数</span><span> </span></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>0</span><span><span>，</span></span></span><span></span><span><span style=\"height:0.8200000000000001em;vertical-align:-0.13667em;\"></span><span><span>使得任意</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span>，</span></span><span><span>满足</span><span> </span></span><span>0</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>c</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)}</span></span></span></span></span></p>\n<p>当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 逐渐趋向无限大时，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span>/</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)</span></span></span></span> 会越来越大。因此有：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:2.363em;vertical-align:-0.936em;\"></span><span><span><span><span style=\"height:0.69444em;\"><span style=\"top:-2.4em;margin-left:0em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span>→</span><span>∞</span></span></span></span><span style=\"top:-3em;\"><span style=\"height:3em;\"></span><span><span>lim</span></span></span></span><span>​</span></span><span><span style=\"height:0.7em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:0.936em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>∞</span></span></span></span></span></p>\n<p>也有某些教材把这个极限用作 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.03588em;\">ω</span></span></span></span> 符号的定义。</p>\n<h3 id=\"函数比较\"> 函数比较</h3>\n<p><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> <strong>渐近小于</strong>（asymptotically smaller）<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)</span></span></span></span> 当且仅当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>o</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span></span></span></span>。<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> <strong>渐近大于</strong>（asymptotically larger）<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)</span></span></span></span> 当且仅当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03588em;\">ω</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span></span></span></span>。</p>\n<p>不是所有函数都是渐近可比较的。存在函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)</span></span></span></span>，既不满足 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span></span></span></span>，也不满足 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Ω</span><span>(</span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>))</span></span></span></span>。举个例子，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03588em;\">g</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.830502em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.830502em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>1</span><span>+</span><span><span>s</span><span>i</span><span>n</span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>n</span></span></span></span></span></span></span></span></span></span></span></span>。</p>\n<h2 id=\"_3-2-常用函数\"> 3.2 常用函数</h2>\n<h3 id=\"多项式\"> 多项式</h3>\n<p>给定整数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>d</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>d</span></span></span></span> 阶多项式指的是函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>p</span><span>(</span><span>n</span><span>)</span></span></span></span>：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>p</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.1137820000000005em;vertical-align:-1.277669em;\"></span><span><span><span><span style=\"height:1.8361130000000003em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>d</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span>n</span><span><span><span><span style=\"height:0.8746639999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>其中，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>d</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 被称为<strong>系数</strong>（coefficient），并且 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>d</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>。多项式渐近正当且仅当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>d</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>。渐近正 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>d</span></span></span></span> 阶多项式 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>p</span><span>(</span><span>n</span><span>)</span></span></span></span> 满足 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>p</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.099108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>d</span></span></span></span></span></span></span></span><span>)</span></span></span></span>。如果存在常量 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 使得 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.099108em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span><span>)</span></span></span></span>，那么 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> 是<strong>多项式有界</strong>（polynomially bounded）的。</p>\n<h3 id=\"指数\"> 指数</h3>\n<p>对于所有的实数常量 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>a</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>b</span></span></span></span> 且 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>a</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>，有：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:2.226108em;vertical-align:-0.7em;\"></span><span><span><span><span style=\"height:0.69444em;\"><span style=\"top:-2.4em;margin-left:0em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span>→</span><span>∞</span></span></span></span><span style=\"top:-3em;\"><span style=\"height:3em;\"></span><span><span>lim</span></span></span></span><span>​</span></span><span><span style=\"height:0.7em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.526108em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span><span>a</span><span><span><span><span style=\"height:0.590392em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>b</span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span></span></p>\n<p>因此可以得到：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8991079999999999em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>b</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>o</span><span>(</span><span><span>a</span><span><span><span><span style=\"height:0.7143919999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span><span>)</span></span></span></span></span></p>\n<p>综上，底数大于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 的指数函数比任何多项式函数增长都快。</p>\n<h3 id=\"对数\"> 对数</h3>\n<p>如果存在常量 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 使得 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.1834479999999998em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.9334479999999998em;\"><span style=\"top:-3.1473400000000002em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>，那么 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> 是<strong>多对数有界</strong>（polylogarithmically bounded）的。对于上一小节中的极限，使用 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span> 替换 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>，使用 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.664392em;vertical-align:0em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>a</span></span></span></span></span></span></span></span></span></span></span> 替换 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>a</span></span></span></span>（新的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>a</span></span></span></span> 的范围是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>a</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>），可以得到：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:2.546448em;vertical-align:-0.936em;\"></span><span><span><span><span style=\"height:0.69444em;\"><span style=\"top:-2.4em;margin-left:0em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span>→</span><span>∞</span></span></span></span><span style=\"top:-3em;\"><span style=\"height:3em;\"></span><span><span>lim</span></span></span></span><span>​</span></span><span><span style=\"height:0.7em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.6104479999999999em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>(</span><span><span>2</span><span><span><span><span style=\"height:0.590392em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>a</span></span></span></span></span></span></span></span><span><span>)</span><span><span><span><span style=\"height:0.7751079999999999em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span>l</span><span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>n</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.9334479999999998em;\"><span style=\"top:-3.1473400000000002em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>b</span></span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.936em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.310448em;vertical-align:-0.7em;\"></span><span><span><span><span style=\"height:0.69444em;\"><span style=\"top:-2.4em;margin-left:0em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span>→</span><span>∞</span></span></span></span><span style=\"top:-3em;\"><span style=\"height:3em;\"></span><span><span>lim</span></span></span></span><span>​</span></span><span><span style=\"height:0.7em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.6104479999999999em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span><span><span><span style=\"height:0.590392em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>a</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.9334479999999998em;\"><span style=\"top:-3.1473400000000002em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>b</span></span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span></span></p>\n<p>因此可以得到：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.1278879999999998em;vertical-align:-0.19444em;\"></span><span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.9334479999999998em;\"><span style=\"top:-3.1473400000000002em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>b</span></span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>o</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.7143919999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>a</span></span></span></span></span></span></span></span><span>)</span></span></span></span></span></p>\n<p>综上，正多项式函数比任何多对数函数增长都快。</p>\n<h3 id=\"阶乘\"> 阶乘</h3>\n<p>对于正整数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>n</span><span>!</span></span></span></span> 定义为：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>n</span><span>!</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span><span style=\"top:0em;\"><span>{</span></span><span><span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span>1</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span>n</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)!</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>0</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>为了证明阶乘和其他函数增长率的关系，引入 <strong>Stirling 近似</strong>（Stirling's approximation）：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>n</span><span>!</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.7935600000000003em;vertical-align:-0.686em;\"></span><span><span><span><span style=\"height:0.956095em;\"><span style=\"top:-3em;\"><span style=\"height:3em;\"></span><span style=\"padding-left:0.833em;\"><span>2</span><span>πn</span></span></span><span style=\"top:-2.916095em;\"><span style=\"height:3em;\"></span><span style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span>​</span></span><span><span style=\"height:0.08390500000000001em;\"><span></span></span></span></span></span><span>(</span><span><span></span><span><span><span><span style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>e</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span><span>)</span><span><span><span><span style=\"height:0.7143919999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:2.00744em;vertical-align:-0.686em;\"></span><span>Θ</span><span>(</span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>))</span></span></span></span></span></p>\n<p>于是可以得到两个极限：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:5.28444em;vertical-align:-2.39222em;\"></span><span><span><span><span><span><span style=\"height:2.89222em;\"><span style=\"top:-4.89222em;\"><span style=\"height:3.64222em;\"></span><span><span><span><span><span style=\"height:0.69444em;\"><span style=\"top:-2.4em;margin-left:0em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span>→</span><span>∞</span></span></span></span><span style=\"top:-3em;\"><span style=\"height:3em;\"></span><span><span>lim</span></span></span></span><span>​</span></span><span><span style=\"height:0.7em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span><span><span><span style=\"height:0.590392em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span><span>!</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.64222em;\"></span><span><span><span><span><span style=\"height:0.69444em;\"><span style=\"top:-2.4em;margin-left:0em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span>→</span><span>∞</span></span></span></span><span style=\"top:-3em;\"><span style=\"height:3em;\"></span><span><span>lim</span></span></span></span><span>​</span></span><span><span style=\"height:0.7em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span><span>2</span><span><span><span><span style=\"height:0.590392em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span><span>!</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span></span><span>​</span></span><span><span style=\"height:2.39222em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:2.89222em;\"><span style=\"top:-4.89222em;\"><span style=\"height:3.64222em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.64222em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span><span><span><span style=\"height:0.590392em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7350000000000003em;\"><span style=\"height:3em;\"></span><span><span><span><span><span style=\"height:0.90722em;\"><span style=\"top:-3em;\"><span style=\"height:3em;\"></span><span style=\"padding-left:0.833em;\"><span>2</span><span>πn</span></span></span><span style=\"top:-2.86722em;\"><span style=\"height:3em;\"></span><span style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span>​</span></span><span><span style=\"height:0.13278em;\"><span></span></span></span></span></span><span>(</span><span><span></span><span><span><span><span style=\"height:0.695392em;\"><span style=\"top:-2.6550000000000002em;\"><span style=\"height:3em;\"></span><span><span><span>e</span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span style=\"height:3em;\"></span><span><span><span>n</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.345em;\"><span></span></span></span></span></span><span></span></span><span><span>)</span><span><span><span><span style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span><span></span><span><span><span><span style=\"height:0.845108em;\"><span style=\"top:-2.6550000000000002em;\"><span style=\"height:3em;\"></span><span><span><span>n</span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span style=\"height:3em;\"></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.345em;\"><span></span></span></span></span></span><span></span></span><span>))</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.5842200000000002em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span><span>e</span><span><span><span><span style=\"height:0.590392em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span><span><span><span style=\"height:0.90722em;\"><span style=\"top:-3em;\"><span style=\"height:3em;\"></span><span style=\"padding-left:0.833em;\"><span>2</span><span>πn</span></span></span><span style=\"top:-2.86722em;\"><span style=\"height:3em;\"></span><span style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span>​</span></span><span><span style=\"height:0.13278em;\"><span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>))</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>0</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.64222em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.64222em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span><span>2</span><span><span><span><span style=\"height:0.590392em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7350000000000003em;\"><span style=\"height:3em;\"></span><span><span><span><span><span style=\"height:0.90722em;\"><span style=\"top:-3em;\"><span style=\"height:3em;\"></span><span style=\"padding-left:0.833em;\"><span>2</span><span>πn</span></span></span><span style=\"top:-2.86722em;\"><span style=\"height:3em;\"></span><span style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span>​</span></span><span><span style=\"height:0.13278em;\"><span></span></span></span></span></span><span>(</span><span><span></span><span><span><span><span style=\"height:0.695392em;\"><span style=\"top:-2.6550000000000002em;\"><span style=\"height:3em;\"></span><span><span><span>e</span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span style=\"height:3em;\"></span><span><span><span>n</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.345em;\"><span></span></span></span></span></span><span></span></span><span><span>)</span><span><span><span><span style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span><span></span><span><span><span><span style=\"height:0.845108em;\"><span style=\"top:-2.6550000000000002em;\"><span style=\"height:3em;\"></span><span><span><span>n</span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span style=\"height:3em;\"></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.345em;\"><span></span></span></span></span></span><span></span></span><span>))</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.5842200000000002em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span><span>e</span><span><span><span><span style=\"height:0.590392em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span><span><span>2</span><span><span><span><span style=\"height:0.590392em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span><span><span><span style=\"height:0.90722em;\"><span style=\"top:-3em;\"><span style=\"height:3em;\"></span><span style=\"padding-left:0.833em;\"><span>2</span><span>πn</span></span></span><span style=\"top:-2.86722em;\"><span style=\"height:3em;\"></span><span style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span>​</span></span><span><span style=\"height:0.13278em;\"><span></span></span></span></span></span><span><span>n</span><span><span><span><span style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>))</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∞</span></span></span></span><span>​</span></span><span><span style=\"height:2.39222em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>因此可以得到：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:3.0000000000000004em;vertical-align:-1.2500000000000002em;\"></span><span><span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span>n</span><span>!</span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span>n</span><span>!</span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>o</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.7143919999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span><span>)</span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.03588em;\">ω</span><span>(</span><span><span>2</span><span><span><span><span style=\"height:0.7143919999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>综上，阶乘比任何底数大于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 的指数函数增长都快，但是比 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.664392em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span></span></span></span> 慢。</p>\n<h3 id=\"迭代函数\"> 迭代函数</h3>\n<p><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.138em;vertical-align:-0.25em;\"></span><span><span style=\"margin-right:0.10764em;\">f</span><span><span><span><span style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>(</span><span>i</span><span>)</span></span></span></span></span></span></span></span></span><span>(</span><span>n</span><span>)</span></span></span></span> 表示迭代地在初始值 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 上应用 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span> 次 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> 函数。<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.967476em;vertical-align:-0.19444em;\"></span><span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.773036em;\"><span style=\"top:-3.1473400000000002em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>∗</span></span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span> 代表迭代对数，其定义如下：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.967476em;vertical-align:-0.19444em;\"></span><span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.773036em;\"><span style=\"top:-3.1473400000000002em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>∗</span></span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>min</span><span>{</span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.16678em;vertical-align:-0.19444em;\"></span><span>0</span><span><span>：</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.97234em;\"><span style=\"top:-3.14734em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>(</span><span>i</span><span>)</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>}</span></span></span></span></span></p>\n<p>迭代对数函数的增长是极其缓慢的。</p>\n<h3 id=\"斐波那契数列\"> 斐波那契数列</h3>\n<p><strong>斐波那契数列</strong>（Fibonacci numbers）可通过递归定义。</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:4.500000000000002em;vertical-align:-2.000000000000001em;\"></span><span><span><span><span><span><span style=\"height:2.5000000000000004em;\"><span style=\"top:-4.66em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.13889em;\">F</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.16em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.13889em;\">F</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.6599999999999993em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.13889em;\">F</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:2.000000000000001em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:2.5000000000000004em;\"><span style=\"top:-4.66em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>0</span></span></span><span style=\"top:-3.16em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span></span></span><span style=\"top:-1.6599999999999993em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.13889em;\">F</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.13889em;\">F</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>−</span><span>2</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:2.000000000000001em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:-0.5000000000000002em;\"><span style=\"top:-1.6599999999999997em;\"><span style=\"height:3em;\"></span><span><span><span>对于</span><span> </span></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:2.0000000000000004em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>斐波那契数列的增长是指数性的。</p>\n",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": [
        "算法导论"
      ]
    },
    {
      "title": "算法导论5 概率分析和随机算法",
      "url": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/5%20%E6%A6%82%E7%8E%87%E5%88%86%E6%9E%90%E5%92%8C%E9%9A%8F%E6%9C%BA%E7%AE%97%E6%B3%95/",
      "id": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/5%20%E6%A6%82%E7%8E%87%E5%88%86%E6%9E%90%E5%92%8C%E9%9A%8F%E6%9C%BA%E7%AE%97%E6%B3%95/",
      "content_html": "<h1 id=\"算法导论5-概率分析和随机算法\"> 算法导论5 概率分析和随机算法</h1>\n<h2 id=\"_5-1-招聘问题\"> 5.1 招聘问题</h2>\n<p>假设你要雇佣新员工。每次你可以花费少量资金，面试一个应聘者。该应聘者的能力是随机的，如果你决定雇佣他，你需要花费一大笔钱。只有当你决定是否雇佣此应聘者之后，你才能面试下一个应聘者。你的策略如下：如果应聘者的能力比上一个被雇佣的应聘者优秀（当没有上一个时直接雇佣），那么雇佣该应聘者；否则就不雇佣该应聘者，继续面试。这种策略的伪代码如下：</p>\n<div><pre><code>HIRE-ASSISTANT(n)\n  // 0 号是具有最低能力的一个虚拟应聘者\n  best = 0\n  for i = 1 to n\n    面试应聘者 i\n    if 应聘者 i 比 best 的能力优秀\n      best = i\n      雇佣应聘者 i\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br></div></div><p>这次分析重点并不在运行时间，而是招聘过程中一共花了多少钱。假设面试成本是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，雇佣成本是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>h</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，一共面试了 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个人，最终雇佣了 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 个人，那么总成本是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span><span>c</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>h</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>m</span><span>)</span></span></span></span>。由于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>n</span></span></span></span> 是固定的，因此 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>h</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>m</span></span></span></span> 更重要。在各种程序中，遍历数组时常常需要维护最值。招聘问题实际是该类问题的建模，关注的是最值被更新的频率。</p>\n<h3 id=\"最坏情况分析\"> 最坏情况分析</h3>\n<p>最差情况下，应聘者按能力从低到高来面试，这样你就花了 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span><span>c</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>h</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>n</span><span>)</span></span></span></span> 雇佣了所有的应聘者。</p>\n<p>当然，这种情况不大可能发生，平均情况更重要。</p>\n<h3 id=\"概率分析\"> 概率分析</h3>\n<p><strong>概率分析</strong>（probabilistic analysis）就是在分析中使用概率。在大多数问题中，概率分析用于分析运行时间（在招聘问题中用于分析雇佣成本）。为了进行概率分析，还需要了解或者假设输入数据的分布。确定输入分布时必须万分注意。如果无法找到一个合理的输入分布，那么就不能使用概率分析。</p>\n<p>在招聘问题中，假设所有应聘者是按随机顺序进行面试的。使用数学语言来描述，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个应聘者按面试顺序构成的序列一共有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>n</span><span>!</span></span></span></span> 种。这 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>n</span><span>!</span></span></span></span> 种中的每一个出现的概率都是相同的，这称为<strong>均匀随机排列</strong>（uniform random permutation）。</p>\n<h3 id=\"随机算法\"> 随机算法</h3>\n<p>如果算法的行为不仅和输入有关，还和<strong>随机数生成器</strong>（random-number generator）生成的值有关，那么该算法称为<strong>随机</strong>（randomized）的。</p>\n<p>要把输入的随机和算法本身的随机区分开来。对于输入具有某种概率分布的算法，研究对象是平均情况运行时间；对于本身具有随机性的算法，研究对象是<strong>期望运行时间</strong>（expected running time）。</p>\n<h2 id=\"_5-2-指示随机变量\"> 5.2 指示随机变量</h2>\n<p><strong>指示随机变量</strong>（indicator random variable）提供了概率和期望之间转换的便利方法。与事件 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>A</span></span></span></span> 关联的指示随机变量 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.07847em;\">I</span><span>{</span><span>A</span><span>}</span></span></span></span> 的定义是：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.07847em;\">I</span><span>{</span><span>A</span><span>}</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span><span style=\"top:0em;\"><span>{</span></span><span><span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span>1</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span>A</span><span><span> </span><span>发生</span></span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span>A</span><span><span> </span><span>不发生</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>以扔硬币为例，样本空间 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.05764em;\">S</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>{</span><span style=\"margin-right:0.08125em;\">H</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>}</span></span></span></span>，且 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Pr</span><span>{</span><span style=\"margin-right:0.08125em;\">H</span><span>}</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Pr</span><span>{</span><span style=\"margin-right:0.13889em;\">T</span><span>}</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/2</span></span></span></span>。定义指示随机变量 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.08125em;\">H</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，写作：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.08125em;\">H</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.07847em;\">I</span><span>{</span><span style=\"margin-right:0.08125em;\">H</span><span>}</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span><span style=\"top:0em;\"><span>{</span></span><span><span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span>1</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span style=\"margin-right:0.08125em;\">H</span><span><span> </span><span>发生</span></span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span style=\"margin-right:0.08125em;\">H</span><span><span> </span><span>不发生</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>扔一次硬币过程中，正面向上的次数的数学期望可以通过 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.08125em;\">H</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 快速地得到：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:3.0000000000000004em;vertical-align:-1.2500000000000002em;\"></span><span><span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.08125em;\">H</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.07847em;\">I</span><span>{</span><span style=\"margin-right:0.08125em;\">H</span><span>}]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Pr</span><span>{</span><span style=\"margin-right:0.08125em;\">H</span><span>}</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>0</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Pr</span><span>{</span><span style=\"margin-right:0.13889em;\">T</span><span>}</span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span>1/2</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>0</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span>1/2</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1/2</span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<h3 id=\"引理-5-1\"> 引理 5.1</h3>\n<p>给定样本空间 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.05764em;\">S</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.05764em;\">S</span></span></span></span> 中的事件 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>A</span></span></span></span>，令 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>A</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.07847em;\">I</span><span>{</span><span>A</span><span>}</span></span></span></span>，那么 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>A</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Pr</span><span>{</span><span>A</span><span>}</span></span></span></span>。</p>\n<p>让问题复杂一些，令 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>{</span><span><span>第</span><span> </span></span><span>i</span><span><span> </span><span>次扔硬币时正面向上</span></span><span>}</span></span></span></span>。再假设 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.07847em;\">X</span></span></span></span> 表示扔 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 次硬币，正面向上出现了多少次：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.07847em;\">X</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.929066em;vertical-align:-1.277669em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>使用指示随机变量可以轻松地得到数学期望：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:6.458132000000001em;vertical-align:-2.9790660000000004em;\"></span><span><span><span><span><span><span style=\"height:3.4790660000000004em;\"><span style=\"top:-5.479066em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.08125em;\">H</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.6513970000000002em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:2.9790660000000004em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:3.4790660000000004em;\"><span style=\"top:-5.479066em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1/2</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>n</span><span>/2</span></span></span></span><span>​</span></span><span><span style=\"height:2.9790660000000004em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<h3 id=\"招聘问题\"> 招聘问题</h3>\n<p>回到招聘问题，应聘者按随机顺序面试。令 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.07847em;\">X</span></span></span></span> 代表最终雇佣了多少个应聘者，希望得到数学期望：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.07847em;\">X</span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.929066em;vertical-align:-1.277669em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>x</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>Pr</span><span>{</span><span style=\"margin-right:0.07847em;\">X</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>x</span><span>}</span></span></span></span></span></p>\n<p>这样计算起来有些困难，使用指示随机变量简化一下。定义 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span style=\"margin-right:0.07847em;\">I</span><span>{</span><span><span>第</span><span> </span></span><span>i</span><span><span> </span><span>位应聘者被雇佣</span></span><span>}</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"top:0em;\"><span>{</span></span><span><span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span>1</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果第</span><span> </span></span><span>i</span><span><span> </span><span>位应聘者被雇佣</span></span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果第</span><span> </span></span><span>i</span><span><span> </span><span>位应聘者不被雇佣</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>然后有：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.07847em;\">X</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>⋯</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>根据，可得：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Pr</span><span>{</span><span><span>第</span><span> </span></span><span>i</span><span><span> </span><span>位应聘者被雇佣</span></span><span>}</span></span></span></span></span></p>\n<p>此时，问题变成了求第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span> 位应聘者被雇佣的概率。</p>\n<p>第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span> 位应聘者被雇佣当且仅当他比之前的所有应聘者都优秀。先考虑另一个问题：假设有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span> 个各不相同的自然数，那么这 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span> 个自然数构成的排列有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>x</span><span>!</span></span></span></span> 种。其中，最大的数位于最后一个位置的排列有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>x</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)!</span></span></span></span> 种。也就是说，在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span> 个自然数构成的随机排列中，最大的数恰好位于最后的概率是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>x</span></span></span></span>。同理，第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span> 位应聘者被雇佣的概率就是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>i</span></span></span></span>。于是有（用到了调和级数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.190108em;vertical-align:-0.345em;\"></span><span><span style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span><span><span><span style=\"height:0.804292em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:0.845108em;\"><span style=\"top:-2.6550000000000002em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span style=\"height:3em;\"></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.345em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span>ln</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span></span>）：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:6.458132000000001em;vertical-align:-2.9790660000000004em;\"></span><span><span><span><span><span><span style=\"height:3.4790660000000004em;\"><span style=\"top:-5.479066em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.07847em;\">X</span><span>]</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.6513970000000002em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:2.9790660000000004em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:3.4790660000000004em;\"><span style=\"top:-5.479066em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1/</span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>ln</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:2.9790660000000004em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>因此，当一共面试 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个应聘者时，平均会雇佣 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>ln</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span> 个人。</p>\n<h3 id=\"引理-5-2\"> 引理 5.2</h3>\n<p>如果应聘者按随机顺序被面试，那么 <code>HIRE-ASSISTANT</code> 算法在平均情况下的雇佣成本是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span><span>c</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>h</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>ln</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>。</p>\n<h2 id=\"_5-3-随机算法\"> 5.3 随机算法</h2>\n<p>有时候不能对输入做出任何假设，并且输入本身也不满足任何分布，因此无法使用概率分析。这时可以强行分布输入，比如随机打乱应聘者的顺序，使其满足均匀随机排列，这样的算法就是一种随机算法。</p>\n<div><pre><code>RANDOMIZED-HIRE-ASSISTANT(n)\n  随机排列应聘者列表\n  // 0 号是具有最低能力的一个虚拟应聘者\n  best = 0\n  for i = 1 to n\n    面试应聘者 i\n    if 应聘者 i 比 best 的能力优秀\n      best = i\n      雇佣应聘者 i\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></div></div><p>再强调一下概率分析和随机算法的不同。在 <code>HIRE-ASSISTANT</code> 的概率分析中，假定应聘者按随机顺序到来。一定要注意该算法是确定性的，对于同一个输入，算法的输出永远是相同的。而在 <code>RANDOMIZED-HIRE-ASSISTANT</code> 中，由于打乱应聘者顺序的过程是随机的，所以即使对于同一个输入，算法的输出也可能不同。</p>\n<h3 id=\"引理-5-3\"> 引理 5.3</h3>\n<p><code>RANDOMIZED-HIRE-ASSISTANT</code> 算法的期望雇佣成本是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span><span>c</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>h</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>ln</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>。</p>\n<h3 id=\"随机排列数组\"> 随机排列数组</h3>\n<p>许多随机算法都会把输入数组随机排列，这里介绍几种随机排列数组的方法。</p>\n<p>第一种就是随机为每个位置赋予一个权重 <code>P[i]</code>，然后根据权重来排序。</p>\n<div><pre><code>PERMUTE-BY-SORTING(A)\n  n = A.length\n  创建新数组 P[1..n]\n  for i = 1 to n\n     P[i] = RANDOM(1, n^3)\n  根据 P 中的优先级为 A 排序\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div><p><code>RANDOM(1, n^3)</code> 会随机生成一个位于 <code>[1, n^3]</code> 区间内的整数。选择 <code>n^3</code> 而不是 <code>n</code> 的原因是要尽可能避免不同位置的权重相同。如果排序使用的算法是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span> 的，那么 <code>PERMUTE-BY-SORTING</code> 算法的运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span> 的。</p>\n<h3 id=\"引理-5-4\"> 引理 5.4</h3>\n<p>如果所有权重各不相同，那么 <code>PERMUTE-BY-SORTING</code> 生成的排列满足均匀随机排列。</p>\n<p>然后介绍一个运行时间更少的算法：</p>\n<div><pre><code>RANDOMIZE-IN-PLACE(A)\n  n = A.length\n  for i = 1 to n\n    将 A[i] 和 A[RANDOM(i, n)] 交换\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><h3 id=\"引理-5-5\"> 引理 5.5</h3>\n<p><code>RANDOMIZE-IN-PLACE</code> 生成的排列满足均匀随机排列。</p>\n",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": [
        "算法导论"
      ]
    },
    {
      "title": "算法导论7 快速排序",
      "url": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/7%20%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F/",
      "id": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/7%20%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F/",
      "content_html": "<h1 id=\"算法导论7-快速排序\"> 算法导论7 快速排序</h1>\n<p><strong>快速排序</strong>（quicksort）的最坏情况运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span>。虽然如此，快速排序在实际场景中经常是表现最好的，它的期望运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>，并且隐含的常数相对小。另外，快速排序还有原地排序的优点。</p>\n<h2 id=\"_7-1-快速排序\"> 7.1 快速排序</h2>\n<p>快速排序与归并排序类似，都使用了分治策略。以下是快速排序 <code>A[p..r]</code> 的分治步骤：</p>\n<ol>\n<li>拆分：将 <code>A[p..r]</code> 分成两部分 <code>A[p..q - 1]</code> 和 <code>A[q + 1..r]</code>，其中 <code>A[p..q - 1]</code> 的所有元素都小于等于 <code>A[q]</code>，<code>A[q + 1..r]</code> 的所有元素都大于等于 <code>A[q]</code>。寻找恰当的 <code>A[q]</code> 也是这一步的一部分。</li>\n<li>处理：调用快速排序递归地排序 <code>A[p..q - 1]</code> 和 <code>A[q + 1..r]</code>。</li>\n<li>合并：这一步没有工作要做。</li>\n</ol>\n<p>以下是快速排序的伪代码：</p>\n<div><pre><code>QUICKSORT(A, p, r)\n  if p &lt; r\n    q = PARTITION(A, p, r)\n    QUICKSORT(A, p, q - 1)\n    QUICKSORT(A, q + 1, r)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div><h3 id=\"拆分数组\"> 拆分数组</h3>\n<p><code>PARTITION</code> 可以原地把 <code>A[p..r]</code> 拆分成两部分：</p>\n<div><pre><code>PARTITION(A, p, r)\n  x = A[r]\n  i = p - 1\n  for j = p to r - 1\n    if A[i] &lt;= x\n      i = i + 1\n      交换 A[i] 和 A[j]\n  交换 A[i + 1] 和 A[r]\n  return i + 1\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></div></div><p><code>PARTITION</code> 总选择 <code>A[r]</code> 作为<strong>轴</strong>来拆分数组。<code>PARTITION</code> 遍历数组，把小于等于 <code>A[r]</code> 的元素交换到数组前半部分。</p>\n<p>可以利用循环不变性证明算法的正确性。</p>\n<h2 id=\"_7-2-快速排序的性能\"> 7.2 快速排序的性能</h2>\n<p>快速排序的性能取决于数组拆分是否平衡。平衡拆分使得快速排序的渐近速度和归并排序一样快，不平衡的拆分使得快速排序的渐近速度退化到与插入排序类似。</p>\n<h3 id=\"最坏拆分\"> 最坏拆分</h3>\n<p>最坏拆分发生在一个子数组有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 个元素，而另一个子数组没有元素时。拆分数组花费 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span>，递推式为：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:3.0000000000000004em;vertical-align:-1.2500000000000002em;\"></span><span><span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>0</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>如果直接展开这个递推式：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:7.524108000000002em;vertical-align:-3.5120540000000005em;\"></span><span><span><span><span><span><span style=\"height:4.012054000000001em;\"><span style=\"top:-6.172054000000001em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-4.672054em;\"><span style=\"height:3em;\"></span><span></span></span><span style=\"top:-3.1720539999999993em;\"><span style=\"height:3em;\"></span><span></span></span><span style=\"top:-1.6720539999999995em;\"><span style=\"height:3em;\"></span><span></span></span><span style=\"top:-0.1479459999999997em;\"><span style=\"height:3em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:3.5120540000000005em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:4.012054000000001em;\"><span style=\"top:-6.172054000000001em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-4.672054em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>2</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-3.1720539999999993em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span></span></span><span style=\"top:-1.6720539999999995em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>Θ</span><span>(</span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span>2</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋯</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-0.1479459999999997em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:3.5120540000000005em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>如果想要更严格一些，也可以使用替换法。</p>\n<h3 id=\"最好拆分\"> 最好拆分</h3>\n<p>最好拆分发生在正好将数组平均拆分时。拆分数组花费 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span>，递推式是：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>/2</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span></span></p>\n<p>根据主定理（情况 2），<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>。</p>\n<h3 id=\"平衡拆分\"> 平衡拆分</h3>\n<p>快速排序的平均情况运行时间更接近最好情况运行时间。假设有输入实例，使得每次拆分都十分不平衡。比如说，每次拆分都是拆成 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>99</span></span></span></span> 比 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 的两部分。画出递归树之后可以发现，每一层的总和都不超过 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span><span>n</span></span></span></span>，树的深度是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.1135799999999998em;vertical-align:-0.41913999999999996em;\"></span><span><span>lo<span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.28086em;\"><span style=\"top:-2.45586em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>100/99</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.41913999999999996em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span>。</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:4.55914em;vertical-align:-2.02957em;\"></span><span><span><span><span><span><span style=\"height:2.52957em;\"><span style=\"top:-4.68957em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-3.18957em;\"><span style=\"height:3em;\"></span><span></span></span><span style=\"top:-1.63043em;\"><span style=\"height:3em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:2.02957em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:2.52957em;\"><span style=\"top:-4.68957em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>99</span><span>n</span><span>/100</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>/100</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>c</span><span>n</span></span></span><span style=\"top:-3.18957em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>c</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>lo<span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.28086em;\"><span style=\"top:-2.45586em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>100/99</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.41913999999999996em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span><span style=\"top:-1.63043em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:2.02957em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>可以发现，对于是否平衡的判断标准还是比较“宽容”的。</p>\n<h2 id=\"_7-3-随机快速排序\"> 7.3 随机快速排序</h2>\n<p>为了避免在每次拆分时都遇到最坏情况，可以把快速排序改成随机算法。</p>\n<div><pre><code>RANDOMIZED-PARTITION(A, p, r)\n  i = RANDOM(p, r)\n  交换 A[i] 和 A[r]\n  return PARTITION(A, p, r)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><div><pre><code>RANDOMIZED-QUICKSORT(A, p, r)\n  if p &lt; r\n    q = RANDOMIZED-PARTITION(A, p, r)\n    RANDOMIZED-QUICKSORT(A, p, q - 1)\n    RANDOMIZED-QUICKSORT(A, q + 1, r)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div><h2 id=\"_7-4-快速排序的分析\"> 7.4 快速排序的分析</h2>\n<h3 id=\"最坏情况分析\"> 最坏情况分析</h3>\n<p>在上文中证明了快速排序的最坏情况运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span>，这里再证明一下为什么最坏情况运行时间发生在一个子数组有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 个元素，而另一个子数组没有元素时。</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:4.010540000000001em;vertical-align:-1.7552700000000003em;\"></span><span><span><span><span><span><span style=\"height:2.2552700000000003em;\"><span style=\"top:-4.41527em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-2.3979459999999997em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:1.7552700000000003em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:2.2552700000000003em;\"><span style=\"top:-4.41527em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:0.43055999999999994em;\"><span style=\"top:-2.382892em;margin-left:0em;\"><span style=\"height:3em;\"></span><span><span><span>0</span><span>⩽</span><span style=\"margin-right:0.03588em;\">q</span><span>⩽</span><span>n</span><span>−</span><span>1</span></span></span></span><span style=\"top:-3em;\"><span style=\"height:3em;\"></span><span><span>max</span></span></span></span><span>​</span></span><span><span style=\"height:0.853216em;\"><span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span style=\"margin-right:0.03588em;\">q</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.03588em;\">q</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>))</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-2.3979459999999997em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:0.43055999999999994em;\"><span style=\"top:-2.382892em;margin-left:0em;\"><span style=\"height:3em;\"></span><span><span><span>0</span><span>⩽</span><span style=\"margin-right:0.03588em;\">q</span><span>⩽</span><span>n</span><span>−</span><span>1</span></span></span></span><span style=\"top:-3em;\"><span style=\"height:3em;\"></span><span><span>max</span></span></span></span><span>​</span></span><span><span style=\"height:0.853216em;\"><span></span></span></span></span></span><span>(</span><span>c</span><span><span style=\"margin-right:0.03588em;\">q</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>c</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.03588em;\">q</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span><span>)</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:1.7552700000000003em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>猜测 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span> 然后代入，得到了上面的第二个式子。容易知道，在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.78111em;vertical-align:-0.13667em;\"></span><span>0</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.83111em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.03588em;\">q</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 时，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.008548em;vertical-align:-0.19444em;\"></span><span>c</span><span><span style=\"margin-right:0.03588em;\">q</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>c</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.7777700000000001em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.03588em;\">q</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span>1</span><span><span>)</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span></span></span></span> 的最大值位于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.03588em;\">q</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.03588em;\">q</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 处。</p>\n<h3 id=\"平均情况分析\"> 平均情况分析</h3>\n<p>随机快速排序的期望运行时间应该和快速排序的平均情况运行时间相等，所以这里仅分析一下随机快速排序的期望运行时间。由于随机快速排序与快速排序仅有拆分时选择轴的部分有所不同，其余部分全部相同，所以主要讨论拆分函数。</p>\n<p>快速排序的运行时间主要取决于拆分函数。在拆分函数中，算法选择的轴不会出现在后续的递归调用中，因此拆分函数最多被调用 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 次。</p>\n<h3 id=\"引理-7-1\"> 引理 7.1</h3>\n<p>令 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.07847em;\">X</span></span></span></span> 是快速排序算法排序 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个元素时，拆分函数中第 4 行代码 <code>if A[i] &lt;= x</code> 运行的总次数。快速排序的运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.07847em;\">X</span><span>)</span></span></span></span>。</p>\n<p>上文已经讨论，拆分函数最多被调用 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 次。拆分函数中除循环之外，其他步骤都只花费常数时间，一共是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span>。再加上循环中花费的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span style=\"margin-right:0.07847em;\">X</span><span>)</span></span></span></span>，一共是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.07847em;\">X</span><span>)</span></span></span></span>。</p>\n<p>接下来需要计算 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.07847em;\">X</span></span></span></span>。设 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是数组中第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span> 小的元素，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.07153em;\">Z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 是包含了从第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span> 小到第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.05724em;\">j</span></span></span></span> 小元素的集合。算法什么时候会比较 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>？由于每次拆分中，算法选择一个轴，然后根据轴把数组划分为两部分，这之后的处理就与轴无关了。因此，任意一对元素之间最多发生一次比较。</p>\n<p>定义指示随机变量：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span style=\"margin-right:0.07847em;\">I</span><span>{</span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span> </span><span>和</span><span> </span></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span><span> </span><span>作比较</span></span><span>}</span></span></span></span></span></p>\n<p>由于任意一对元素之间最多发生一次比较：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.07847em;\">X</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.2148900000000005em;vertical-align:-1.4137769999999998em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>i</span><span>+</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>求数学期望：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:10.544670000000002em;vertical-align:-5.022335000000001em;\"></span><span><span><span><span><span><span style=\"height:5.522335000000001em;\"><span style=\"top:-7.522335000000002em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.07847em;\">X</span><span>]</span></span></span><span style=\"top:-4.007445000000001em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:-0.4925549999999994em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:5.022335000000001em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:5.522335000000001em;\"><span style=\"top:-7.522335000000002em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>i</span><span>+</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-4.007445000000001em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>i</span><span>+</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-0.4925549999999994em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>i</span><span>+</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>Pr</span><span>{</span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span> </span><span>和</span><span> </span></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span><span> </span><span>作比较</span></span><span>}</span></span></span></span><span>​</span></span><span><span style=\"height:5.022335000000001em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>接下来需要计算 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span>Pr</span><span>{</span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span> </span><span>和</span><span> </span></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span><span> </span><span>作比较</span></span><span>}</span></span></span></span>。相反的，从哪些元素之间不会被比较考虑更简单一些。假设数组中元素各不相同，注意到如果选择了 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>x</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 被选为轴，那么 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 之间不会再发生比较。而一旦 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.07153em;\">Z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 被选为轴，那么它需要与除它之外的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.07153em;\">Z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 中的所有元素作比较，其中当然也包括 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>。于是可以得到结论，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.07153em;\">Z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 中的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 作比较当且仅当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 或 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>\n被选作轴。</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:8.003760000000002em;vertical-align:-3.7518800000000008em;\"></span><span><span><span><span><span><span style=\"height:4.251880000000001em;\"><span style=\"top:-6.733320000000001em;\"><span style=\"height:3.32144em;\"></span><span><span>Pr</span><span>{</span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span> </span><span>和</span><span> </span></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span><span> </span><span>作比较</span></span><span>}</span></span></span><span style=\"top:-5.23332em;\"><span style=\"height:3.32144em;\"></span><span></span></span><span style=\"top:-3.251879999999999em;\"><span style=\"height:3.32144em;\"></span><span></span></span><span style=\"top:-0.7499999999999993em;\"><span style=\"height:3.32144em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:3.7518800000000008em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:4.251880000000001em;\"><span style=\"top:-6.733320000000001em;\"><span style=\"height:3.32144em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>Pr</span><span>{</span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span> </span><span>或</span><span> </span></span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span><span> </span><span>被选作轴</span></span><span>}</span></span></span><span style=\"top:-5.23332em;\"><span style=\"height:3.32144em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>Pr</span><span>{</span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span> </span><span>被选作轴</span></span><span>}</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Pr</span><span>{</span><span><span style=\"margin-right:0.04398em;\">z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span><span> </span><span>被选作轴</span></span><span>}</span></span></span><span style=\"top:-3.251879999999999em;\"><span style=\"height:3.32144em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.8804400000000001em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.8804400000000001em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-0.7499999999999993em;\"><span style=\"height:3.32144em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.8804400000000001em;\"><span></span></span></span></span></span><span></span></span></span></span></span><span>​</span></span><span><span style=\"height:3.7518800000000008em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>此时可以计算数学期望（用到了调和级数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.190108em;vertical-align:-0.345em;\"></span><span><span style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span><span><span><span style=\"height:0.804292em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:0.845108em;\"><span style=\"top:-2.6550000000000002em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span style=\"height:3em;\"></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.345em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span>ln</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span></span>）：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:15.210680000000004em;vertical-align:-7.355340000000002em;\"></span><span><span><span><span><span><span style=\"height:7.855340000000001em;\"><span style=\"top:-9.865896000000001em;\"><span style=\"height:3.811669em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.07847em;\">X</span><span>]</span></span></span><span style=\"top:-6.3404500000000015em;\"><span style=\"height:3.811669em;\"></span><span></span></span><span style=\"top:-2.9372240000000005em;\"><span style=\"height:3.811669em;\"></span><span></span></span><span style=\"top:0.4660020000000016em;\"><span style=\"height:3.811669em;\"></span><span></span></span><span style=\"top:2.8836710000000014em;\"><span style=\"height:3.811669em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:7.355340000000002em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:7.855340000000001em;\"><span style=\"top:-9.865896000000001em;\"><span style=\"height:3.811669em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>i</span><span>+</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.8804400000000001em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-6.3404500000000015em;\"><span style=\"height:3.811669em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.8116690000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-2.9372240000000005em;\"><span style=\"height:3.811669em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:0.4660020000000016em;\"><span style=\"height:3.811669em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span><span style=\"top:2.8836710000000014em;\"><span style=\"height:3.811669em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:7.355340000000002em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": [
        "算法导论"
      ]
    },
    {
      "title": "算法导论8 线性时间排序",
      "url": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/8%20%E7%BA%BF%E6%80%A7%E6%97%B6%E9%97%B4%E6%8E%92%E5%BA%8F/",
      "id": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/8%20%E7%BA%BF%E6%80%A7%E6%97%B6%E9%97%B4%E6%8E%92%E5%BA%8F/",
      "content_html": "<h1 id=\"算法导论8-线性时间排序\"> 算法导论8 线性时间排序</h1>\n<p>前几章中提到的几种排序方法，例如插入排序、归并排序、堆排序和快速排序，有一个共同点：顺序判断仅基于元素间的比较。这类排序算法称为<strong>比较排序</strong>（comparsion sort）。</p>\n<p>接下来会先证明比较排序算法都是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Ω</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>，然后给出几个可以在线性时间内排序的算法。</p>\n<h2 id=\"_8-1-比较排序的下界\"> 8.1 比较排序的下界</h2>\n<h3 id=\"决策树模型\"> 决策树模型</h3>\n<p>对于给定输入实例，决策树是代表元素之间比较的二叉树。举例来说，对于输入实例 <code>&lt;a,b,c&gt;</code> 来说：</p>\n<div><pre><code>                 +--&gt; &lt;a,b,c&gt;\n              &lt;= |\n      +--&gt; b:c --+          +--&gt; &lt;a,c,b&gt;\n      |        &gt; |       &lt;= |\n   &lt;= |          +--&gt; a:c --+\n      |                   &gt; |\na:b --+                     +--&gt; &lt;c,a,b&gt;\n      |\n    &gt; |          +--&gt; &lt;b,a,c&gt;\n      |       &lt;= |\n      +--&gt; a:c --+          +--&gt; &lt;b,c,a&gt;\n               &gt; |       &lt;= |\n                 +--&gt; b:c --+\n                          &gt; |\n                            +--&gt; &lt;c,b,a&gt;\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br></div></div><h3 id=\"最坏情况的下界\"> 最坏情况的下界</h3>\n<p>最坏的比较次数等于决策树的高度。因此所有决策树的高度下界（虽然叫下界，但是指的是最高的情况）就是所有比较排序的运行时间下界。</p>\n<h3 id=\"定理-8-1\"> 定理 8.1</h3>\n<p>比较排序算法在最坏情况下需要 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Ω</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span> 次比较。</p>\n<p>假设排序 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个元素时的决策树高度是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span>，且共有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.01968em;\">l</span></span></span></span> 个叶节点。注意，上文中给出的决策树例子是“最简”的，因为可以在 <code>b:c</code> 节点的子节点中再比较一次 <code>a:b</code>，这样决策树中就会多出许多无用的比较，从而产生很多重复的叶节点。<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个元素的排列一共有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>n</span><span>!</span></span></span></span> 种，高度为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span> 的二叉树叶节点不会超过 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.849108em;vertical-align:0em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>h</span></span></span></span></span></span></span></span></span></span></span> 个，因此有不等式：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83111em;vertical-align:-0.13667em;\"></span><span>n</span><span>!</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.83111em;vertical-align:-0.13667em;\"></span><span style=\"margin-right:0.01968em;\">l</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8991079999999999em;vertical-align:0em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>h</span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>对不等式最左和最右同时取对数：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83111em;vertical-align:-0.13667em;\"></span><span>h</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span>(</span><span>n</span><span>!)</span></span></span></span></span></p>\n<p>回忆 Stirling 近似：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:6.11488em;vertical-align:-2.80744em;\"></span><span><span><span><span><span><span style=\"height:3.30744em;\"><span style=\"top:-5.30744em;\"><span style=\"height:3.32144em;\"></span><span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span>(</span><span>n</span><span>!)</span></span></span><span style=\"top:-3em;\"><span style=\"height:3.32144em;\"></span><span></span></span><span style=\"top:-1.174em;\"><span style=\"height:3.32144em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:2.80744em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:3.30744em;\"><span style=\"top:-5.30744em;\"><span style=\"height:3.32144em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span>(</span><span><span><span><span style=\"height:0.956095em;\"><span style=\"top:-3em;\"><span style=\"height:3em;\"></span><span style=\"padding-left:0.833em;\"><span>2</span><span>πn</span></span></span><span style=\"top:-2.916095em;\"><span style=\"height:3em;\"></span><span style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span>​</span></span><span><span style=\"height:0.08390500000000001em;\"><span></span></span></span></span></span><span>(</span><span><span></span><span><span><span><span style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>e</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span><span>)</span><span><span><span><span style=\"height:0.7143919999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>)))</span></span></span><span style=\"top:-3em;\"><span style=\"height:3.32144em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span>(</span><span>2</span><span>πn</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span>(</span><span><span></span><span><span><span><span style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>e</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>))</span></span></span><span style=\"top:-1.174em;\"><span style=\"height:3.32144em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:2.80744em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Ω</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>。</p>\n<h3 id=\"推论-8-2\"> 推论 8.2</h3>\n<p>堆排序和归并排序是渐近最优的比较排序。</p>\n<h2 id=\"_8-2-计数排序\"> 8.2 计数排序</h2>\n<p><strong>计数排序</strong>（counting sort）假设输入的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个整数在区间 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>[</span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span>]</span></span></span></span> 中，其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 是某个整数。当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span> 时，计数排序的运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span>。计数排序的伪代码 <code>COUNTING-SORT(A, B, k)</code>（<code>A</code> 是待排序数组，<code>B</code> 是输出数组）如下：</p>\n<div><pre><code>COUNTING-SORT(A, B, k)\n  创建新数组 C[0..k]（数组中元素默认值为 0）\n\n  // 计数\n  for j = 1 to A.length\n    C[A[j]] = C[A[j]] + 1\n\n  // 运行前：C[i] 中的值代表原数组中有多少等于 i 的元素\n  // 运行后：C[i] 中的值代表原数组中有多少小于等于 i 的元素\n  for i = 1 to k\n    C[i] = C[i] + C[i-1]\n\n  for j = A.length downto 1\n    B[C[A[j]]] = A[j]\n    C[A[j]] = C[A[j]] - 1\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br></div></div><p>计数排序还有<strong>稳定</strong>（stable）的优点：值相同的元素排序之前的顺序和排序之后的顺序是相同的。</p>\n<h2 id=\"_8-3-基数排序\"> 8.3 基数排序</h2>\n<p><strong>基数排序</strong>（radix sort）从最低位到最高位按位给元素排序。</p>\n<div><pre><code>         +     +     +\n329    720    720    329\n457    355    329    355\n657    436    436    436\n839 -&gt; 457 -&gt; 839 -&gt; 457\n436    657    355    657\n720    329    457    720\n355    839    657    839\n         ^     ^     ^\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></div></div><p>伪代码如下：</p>\n<div><pre><code>RADIX-SORT(A, d)\n  for i = 1 to d\n    使用稳定排序算法根据第 i 位的数字排序 A\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><h3 id=\"引理-8-3\"> 引理 8.3</h3>\n<p>给定 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>d</span></span></span></span> 位的数字，每一位上可能出现 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 种不同的值。如果稳定排序算法的运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span>)</span></span></span></span>，那么基数排序的运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>d</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span>))</span></span></span></span>。</p>\n<p>如果 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>d</span></span></span></span> 是常数且 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span>，那么基数排序的运行时间就是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span> 了。</p>\n<h3 id=\"引理-8-4\"> 引理 8.4</h3>\n<p>给定 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>b</span></span></span></span> 比特的数字和任意正整数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span style=\"margin-right:0.02778em;\">r</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>b</span></span></span></span>，如果稳定排序算法的运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span>)</span></span></span></span>，那么基数排序的运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>((</span><span>b</span><span>/</span><span style=\"margin-right:0.02778em;\">r</span><span>)</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.02778em;\">r</span></span></span></span></span></span></span></span><span>))</span></span></span></span>。</p>\n<p>举个例子来说，可以把 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>32</span></span></span></span> 比特的数字看成四个 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>8</span></span></span></span> 比特数字拼接而成。此时有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>b</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>32</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.02778em;\">r</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>8</span></span></span></span>。</p>\n<h2 id=\"_8-4-桶排序\"> 8.4 桶排序</h2>\n<p>如果输入符合均匀分布，<strong>桶排序</strong>（bucket sort）的平均情况运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span>。</p>\n<p>假设输入是在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>[</span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>)</span></span></span></span> 区间的实数。桶排序把 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>[</span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>)</span></span></span></span> 区间分成 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个相同大小的子区间，称为桶。排序时，桶排序把要排序的数字放入对应的桶中，然后把每个桶中的元素排序。</p>\n<div><pre><code>BUCKET-SORT(A)\n  n = A.length\n  创建新数组 B[0..n - 1]\n  for i = 0 to n - 1\n    B[i] 为空数组\n  for i = 1 to n\n    把 A[i] 插入到 B[n * A[i]] 中\n  for i = 0 to n - 1\n    使用插入排序把 B[i] 排序\n  将 B[0] 到 B[n - 1] 连接起来\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br></div></div><p>接下来分析一下桶排序的运行时间：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:3.0787820000000004em;vertical-align:-1.277669em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.247em;\"><span></span></span></span></span></span></span><span>)</span></span></span></span></span></p>\n<p>求数学期望：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:10.136346000000001em;vertical-align:-4.818173000000001em;\"></span><span><span><span><span><span><span style=\"height:5.318173000000001em;\"><span style=\"top:-7.318173000000001em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)]</span></span></span><span style=\"top:-3.9393910000000005em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:-0.5606089999999997em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:4.818173000000001em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:5.318173000000001em;\"><span style=\"top:-7.318173000000001em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span>Θ</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.247em;\"><span></span></span></span></span></span></span><span>)]</span></span></span><span style=\"top:-3.9393910000000005em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.247em;\"><span></span></span></span></span></span></span><span>)]</span></span></span><span style=\"top:-0.5606089999999997em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span>n</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.247em;\"><span></span></span></span></span></span></span><span>])</span></span></span></span><span>​</span></span><span><span style=\"height:4.818173000000001em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>定义指示随机变量：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.07847em;\">I</span><span>{</span><span>A</span><span>[</span><span style=\"margin-right:0.05724em;\">j</span><span>]</span><span><span> </span><span>落在桶</span><span> </span></span><span>i</span><span><span> </span><span>中</span></span><span>}</span></span></span></span></span></p>\n<p>所以有：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.0651740000000007em;vertical-align:-1.4137769999999998em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>代入：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:13.509584000000004em;vertical-align:-6.504792000000001em;\"></span><span><span><span><span><span><span style=\"height:7.004792000000002em;\"><span style=\"top:-9.004792000000002em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span>n</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.247em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-5.639618000000001em;\"><span style=\"height:3.6513970000000007em;\"></span><span></span></span><span style=\"top:-2.274444em;\"><span style=\"height:3.6513970000000007em;\"></span><span></span></span><span style=\"top:1.1151740000000003em;\"><span style=\"height:3.6513970000000007em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:6.504792000000001em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:7.004792000000002em;\"><span style=\"top:-9.004792000000002em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[(</span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span><span>)</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-5.639618000000001em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.03148em;\">ik</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-2.274444em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.864108em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span><span style=\"top:-3.1130000000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.383108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span><span style=\"height:1.050005em;\"><span style=\"top:-1.8723309999999997em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>1</span><span>⩽</span><span style=\"margin-right:0.05724em;\">j</span><span>⩽</span><span>n</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span></span><span>​</span></span><span><span style=\"height:1.413777em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.050005em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>1</span><span>⩽</span><span style=\"margin-right:0.03148em;\">k</span><span>⩽</span><span>n</span><span><span>，</span></span><span style=\"margin-right:0.03148em;\">k</span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span></span><span>​</span></span><span><span style=\"height:1.438221em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.03148em;\">ik</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:1.1151740000000003em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.864108em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span><span style=\"top:-3.1130000000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.383108em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span><span style=\"height:1.050005em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>1</span><span>⩽</span><span style=\"margin-right:0.03148em;\">k</span><span>⩽</span><span>n</span><span><span>，</span></span><span style=\"margin-right:0.03148em;\">k</span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span></span><span>​</span></span><span><span style=\"height:1.438221em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.03148em;\">ik</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span></span></span></span><span>​</span></span><span><span style=\"height:6.504792000000001em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>其中第一项：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.2472159999999999em;vertical-align:-0.383108em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.864108em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span><span style=\"top:-3.1130000000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.383108em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.00744em;vertical-align:-0.686em;\"></span><span><span>1</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1.1141079999999999em;vertical-align:-0.25em;\"></span><span><span>0</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:2.00744em;vertical-align:-0.686em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.00744em;vertical-align:-0.686em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>注意理解指示随机变量的幂次，回忆其定义：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.08125em;\">H</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.07847em;\">I</span><span>{</span><span style=\"margin-right:0.08125em;\">H</span><span>}</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span><span style=\"top:0em;\"><span>{</span></span><span><span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span>1</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span style=\"margin-right:0.08125em;\">H</span><span><span> </span><span>发生</span></span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span style=\"margin-right:0.08125em;\">H</span><span><span> </span><span>不发生</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>所以：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.1111079999999998em;vertical-align:-0.247em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.08125em;\">H</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.247em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.07847em;\">I</span><span>{</span><span style=\"margin-right:0.08125em;\">H</span><span>}</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.07847em;\">I</span><span>{</span><span style=\"margin-right:0.08125em;\">H</span><span>}</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span><span style=\"top:0em;\"><span>{</span></span><span><span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span><span>1</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span><span>0</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span style=\"margin-right:0.08125em;\">H</span><span><span> </span><span>发生</span></span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span style=\"margin-right:0.08125em;\">H</span><span><span> </span><span>不发生</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>换句话说，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span></span></span></span></span></span></span></span> 类似于迭代函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.138em;vertical-align:-0.25em;\"></span><span><span style=\"margin-right:0.10764em;\">f</span><span><span><span><span style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>(</span><span>n</span><span>)</span></span></span></span></span></span></span></span></span><span>(</span><span>x</span><span>)</span></span></span></span>。</p>\n<p>回到第二项：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.03148em;\">ik</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.03148em;\">ik</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.00744em;vertical-align:-0.686em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span><span><span><span style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>所以：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:10.311938000000001em;vertical-align:-4.905969em;\"></span><span><span><span><span><span><span style=\"height:5.405969000000001em;\"><span style=\"top:-7.405969000000002em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span>n</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.247em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-4.346308000000001em;\"><span style=\"height:3.6513970000000007em;\"></span><span></span></span><span style=\"top:-2.038868000000002em;\"><span style=\"height:3.6513970000000007em;\"></span><span></span></span><span style=\"top:0.26857199999999903em;\"><span style=\"height:3.6513970000000007em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:4.905969em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:5.405969000000001em;\"><span style=\"top:-7.405969000000002em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span><span style=\"height:1.050005em;\"><span style=\"top:-1.8723309999999997em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>1</span><span>⩽</span><span style=\"margin-right:0.05724em;\">j</span><span>⩽</span><span>n</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span></span><span>​</span></span><span><span style=\"height:1.413777em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.050005em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>1</span><span>⩽</span><span style=\"margin-right:0.03148em;\">k</span><span>⩽</span><span>n</span><span><span>，</span></span><span style=\"margin-right:0.03148em;\">k</span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span></span><span>​</span></span><span><span style=\"height:1.438221em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span><span><span><span style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-4.346308000000001em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>n</span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>n</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span><span><span><span style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-2.038868000000002em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:0.26857199999999903em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span></span><span>​</span></span><span><span style=\"height:4.905969em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>综上，桶排序的运行时间为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span>。</p>\n",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": [
        "算法导论"
      ]
    },
    {
      "title": "算法导论",
      "url": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/",
      "id": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/",
      "content_html": "<h1 id=\"算法导论\"> 算法导论</h1>\n<ul>\n<li>I 基础概念\n<ul>\n<li><a href=\"./doc/1 算法的概念.html\">1 算法的概念</a></li>\n<li><a href=\"./doc/2 设计算法的流程.html\">2 设计算法的流程</a></li>\n<li><a href=\"./doc/3 函数的增长.html\">3 函数的增长</a></li>\n<li><a href=\"./doc/4 分治.html\">4 分治</a></li>\n<li><a href=\"./doc/5 概率分析和随机算法.html\">5 概率分析和随机算法</a></li>\n</ul>\n</li>\n<li>II 排序和顺序统计\n<ul>\n<li><a href=\"./doc/6 堆排序.html\">6 堆排序</a></li>\n<li><a href=\"./doc/7 快速排序.html\">7 快速排序</a></li>\n<li><a href=\"./doc/8 线性时间排序.html\">8 线性时间排序</a></li>\n<li><a href=\"./doc/9 中位数和顺序统计.html\">9 中位数和顺序统计</a></li>\n</ul>\n</li>\n<li>III 数据结构\n<ul>\n<li><a href=\"./doc/10 基础数据结构.html\">10 基础数据结构</a></li>\n<li><a href=\"./doc/11 哈希表.html\">11 哈希表</a></li>\n<li><a href=\"./doc/12 二叉搜索树.html\">12 二叉搜索树</a></li>\n</ul>\n</li>\n</ul>\n",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": []
    },
    {
      "title": "zenk's blog",
      "url": "https://flyginger.top/",
      "id": "https://flyginger.top/",
      "content_html": "",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": []
    },
    {
      "title": "算法导论12 二叉搜索树",
      "url": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/12%20%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/",
      "id": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/12%20%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/",
      "content_html": "<h1 id=\"算法导论12-二叉搜索树\"> 算法导论12 二叉搜索树</h1>\n<h2 id=\"_12-1-二叉搜索树\"> 12.1 二叉搜索树</h2>\n<p>以下是两棵二叉搜索树：</p>\n<p><img src=\"./../img/12-1.png\" alt=\"一棵二叉搜索树\" /></p>\n<p><strong>二叉搜索树</strong>（BST，binary search tree）满足以下<strong>二叉搜索树性质</strong>（binary-search-tree property）：</p>\n<p>令 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span> 是二叉搜索树中的一个节点。如果 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.03588em;\">y</span></span></span></span> 是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span> 的左孩子，那么 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.03588em;\">y</span><span>.</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.03588em;\">ey</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>x</span><span>.</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.03588em;\">ey</span></span></span></span>。如果 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.03588em;\">y</span></span></span></span> 是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span> 的右孩子，那么 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.03588em;\">y</span><span>.</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.03588em;\">ey</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>x</span><span>.</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.03588em;\">ey</span></span></span></span>。</p>\n<p>二叉搜索树的性质提供了按从小到大顺序输出树中数据的便捷方法：<strong>中序遍历</strong>（inorder tree walk）。中序遍历这个名字来自于它的具体步骤，它会先输出左子树中的数据，然后输出本节点内的数据，最后输出右子树中的数据。由于本节点的数据位于中间，所以称为中序遍历。类似地还有<strong>前序遍历</strong>（preorder tree walk）和<strong>后序遍历</strong>（postorder tree walk）。前序遍历会先输出本节点中的数据，然后是左子树和右子树中的数据。后序遍历会先输出左子树和右子树中的数据，最后输出本节点中的数据。</p>\n<div><pre><code>INORDER-TREE-WALK(x)\n  if x != nil\n    INORDER-TREE-WALK(x.left)\n    print x.key\n    INORDER-TREE-WALK(x.right)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div><h3 id=\"定理-12-1\"> 定理 12.1</h3>\n<p>如果 <code>x</code> 是含有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个节点的树的根节点，那么 <code>INORDER-TREE-WALK(x)</code> 将花费 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span> 的时间。</p>\n<p>证明也非常简单。由于遍历树必定要经过每个节点，因此运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Ω</span><span>(</span><span>n</span><span>)</span></span></span></span>。接下来证明运行时间也是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span>，这样结合起来就是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span> 了。</p>\n<p>显然，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>0</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span></span></span></span>，其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>c</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span> 是常数。<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span> 时，根据其递归形式可知 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>d</span></span></span></span>，其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span>d</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span> 也是常数。</p>\n<p>接下来使用数学归纳法证明 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>c</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>d</span><span>)</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span></span></span></span>。首先是基础情况，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span> 时，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>c</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>c</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>d</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span>0</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span></span></span></span> 成立。然后是归纳部分，对于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span> 时：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:4.500000000000002em;vertical-align:-2.000000000000001em;\"></span><span><span><span><span><span><span style=\"height:2.5000000000000004em;\"><span style=\"top:-4.66em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-3.16em;\"><span style=\"height:3em;\"></span><span></span></span><span style=\"top:-1.6599999999999993em;\"><span style=\"height:3em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:2.000000000000001em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:2.5000000000000004em;\"><span style=\"top:-4.66em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>d</span></span></span><span style=\"top:-3.16em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span>c</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>d</span><span>)</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>c</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span>c</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>d</span><span>)</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>c</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>d</span></span></span><span style=\"top:-1.6599999999999993em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span>c</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>d</span><span>)</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>c</span></span></span></span><span>​</span></span><span><span style=\"height:2.000000000000001em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<h2 id=\"_12-2-二叉搜索树的查询\"> 12.2 二叉搜索树的查询</h2>\n<p>在二叉搜索树中，除了 <code>SEARCH</code>，还有 <code>MAXIMUM</code>、<code>MINIMUM</code>、<code>SUCCESSOR</code>、<code>PREDECESSOR</code> 等操作。在高度为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span> 的二叉搜索树中，这些操作的运行时间都是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>h</span><span>)</span></span></span></span>。</p>\n<h3 id=\"搜索\"> 搜索</h3>\n<div><pre><code>TREE-SEARCH(x, k)\n  if x == nil or k == x.key\n    return x\n  if k &lt; x.key\n    return TREE-SEARCH(x.left, k)\n  else\n    return TREE-SEARCH(x.right, k)\n\nITERATIVE-TREE-SEARCH(x, k):\n  while x != nil and k != x.key\n    if k &lt; x.key\n      x = k.left\n    else\n      x = k.right\n  return x\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br></div></div><p>以上分别是递归版本和迭代版本。通常来说，迭代版本会更快一些。由于在每次迭代中都会移动到高度更低的节点，因此在高度为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span> 的二叉搜索树中搜索的运行时间不会超过 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>h</span><span>)</span></span></span></span>。算法的流程十分直觉，根据二叉搜索树的性质，比 <code>x.key</code> 小的 <code>k</code> 只能在其左子树中，比 <code>x.key</code> 大的 <code>k</code> 只能在其右子树中。</p>\n<h3 id=\"最大值和最小值\"> 最大值和最小值</h3>\n<div><pre><code>TREE-MINIMUM(x)\n  while x.left != nil\n    x = x.left\n  return x\n\nTREE-MAXIMUM(x)\n  while x.right != nil\n    x = x.right\n  return x\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></div></div><p>根据二叉搜索树的性质，以上算法可以得到树中数据的最值。注意以上算法默认 <code>x</code> 不是 <code>nil</code>。</p>\n<h3 id=\"先导和后继\"> 先导和后继</h3>\n<p>在本章的开头提到，每个二叉搜索树都可以通过中序遍历转换成一个有序序列。节点 <code>x</code> 的<strong>先导</strong>（predecessor）指的是该有序序列中 <code>x</code> 的前一个节点，<strong>后继</strong>（successor）指的是该有序序列中 <code>x</code> 的后一个节点。如果二叉搜索树中保存的数据没有重复值，那么节点 <code>x</code> 的先导就是比它小的最大值，后继就是比它大的最小值。当然，先导和后继可能是不存在的。</p>\n<div><pre><code>TREE-SUCCESSOR(x)\n  if x.right != nil\n    return MINIMUM(x.right)\n  y = x.parent\n  while y != nil and x == y.right\n    x = y\n    y = y.parent\n  return y\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br></div></div><p>寻找后继的算法分为两种情况。第一种中 <code>x</code> 有右子树，那么其后继就存在于右子树中，例如本章一开始的图片中的节点 7。第二种情况 <code>x</code> 没有右子树，那么需要向上寻找，例如节点 4。</p>\n<div><pre><code>TREE-PREDECESSOR(x)\n  if x.left != nil\n    return MAXIMUM(x.left)\n  y = x.parent\n  while y != nil and x == y.left\n    x = y\n    y = y.parent\n  return y\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br></div></div><p>寻找先导的算法与寻找后继的算法是完全对称的。</p>\n<h3 id=\"定理-12-2\"> 定理 12.2</h3>\n<p>使用高度为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span> 的二叉搜索树实现的动态集合的 <code>SEARCH</code>、<code>MINIMUM</code>、<code>MAXIMUM</code>、<code>SUCCESSOR</code>、<code>PREDECESSOR</code> 的运行时间都是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>h</span><span>)</span></span></span></span>。</p>\n<h2 id=\"_12-3-二叉搜索树的插入和删除\"> 12.3 二叉搜索树的插入和删除</h2>\n<p>二叉搜索树中的插入比较简单，但是删除有些复杂。</p>\n<h3 id=\"插入\"> 插入</h3>\n<p>插入与搜索类似，只不过在插入算法中，只有遇到空位才会停止。</p>\n<div><pre><code>TREE-INSERT(T, z)\n  // 因为以下循环停止时 x 是 nil，因此需要用 y 记录其父节点\n  y = nil\n  x = T.root\n  while x != nil\n    y = x\n    if z.key &lt; x.key\n      x = x.left\n    else\n      x = x.right\n  \n  // 将 z 连接到树中\n  z.p = y\n  if y == nil\n    // T 是空的\n    T.root = z\n  else if z.key &lt; y.key\n    y.left = z\n  else\n    y.right = z\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br></div></div><p>根据以上代码的结构，易知其运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>h</span><span>)</span></span></span></span>。</p>\n<h3 id=\"删除\"> 删除</h3>\n<p>删除的复杂之处在于删掉节点后仍需保持二叉搜索树性质成立。假设需要删除的节点是 <code>z</code>，大致情况可以分为以下三种：</p>\n<ol>\n<li><code>z</code> 没有子节点，那么可以直接删除 <code>z</code>。</li>\n<li><code>z</code> 只有一个子节点，那么用它来替换 <code>z</code> 的位置。</li>\n<li><code>z</code> 有两个子节点，那么用 <code>z</code> 的后继来替换 <code>z</code> 的位置。</li>\n</ol>\n<p>在实际实现时会与以上情况分类有所不同，细节如下：</p>\n<ol>\n<li>如果 <code>z</code> 没有左孩子，那么用 <code>z</code> 的右孩子来替换它的位置。注意右孩子可能是 <code>nil</code>。</li>\n<li>如果 <code>z</code> 只有左孩子，那么用 <code>z</code> 的左孩子来替换它的位置。</li>\n<li>如果 <code>z</code> 既有左孩子又有右孩子，那么找到 <code>z</code> 的后继 <code>y</code>。由于此时 <code>z</code> 有右孩子，所以 <code>y</code> 必位于 <code>z</code> 的右子树。注意，<code>y</code> 不可能有左孩子，否则 <code>z</code> 的后继不可能是 <code>y</code>，以下两种情况中都会用到这个条件。现在又可以分为两种情况：\n<ol>\n<li><code>y</code> 恰好是 <code>z</code> 的右孩子，那么就可以简单地令 <code>z.key = y.key</code>，然后 <code>z.right = y.right</code> 即可。</li>\n<li><code>y</code> 不是 <code>z</code> 的右孩子，需要先令 <code>z.key = y.key</code>，然后再令 <code>y.parent.left = y.right</code>。因为 <code>y</code> 是 <code>z</code> 的后继，所以 <code>y</code> 一定是其父节点的左孩子。</li>\n</ol>\n</li>\n</ol>\n<p>删除本章开头的二叉搜索树中的 6 对应情况 3.1，删除 7 对应情况 3.2。</p>\n<p>为了让删除的算法更简洁，先实现一个 <code>TRANSPLANT</code> 的小函数，它可以用一个子树替换某子树的位置。</p>\n<div><pre><code>TRANSPLANT(T, u, v)\n  // 用 v 替换 u\n  if u.parent == nil\n    // u 是根节点\n    T.root = v\n  else if u = u.parent.left\n    u.parent.left = v\n  else\n    u.parent.right = v\n  \n  if v != nil\n    v.parent = u.parent\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br></div></div><p>最终的删除算法如下：</p>\n<div><pre><code>TREE-DELETE(T, z)\n  if z.left == nil\n    TRANSPLANT(T, z, z.right)\n  else if z.right == nil\n    TRANSPLANT(T, z, z.left)\n  else\n    y = TREE-SUCCESSOR(T, z)\n    if y.parent != z\n      TRANSPLANT(T, y, y.right)\n      y.right = z.right\n      y.right.parent = y\n    TRANSPLANT(T, z, y)\n    y.left = z.left\n    y.left.parent = y\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br></div></div><h3 id=\"定理-12-3\"> 定理 12.3</h3>\n<p>使用高度为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span> 的二叉搜索树实现的动态集合的 <code>INSERT</code>、<code>DELETE</code> 的运行时间都是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>h</span><span>)</span></span></span></span>。</p>\n<h2 id=\"_12-4-随机构造二叉搜索树\"> 12.4 随机构造二叉搜索树</h2>\n<p>含有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个节点的二叉搜索树的高度 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83111em;vertical-align:-0.13667em;\"></span><span>h</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⌊</span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>⌋</span></span></span></span>。而且如果按照严格降序或者升序地插入新数据，二叉搜索树的高度会变成 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>，其性能也就退化到了链表的水平了。</p>\n<p>定义<strong>随机构造二叉搜索树</strong>（randomly built binary search tree），从 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 到 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个数据按随机顺序插入树中。</p>\n<h3 id=\"定理-12-4\"> 定理 12.4</h3>\n<p>含有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个节点的随机构造二叉搜索树的期望高度是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>。</p>\n<p>定义含有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个节点的随机构造二叉搜索树的高度是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，然后定义指数高度（exponential height）<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8413309999999999em;vertical-align:0em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.16454285714285719em;\"><span style=\"top:-2.357em;margin-left:-0.07847em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>。定义 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.00773em;\">R</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是该树的根节点的<strong>秩</strong>（rank）。秩是指该节点在中序遍历产生的序列中排行第几位（从 1 开始计数）。也就是说 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.00773em;\">R</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是树的根节点在中序遍历中排行第几位。如果 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.00773em;\">R</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span>，那么根节点的左子树一共有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.74285em;vertical-align:-0.08333em;\"></span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 个节点，而根节点的右子树一共有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span> 个节点。由于树的高度等于最高的子树的高度加 1，所以：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>max</span><span>(</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>−</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span>)</span></span></span></span></span></p>\n<p>另外，定义 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>。定义随机指示变量 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.07153em;\">Z</span><span><span><span><span style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>,</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span><span>，</span></span><span><span style=\"margin-right:0.07153em;\">Z</span><span><span><span><span style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>,</span><span>2</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span><span>，</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>，</span></span><span><span style=\"margin-right:0.07153em;\">Z</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>,</span><span>n</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.07153em;\">Z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>,</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.07847em;\">I</span><span>{</span><span><span style=\"margin-right:0.00773em;\">R</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>i</span><span>}</span></span></span></span></span></p>\n<p>由于插入数据是随机排列的，因此任意 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.78111em;vertical-align:-0.13667em;\"></span><span>1</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.79619em;vertical-align:-0.13667em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 都满足 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Pr</span><span>{</span><span><span style=\"margin-right:0.00773em;\">R</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>i</span><span>}</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>n</span></span></span></span>。所以对于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.78111em;vertical-align:-0.13667em;\"></span><span>1</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.79619em;vertical-align:-0.13667em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07153em;\">Z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>,</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>n</span></span></span></span></span></p>\n<p>以上是数学期望，在实际情况中，只有一个 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.07153em;\">Z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>,</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 是 1，其他的都是 0。所以：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.929066em;vertical-align:-1.277669em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07153em;\">Z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>,</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>(</span><span>2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>max</span><span>(</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>−</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span>))</span></span></span></span></span></p>\n<p>选定 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.00773em;\">R</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span> 时，前 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.74285em;vertical-align:-0.08333em;\"></span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 个数据的顺序仍然是随机的，因此 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.07153em;\">Z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>,</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 与 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.891661em;vertical-align:-0.208331em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.891661em;vertical-align:-0.208331em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>−</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span> 是相互独立的。</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:22.753178000000002em;vertical-align:-11.126589000000003em;\"></span><span><span><span><span><span><span style=\"height:11.626589em;\"><span style=\"top:-13.776305em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-10.547239em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:-7.318172999999998em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:-4.0891069999999985em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:-0.8600409999999992em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:2.3690250000000006em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:5.747807000000002em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:11.126589000000003em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:11.626589em;\"><span style=\"top:-13.776305em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07153em;\">Z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>,</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>(</span><span>2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>max</span><span>(</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>−</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span>))]</span></span></span><span style=\"top:-10.547239em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07153em;\">Z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>,</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>(</span><span>2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>max</span><span>(</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>−</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span>))]</span></span></span><span style=\"top:-7.318172999999998em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07153em;\">Z</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>,</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span>2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>max</span><span>(</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>−</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span>)]</span></span></span><span style=\"top:-4.0891069999999985em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span>2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>max</span><span>(</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>−</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span>)]</span></span></span><span style=\"top:-0.8600409999999992em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span>max</span><span>(</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>−</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span>)]</span></span></span><span style=\"top:2.3690250000000006em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>−</span><span>i</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span>])</span></span></span><span style=\"top:5.747807000000002em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span></span></span></span><span>​</span></span><span><span style=\"height:11.126589000000003em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>先停一下，证明一个等式 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.2710029999999999em;vertical-align:-0.316995em;\"></span><span><span style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span><span><span><span style=\"height:0.954008em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-2.441336em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>+</span><span>3</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.316995em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.1205469999999997em;vertical-align:-0.30643899999999996em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.8141079999999998em;\"><span style=\"top:-2.451892em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>+</span><span>3</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.30643899999999996em;\"><span></span></span></span></span></span></span></span></span></span>。</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:25.069452000000002em;vertical-align:-12.284726em;\"></span><span><span><span><span><span><span style=\"height:12.784726000000003em;\"><span style=\"top:-14.784726000000003em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.864108em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>+</span><span>3</span></span></span></span><span style=\"top:-3.1130000000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.305331em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-11.405944000000003em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:-8.027162000000002em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:-4.648380000000001em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:-1.5796030000000014em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:0.8975049999999981em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:3.310504999999996em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:5.723504999999996em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:7.823612999999998em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:12.284726em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:12.784726000000003em;\"><span style=\"top:-14.784726000000003em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>3</span><span>!</span><span>(</span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>3</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>3</span><span>)!</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>(</span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>3</span><span>)!</span></span></span></span><span>​</span></span><span><span style=\"height:0.936em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-11.405944000000003em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>3</span><span>!</span><span>i</span><span>!</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>(</span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>3</span><span>)!</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-8.027162000000002em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>3</span><span>!</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>(</span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>3</span><span>)</span><span>(</span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>2</span><span>)</span><span>(</span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-4.648380000000001em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>6</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>i</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>i</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>6</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>11</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span></span></span><span style=\"top:-1.5796030000000014em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.491108em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>24</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span><span>)</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>6</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span>(</span><span>2</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>12</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>11</span><span>n</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>n</span></span></span><span style=\"top:0.8975049999999981em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.491108em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>24</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>6</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>11</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>6</span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:3.310504999999996em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>4</span><span>!</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>3</span><span>)</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>2</span><span>)</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:5.723504999999996em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>4</span><span>!</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)!</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>3</span><span>)!</span></span></span></span><span>​</span></span><span><span style=\"height:0.936em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:7.823612999999998em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.864108em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>+</span><span>3</span></span></span></span><span style=\"top:-3.1130000000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.305331em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:12.284726em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>应该有更好的证明方法，以上是直接证明的思路，硬算就是了。然后使用数学归纳法证明 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.1205469999999997em;vertical-align:-0.30643899999999996em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.8141079999999998em;\"><span style=\"top:-2.451892em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>+</span><span>3</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.30643899999999996em;\"><span></span></span></span></span></span></span><span>/4</span></span></span></span>。基础情况是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 时，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.78111em;vertical-align:-0.13667em;\"></span><span>0</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-2.4518920000000004em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.24810799999999997em;\"><span></span></span></span></span></span></span><span>/4</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/4</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.78111em;vertical-align:-0.13667em;\"></span><span>1</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-2.4518920000000004em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.24810799999999997em;\"><span></span></span></span></span></span></span><span>/4</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>。对于递归情况：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:15.045893em;vertical-align:-7.2729465em;\"></span><span><span><span><span><span><span style=\"height:7.772946500000001em;\"><span style=\"top:-9.772946500000002em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-6.394164500000002em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:-3.0153825000000003em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:0.07283349999999988em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:2.485833499999999em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:7.2729465em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:7.772946500000001em;\"><span style=\"top:-9.772946500000002em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-6.394164500000002em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.521103em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>4</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.706995em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-2.441336em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>+</span><span>3</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.316995em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-3.0153825000000003em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.864108em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>+</span><span>3</span></span></span></span><span style=\"top:-3.1130000000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.305331em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:0.07283349999999988em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.5105469999999999em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6964390000000003em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.8141079999999998em;\"><span style=\"top:-2.451892em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>+</span><span>3</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.30643899999999996em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:2.485833499999999em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>24</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>3</span><span>)</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>2</span><span>)</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span></span><span>​</span></span><span><span style=\"height:7.2729465em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>因此 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>(</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span></span></span></span> 是多项式的。回忆 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8413309999999999em;vertical-align:0em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.16454285714285719em;\"><span style=\"top:-2.357em;margin-left:-0.07847em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>，所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是对数的，换句话说，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>。</p>\n<div><p>提示</p>\n<p>上面最后一段并不严谨，实际上需要凸函数和 Jensen 不等式相关的知识。我认为最后一段已经说得通了，所以就不研究了，感兴趣的可以搜搜。</p>\n</div>\n",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": [
        "算法导论"
      ]
    },
    {
      "title": "算法导论2 设计算法的流程",
      "url": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/2%20%E8%AE%BE%E8%AE%A1%E7%AE%97%E6%B3%95%E7%9A%84%E6%B5%81%E7%A8%8B/",
      "id": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/2%20%E8%AE%BE%E8%AE%A1%E7%AE%97%E6%B3%95%E7%9A%84%E6%B5%81%E7%A8%8B/",
      "content_html": "<h1 id=\"算法导论2-设计算法的流程\"> 算法导论2 设计算法的流程</h1>\n<p>设计、证明、分析是处理计算问题的基本步骤。本章以排序问题为例，遍历了这三个基本步骤。首先给出了一个算法（插入排序），证明了它的正确性，分析了它的运行时间。然后使用另一种设计思想（分治）设计了另一种算法（归并排序），同样证明了它的正确性，分析了它的运行时间。</p>\n<h2 id=\"_2-1-插入排序\"> 2.1 插入排序</h2>\n<p>前文提到，排序问题的定义是：</p>\n<blockquote>\n<p><strong>输入</strong>：含有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个数字的序列 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⟨</span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>⟩</span></span></span></span>。</p>\n<p><strong>输出</strong>：输入序列的某个满足 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.24810799999999997em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.24810799999999997em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.24810799999999997em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.24810799999999997em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>⋯</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.998892em;vertical-align:-0.247em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span> 的排列 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.001892em;vertical-align:-0.25em;\"></span><span>⟨</span><span><span>a</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.24810799999999997em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.24810799999999997em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.247em;\"><span></span></span></span></span></span></span><span>⟩</span></span></span></span>。</p>\n</blockquote>\n<p>插入排序是为少量元素排序的高效算法。该算法与抓牌类似，手中的牌保持有序，每次从牌堆中抓取一张，插入到手牌中的适当位置使其仍然有序。<strong>伪代码</strong>（pseudocode）如下：</p>\n<div><pre><code>INSERTION-SORT(A)\n  for j = 2 to A.length\n    // 备份 A[j]，因为后续步骤中 A[j] 可能会被覆盖掉\n    key = A[j]\n\n    i = j - 1\n    while i &gt; 0 and A[i] &gt; key\n      // 如果 A[i] 比 A[j] 大，那么将 A[i] 往后挪动一格\n      A[i + 1] = A[i]\n      i = i - 1\n    \n    // 把 A[j] 插入到此处\n    A[i + 1] = key\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br></div></div><h3 id=\"循环不变和插入排序的正确性\"> 循环不变和插入排序的正确性</h3>\n<p><code>A[i..j - 1]</code> 的以下性质是<strong>循环不变</strong>（loop invariant）的：在算法中 <code>for</code> 循环每次迭代的开始，<code>A[1..j - 1]</code> 中包含原数组中 <code>A[1..j - 1]</code> 中的所有元素，并且是有序的。</p>\n<p>循环不变性可以用于证明为什么插入排序是正确的。类似于数学归纳法，只需要证明以下三点：</p>\n<ul>\n<li><strong>初始</strong>（initialization）：在第一次迭代开始之前，循环不变成立。</li>\n<li><strong>维护</strong>（maintenance）：如果本次迭代开始之前循环不变成立，那么下一次迭代开始之前循环不变也成立。</li>\n<li><strong>终止</strong>（termination）：当算法终止时，循环不变性能够用于证明算法正确。</li>\n</ul>\n<p>根据以上方法，可以借助循环不变性证明 <code>INSERTION-SORT</code> 算法是正确的。详细的证明过程略。</p>\n<h2 id=\"_2-2-算法分析\"> 2.2 算法分析</h2>\n<p>算法<strong>分析</strong>（analyze）用于预测算法需要的资源。</p>\n<h3 id=\"插入排序的分析\"> 插入排序的分析</h3>\n<p><strong>输入规模</strong>（input size）的具体表示取决于要研究的问题。在排序问题中，输入规模一般指的是需要排序的元素数量。算法的<strong>运行时间</strong>（running time）指的是在特定输入上需要执行多少步骤才能得到结果。</p>\n<p>对于插入排序来说：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">行号</th>\n<th style=\"text-align:left\"><code>INSERTION-SORT(A)</code></th>\n<th style=\"text-align:left\">运行时间</th>\n<th style=\"text-align:left\">运行次数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">1</td>\n<td style=\"text-align:left\"><code>for j = 2 to A.length</code></td>\n<td style=\"text-align:left\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></td>\n<td style=\"text-align:left\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">2</td>\n<td style=\"text-align:left\"><code>key = A[j]</code></td>\n<td style=\"text-align:left\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></td>\n<td style=\"text-align:left\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">3</td>\n<td style=\"text-align:left\"><code>i = j - 1</code></td>\n<td style=\"text-align:left\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></td>\n<td style=\"text-align:left\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4</td>\n<td style=\"text-align:left\"><code>while i &gt; 0 and A[i] &gt; key</code></td>\n<td style=\"text-align:left\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></td>\n<td style=\"text-align:left\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.24011em;vertical-align:-0.43581800000000004em;\"></span><span><span style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span><span><span><span style=\"height:0.804292em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>2</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.43581800000000004em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>t</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">5</td>\n<td style=\"text-align:left\"><code>A[i + 1] = A[i]</code></td>\n<td style=\"text-align:left\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>5</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></td>\n<td style=\"text-align:left\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.24011em;vertical-align:-0.43581800000000004em;\"></span><span><span style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span><span><span><span style=\"height:0.804292em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>2</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.43581800000000004em;\"><span></span></span></span></span></span></span><span>(</span><span><span>t</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span></span></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">6</td>\n<td style=\"text-align:left\"><code>i = i = 1</code></td>\n<td style=\"text-align:left\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>6</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></td>\n<td style=\"text-align:left\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.24011em;vertical-align:-0.43581800000000004em;\"></span><span><span style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span><span><span><span style=\"height:0.804292em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>2</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.43581800000000004em;\"><span></span></span></span></span></span></span><span>(</span><span><span>t</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span></span></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">7</td>\n<td style=\"text-align:left\"><code>A[i + 1] = key</code></td>\n<td style=\"text-align:left\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>7</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></td>\n<td style=\"text-align:left\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span></td>\n</tr>\n</tbody>\n</table>\n<p>其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.9011879999999999em;vertical-align:-0.286108em;\"></span><span><span>t</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 是对应 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.05724em;\">j</span></span></span></span> 下这一步的运行次数。最终可以得到总的运行时间：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:6.730348000000001em;vertical-align:-3.1151740000000006em;\"></span><span><span><span><span><span><span style=\"height:3.6151740000000006em;\"><span style=\"top:-5.6151740000000006em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.6513970000000007em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:3.1151740000000006em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:3.6151740000000006em;\"><span style=\"top:-5.6151740000000006em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>2</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>t</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>5</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>2</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span>(</span><span><span>t</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>6</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>2</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span>(</span><span><span>t</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>7</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:3.1151740000000006em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>即使是输入规模相同的实例，运行时间也会有很大差别。对于插入排序来说，最好的情况就是输入已经排好序。当代码运行到第 4 行时，循环条件永远是不满足的，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.9011879999999999em;vertical-align:-0.286108em;\"></span><span><span>t</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>。总运行时间为：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:3.0000000000000004em;vertical-align:-1.2500000000000002em;\"></span><span><span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>7</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>7</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>7</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>运行时间可以被整理成 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>an</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>b</span></span></span></span> 的形式，其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>a</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>b</span></span></span></span> 是只与 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 相关的常数。此时 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span></span></span></span> 称作 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 的<strong>线性函数</strong>（linear function）。</p>\n<p>最坏的情况发生在输入恰好是倒序时，第 4 行的循环要运行到 <code>i</code> 等于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span> 才停止，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.9011879999999999em;vertical-align:-0.286108em;\"></span><span><span>t</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.05724em;\">j</span></span></span></span>。总运行时间为：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:15.149908000000003em;vertical-align:-7.324954000000002em;\"></span><span><span><span><span><span><span style=\"height:7.824954000000001em;\"><span style=\"top:-9.824954000000002em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-6.45978em;\"><span style=\"height:3.6513970000000007em;\"></span><span></span></span><span style=\"top:-3.3190030000000004em;\"><span style=\"height:3.6513970000000007em;\"></span><span></span></span><span style=\"top:-0.906003em;\"><span style=\"height:3.6513970000000007em;\"></span><span></span></span><span style=\"top:1.187557em;\"><span style=\"height:3.6513970000000007em;\"></span><span></span></span><span style=\"top:3.013557000000001em;\"><span style=\"height:3.6513970000000007em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:7.324954000000002em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:7.824954000000001em;\"><span style=\"top:-9.824954000000002em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>2</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-6.45978em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>5</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>2</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.05724em;\">j</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>6</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>2</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.05724em;\">j</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>7</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span><span style=\"top:-3.3190030000000004em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span><span style=\"top:-0.906003em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>5</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>6</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>7</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span><span style=\"top:1.187557em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span><span></span><span><span><span><span style=\"height:1.1075599999999999em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.1075599999999999em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>5</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.1075599999999999em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>6</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>)</span><span><span>n</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.1075599999999999em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.1075599999999999em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>5</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.1075599999999999em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>6</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>7</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span><span>n</span></span></span><span style=\"top:3.013557000000001em;\"><span style=\"height:3.6513970000000007em;\"></span><span><span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>7</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:7.324954000000002em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>运行时间可以被整理成 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.897438em;vertical-align:-0.08333em;\"></span><span>a</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span>bn</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span></span></span></span> 的形式，其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>a</span></span></span></span>、<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>b</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span></span></span></span> 是只与 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 相关的常数且 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>a</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>。此时 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span></span></span></span> 称作 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 的<strong>二次函数</strong>（quadratic function）。</p>\n<h3 id=\"最坏情况分析和平均情况分析\"> 最坏情况分析和平均情况分析</h3>\n<p>通常来说，<strong>最坏情况运行时间</strong>（worst-case running time）更重要，它是输入规模为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 时的最长运行时间。最坏情况运行时间的重要性在于以下三点：</p>\n<ul>\n<li>最坏情况运行时间是算法运行时间的上限。</li>\n<li>对于某些算法来说，最坏情况经常发生。</li>\n<li>平均情况运行时间通常与最坏情况运行时间大致相等。</li>\n</ul>\n<h3 id=\"增长率\"> 增长率</h3>\n<p><strong>增长率</strong>（rate of growth 或 order of growth）可以用来简化上节中得到的结果。在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.897438em;vertical-align:-0.08333em;\"></span><span>a</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span>bn</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span></span></span></span> 中，由于高阶的项增长更快，所以其他项通常被忽略。同时，常数也往往全被省略。因此，插入排序的最坏情况运行时间可以写作 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span>。<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>Θ</span></span></span></span> 标记将在后续章节详细介绍。</p>\n<p>通常具有更低最坏情况运行时间增长率的算法是更优的选择。</p>\n<h2 id=\"_2-3-设计算法\"> 2.3 设计算法</h2>\n<p>插入排序中使用了<strong>增量</strong>（incremental）法：保持 <code>A[1..j - 1]</code> 有序，然后把 <code>A[j]</code> 插入到适当位置，使 <code>A[1..j]</code> 依然有序。</p>\n<h3 id=\"分治法\"> 分治法</h3>\n<p>许多算法使用了<strong>递归</strong>（recursive）结构：为了解决给定问题，算法将会调用自身，用于解决与当前问题紧密相关的子问题。这些算法通常使用了<strong>分治</strong>（divide-and-conquer）法：把问题拆分成数个相同类型但规模更小的子问题，递归地解决这些子问题，然后将得到的结果组合起来，构成原问题的解。</p>\n<p>分治法的每层递归都由以下三步构成：</p>\n<ol>\n<li><strong>拆分</strong>（divide）：把问题拆分成数个相同类型但规模更小的子问题。</li>\n<li><strong>处理</strong>（conquer）：递归地解决这些子问题。如果子问题的规模足够小，那么就可以直接解决。</li>\n<li><strong>组合</strong>（combine）：将子问题的解组合起来，构成原问题的解。</li>\n</ol>\n<p>以归并排序算法为例：</p>\n<ol>\n<li>拆分：把需要排序的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个元素的序列拆分成两个含有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/2</span></span></span></span> 个元素的子序列。</li>\n<li>处理：使用归并排序将两个子序列排序。</li>\n<li>组合：将两个有序子序列合并到一起，得到原问题的解。</li>\n</ol>\n<p>归并算法的关键步骤在于合并两个有序序列，不妨设计一个辅助函数 <code>MERGE(A, p, q, r)</code> 来完成这个步骤。其中 <code>A</code> 是数组，<code>p</code>、<code>q</code>、<code>r</code> 是数组的下标。<code>A[p..q]</code> 和 <code>A[q + 1..r]</code> 是两个有序子数组。</p>\n<p><code>MERGE</code> 函数花费 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span> 时间，其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span style=\"margin-right:0.02778em;\">r</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.7777700000000001em;vertical-align:-0.19444em;\"></span><span>p</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>。还是用纸牌举例，设想有两堆排好序的牌。每次迭代过程中，查看两个牌堆顶的牌，把这二者之中最小的放在手牌最后的位置。</p>\n<div><pre><code>MERGE(A, p, q, r)\n  // 计算子数组元素个数，并创建新数组\n  n1 = q - p + 1\n  n2 = r - q\n  创建新数组 L[1..n1 + 1] 和 R[1..n2 + 1]\n\n  // 将数据复制到新数组\n  for i = 1 to n1\n    L[i] = A[p + i - 1]\n  for j = 1 to n2\n    R[j] = A[q + j]\n\n  // 在新数组最后的位置放一个无限大作为结束标志\n  L[n1 + 1] = infinity\n  R[n2 + 1] = infinity\n\n  // 合并两个子数组\n  i = 1\n  j = 1\n  for k = p to r\n    // 将两个元素中较小的那个加入\n    if L[i] &lt;= R[j]\n      A[k] = L[i]\n      i = i + 1\n    else\n      A[k] = R[j]\n      j = j + 1\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br></div></div><p>最后，归并排序算法的伪代码如下：</p>\n<div><pre><code>MERGE-SORT(A, p, r)\n  if p &lt; r\n    // 拆分\n    q = (p + r) / 2\n    // 处理\n    MERGE-SORT(A, p, q)\n    MERGE-SORT(A, q + 1, r)\n    // 组合\n    MERGE(A, p, q, r)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></div></div><p>归并排序的循环不变性和正确性证明略。</p>\n<h3 id=\"分治算法的分析\"> 分治算法的分析</h3>\n<p>当算法递归地调用自己时，通常使用递推式来描述运行时间。假设输入实例的规模是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>。当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 足够小（比如 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span></span></span></span>）时可以直接解决该问题，此时花费的时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>1</span><span>)</span></span></span></span>（即常数时间）。当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span></span></span></span> 时，算法把该问题拆分成 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>a</span></span></span></span> 个规模变为原来 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>b</span></span></span></span> 的子问题，一共需要花费 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>a</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>/</span><span>b</span><span>)</span></span></span></span> 的时间来解决这些子问题。另外，还需要 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">D</span><span>(</span><span>n</span><span>)</span></span></span></span> 的时间来拆分问题，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.07153em;\">C</span><span>(</span><span>n</span><span>)</span></span></span></span> 的时间来合并子问题的解。最终得到递推式：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span><span style=\"top:0em;\"><span>{</span></span><span><span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span>Θ</span><span>(</span><span>1</span><span>)</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span>a</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>/</span><span>b</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.02778em;\">D</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.07153em;\">C</span><span>(</span><span>n</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>c</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span><span>其他情况</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>在第 4 章中将会展示如何处理这些递推式。</p>\n<h3 id=\"归并排序的分析\"> 归并排序的分析</h3>\n<p>当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 时，有：</p>\n<ul>\n<li>拆分：只计算数组中间的下标，因此只花费 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">D</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>1</span><span>)</span></span></span></span>。</li>\n<li>处理：递归地解决两个子问题，每个子问题的规模都是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/2</span></span></span></span>，因此一共花费 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>2</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>/2</span><span>)</span></span></span></span>。</li>\n<li>合并：上文中已经提到合并花费的时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span>。</li>\n</ul>\n<p>最终得到：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span><span style=\"top:0em;\"><span>{</span></span><span><span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span>Θ</span><span>(</span><span>1</span><span>)</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span>2</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>/2</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>根据主定理（见第 4 章）可得 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>。不过还可以借助<strong>递归树</strong>（recursion tree）来解决这个问题：</p>\n<div><pre><code>/                cn ---------------&gt; cn\n|              /    \\\n|            cn/2   cn/2 ----------&gt; cn\n|          /   \\    /   \\\nlg n   cn/4  cn/4  cn/4  cn/4 -----&gt; cn\n|       / \\   / \\   / \\   / \\\n|      ........................     ...\n|      |  |  |  |  |  ... |  |\n\\      c  c  c  c  c      c  c ----&gt; cn\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></div></div><p>在递归树的第一层中，即解决原问题的过程中，需要 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span><span>n</span></span></span></span> 步来合并两个子问题的解。在第二层中，也就是解决原问题的两个子问题的过程中，一共需要 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>c</span><span>n</span><span>/2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>c</span><span>n</span><span>/2</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span><span>n</span></span></span></span> 步合并两个子问题的四个子子问题的解。容易发现，当递归树层数增加时每一层用于合并的步骤的总数量是不变的，总是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span><span>n</span></span></span></span>。另一方面，由于每次都将数组分割为两份，而且数组长度小于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span></span></span></span> 时就不再分隔，因此递归树的高度不会超过 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⌈</span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>⌉</span></span></span></span>。所以归并排序花费的总时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>c</span><span>n</span><span>⌈</span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>⌉)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>。</p>\n",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": [
        "算法导论"
      ]
    },
    {
      "title": "算法导论4 分治",
      "url": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/4%20%E5%88%86%E6%B2%BB/",
      "id": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/4%20%E5%88%86%E6%B2%BB/",
      "content_html": "<h1 id=\"算法导论4-分治\"> 算法导论4 分治</h1>\n<p><strong>递推式</strong>（recurrence）是使用更小输入的项来描述当前项的等式或不等式。本章提供了三种求解递推式的方法，分别是<strong>替换法</strong>（substitution method），<strong>递归树法</strong>（recursion-tree method），<strong>主方法</strong>（master method）。</p>\n<h2 id=\"_4-1-最大子数组问题\"> 4.1 最大子数组问题</h2>\n<p>最大子数组问题：给定数组 <code>A[1..n]</code>，求 <code>i</code> 和 <code>j</code> 使得 <code>A[i..j]</code>（至少包含一个元素）之中所有元素之和最大。</p>\n<h3 id=\"分治算法\"> 分治算法</h3>\n<p>考虑使用分治策略求 <code>A[low..high]</code> 的最大子数组。首先使用分治法将数组等分，得到 <code>A[low..mid]</code> 和 <code>A[mid + 1..high]</code>。那么 <code>A[low..high]</code> 上的解能且只能是以下三种的一个：</p>\n<ul>\n<li>完全在 <code>A[low..mid]</code> 中。</li>\n<li>完全在 <code>A[mid + 1..high]</code> 中。</li>\n<li>横跨 <code>A[low..mid]</code> 和 <code>A[mid + 1..high]</code>。</li>\n</ul>\n<p>前两种情况的解可由递归调用得到，因此仅需解决第三种情况。已知该子数组必须包含 <code>A[mid</code> 和 <code>A[mid + 1]</code>，所以可以从 <code>mid</code> 开始，向左找到总和最大的 <code>A[i..mid]</code>，向右找到总和最大的 <code>A[mid + 1..j]</code>，从而得到最终结果 <code>A[i..j]</code>。容易得到这一步的最坏情况运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span>，其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 是 <code>A</code> 的长度。伪代码如下：</p>\n<div><pre><code>FIND-MAX-CROSSING-SUBARRAY(A, low, mid, high)\n  // 向左找到总和最大的 A[i..mid]\n  left-sum = - infinity\n  sum = 0\n  for i = mid downto low\n    sum = sum + A[i]\n    if sum &gt; left-sum\n      left-sum = sum\n      max-left = i\n\n  // 向右找到总和最大的 A[mid + 1..j]\n  right-sum = - infinity\n  sum = 0\n  for j = mid + 1 to high\n    sum = sum + A[j]\n    if sum &gt; right-sum\n      right-sum = sum\n      max-right = j\n\n  return (max-left, max-right, left-sum + right-sum)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br></div></div><p>整个算法的伪代码如下：</p>\n<div><pre><code>FIND-MAXIMUM-SUBARRAY(A, low, high)\n  if high == low\n    // 基本情况\n    return (low, high, A[low])\n  else\n    // 递归情况\n    mid = (low + high) / 2\n    (left-low, left-high, left-sum) = FIND-MAXIMUM-SUBARRAY(A, low, mid)\n    (right-low, right-high, right-sum) = FIND-MAXIMUM-SUBARRAY(A, mid + 1, high)\n    (cross-low, cross-high, cross-sum) = FIND-MAX-CROSSING-SUBARRAY(A, low, mid, high)\n\n    // 选出最大的\n    if left-sum &gt;= right-sum and left-sum &gt;= cross-sum\n      return (left-low, left-high, left-sum)\n    else if right-sum &gt;= left-sum and right-sum &gt;= cross-sum\n      return (right-low, right-high, right-sum)\n    else\n      return (cross-low, cross-high, cross-sum)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br></div></div><h3 id=\"算法分析\"> 算法分析</h3>\n<p>根据分治算法的运行时间公式，容易得到：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span><span style=\"top:0em;\"><span>{</span></span><span><span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span>Θ</span><span>(</span><span>1</span><span>)</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span>2</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>/2</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>该算法的递归树与归并算法一致，因此可知 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>。</p>\n<h2 id=\"_4-2-strassen-矩阵乘法\"> 4.2 Strassen 矩阵乘法</h2>\n<p>假设有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>×</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 矩阵 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>A</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span>(</span><span><span>a</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>)</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.05017em;\">B</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span>(</span><span><span>b</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>)</span></span></span></span>，那么 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.07153em;\">C</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>A</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.05017em;\">B</span></span></span></span> 的定义是：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.9535100000000005em;vertical-align:-1.302113em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.03148em;\">ik</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span>b</span><span><span><span><span style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">kj</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>根据以上定义，可以得到以下平凡算法：</p>\n<div><pre><code>SQUARE-MATRIX-MULTIPLY(A, B)\n  n = A.rows\n  创建新矩阵 C\n  for i = 1 to n\n    for j = 1 to n\n      c_ij = 0\n      for k = 1 to n\n        c_ij = c_ij + a_ik * b_kj\n  return C\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></div></div><p>以上算法的运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span></span></span></span></span><span>)</span></span></span></span>。虽然根据矩阵乘法定义，似乎不存在更高效率的算法，但是后续章节将介绍一个 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.0991079999999998em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8491079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span>l</span><span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>7</span></span></span></span></span></span></span></span></span><span>)</span></span></span></span> 的算法（<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>7</span></span></span></span> 约等于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2.81</span></span></span></span>）。在那之前，先看看使用分治思想的算法。</p>\n<h3 id=\"使用分治思想的算法\"> 使用分治思想的算法</h3>\n<p>为了专心讨论分治，假设 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span></span></span></span> 的幂，这样就可以把矩阵拆分为四个 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>×</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/2</span></span></span></span> 的矩阵。</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:2.40003em;vertical-align:-0.9500149999999999em;\"></span><span><span><span><span><span><span style=\"height:1.450015em;\"><span style=\"top:-3.450015em;\"><span style=\"height:3.45em;\"></span><span><span>A</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"top:0em;\"><span>(</span></span><span><span><span><span><span><span style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span style=\"height:3em;\"></span><span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.4099999999999997em;\"><span style=\"height:3em;\"></span><span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>21</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span><span style=\"width:0.5em;\"></span><span style=\"width:0.5em;\"></span><span><span><span><span style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span style=\"height:3em;\"></span><span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>12</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.4099999999999997em;\"><span style=\"height:3em;\"></span><span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span></span></span><span style=\"top:0em;\"><span>)</span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.9500149999999999em;\"><span></span></span></span></span></span><span style=\"width:0.5em;\"></span><span style=\"width:0.5em;\"></span><span><span><span><span style=\"height:1.450015em;\"><span style=\"top:-3.450015em;\"><span style=\"height:3.45em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"top:0em;\"><span>(</span></span><span><span><span><span><span><span style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.4099999999999997em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>21</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span><span style=\"width:0.5em;\"></span><span style=\"width:0.5em;\"></span><span><span><span><span style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>12</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.4099999999999997em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span></span></span><span style=\"top:0em;\"><span>)</span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.9500149999999999em;\"><span></span></span></span></span></span><span style=\"width:0.5em;\"></span><span style=\"width:0.5em;\"></span><span><span><span><span style=\"height:1.450015em;\"><span style=\"top:-3.450015em;\"><span style=\"height:3.45em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"top:0em;\"><span>(</span></span><span><span><span><span><span><span style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.4099999999999997em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>21</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span><span style=\"width:0.5em;\"></span><span style=\"width:0.5em;\"></span><span><span><span><span style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>12</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.4099999999999997em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span></span></span><span style=\"top:0em;\"><span>)</span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.9500149999999999em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>现在乘法 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.07153em;\">C</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>A</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.05017em;\">B</span></span></span></span> 可以写成：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:2.40003em;vertical-align:-0.95003em;\"></span><span><span style=\"top:0em;\"><span>(</span></span><span><span><span><span><span><span style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.4099999999999997em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>21</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span><span style=\"width:0.5em;\"></span><span style=\"width:0.5em;\"></span><span><span><span><span style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>12</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.4099999999999997em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span></span></span><span style=\"top:0em;\"><span>)</span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.40003em;vertical-align:-0.95003em;\"></span><span><span style=\"top:0em;\"><span>(</span></span><span><span><span><span><span><span style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span style=\"height:3em;\"></span><span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.4099999999999997em;\"><span style=\"height:3em;\"></span><span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>21</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span><span style=\"width:0.5em;\"></span><span style=\"width:0.5em;\"></span><span><span><span><span style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span style=\"height:3em;\"></span><span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>12</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.4099999999999997em;\"><span style=\"height:3em;\"></span><span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span></span></span><span style=\"top:0em;\"><span>)</span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:2.40003em;vertical-align:-0.95003em;\"></span><span><span style=\"top:0em;\"><span>(</span></span><span><span><span><span><span><span style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.4099999999999997em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>21</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span><span style=\"width:0.5em;\"></span><span style=\"width:0.5em;\"></span><span><span><span><span style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>12</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.4099999999999997em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.9500000000000004em;\"><span></span></span></span></span></span></span></span><span style=\"top:0em;\"><span>)</span></span></span></span></span></span></span></p>\n<p>如果不写成矩阵形式，那么就是：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:6em;vertical-align:-2.7500000000000004em;\"></span><span><span><span><span><span><span style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>12</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.4099999999999993em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>21</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-0.9099999999999997em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:2.7500000000000004em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>12</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>21</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>12</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>12</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.4099999999999993em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>21</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>21</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-0.9099999999999997em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>21</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>12</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:2.7500000000000004em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>具体算法的伪代码略去，最后可以得到运行时间为：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span><span style=\"top:0em;\"><span>{</span></span><span><span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span>Θ</span><span>(</span><span>1</span><span>)</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span>8</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>/2</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>根据后续介绍的主定理，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span></span></span></span></span><span>)</span></span></span></span>，并没有更快。</p>\n<h3 id=\"strassen-算法\"> Strassen 算法</h3>\n<p>Strassen 算法的关键在于让递归树稀疏一些。在上一节介绍的平凡分治算法中，递归树中的每个非叶节点有八个子节点；而在 Strassen 算法中仅有七个，这是通过增加一些额外的常数时间实现的。</p>\n<p>Strassen 算法的详细步骤非常晦涩，其中隐含的数学关系太隐蔽。以下是 Strassen 算法的大致流程：</p>\n<ol>\n<li>将矩阵 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>A</span></span></span></span>、<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.05017em;\">B</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.07153em;\">C</span></span></span></span> 分割成 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>×</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/2</span></span></span></span> 的子矩阵。这一步花费的时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>1</span><span>)</span></span></span></span>。</li>\n<li>创建 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>10</span></span></span></span> 个大小为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>×</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/2</span></span></span></span> 的矩阵 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>10</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，每个矩阵都是上一步中得到的子矩阵的和或差。这一步花费的时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span>。</li>\n<li>使用子矩阵和上一步得到的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>10</span></span></span></span> 个矩阵，递归地计算七个乘法 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>7</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>。其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 的大小是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>×</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/2</span></span></span></span>。</li>\n<li>通过 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 之间的加减得到 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>、<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>12</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>、<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>21</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>、<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，最终组合成 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.07153em;\">C</span></span></span></span>。这一步花费的时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span>。</li>\n</ol>\n<p>先不谈算法的细节，现在可以得到运行时间的递推式：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span><span style=\"top:0em;\"><span>{</span></span><span><span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span>Θ</span><span>(</span><span>1</span><span>)</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span>7</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>/2</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>根据后续介绍的主定理，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.0991079999999998em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8491079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span>l</span><span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>7</span></span></span></span></span></span></span></span></span><span>)</span></span></span></span>。</p>\n<p>接下来介绍算法的细节，首先是第 2 步中的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>10</span></span></span></span> 个矩阵：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:4.500000000000002em;vertical-align:-2.000000000000001em;\"></span><span><span><span><span><span><span style=\"height:2.5000000000000004em;\"><span style=\"top:-4.66em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.16em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>5</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.6599999999999993em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>9</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:2.000000000000001em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:2.5000000000000004em;\"><span style=\"top:-4.66em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>12</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.16em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.6599999999999993em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>21</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:2.000000000000001em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:2.5000000000000004em;\"><span style=\"top:-4.66em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.16em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>6</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.6599999999999993em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>10</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:2.000000000000001em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:2.5000000000000004em;\"><span style=\"top:-4.66em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>12</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.16em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.6599999999999993em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>12</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:2.000000000000001em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:2.5000000000000004em;\"><span style=\"top:-4.66em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.16em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>7</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.5em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:2.5000000000000004em;\"><span style=\"top:-4.66em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>21</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.16em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>12</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.5em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:2.5000000000000004em;\"><span style=\"top:-4.66em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.16em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>8</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.5em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:2.5000000000000004em;\"><span style=\"top:-4.66em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>21</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.16em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>21</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.5em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>然后是七个子问题：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:3.0000000000000004em;vertical-align:-1.2500000000000002em;\"></span><span><span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>5</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>5</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>6</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>6</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>7</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>8</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>7</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05017em;\">B</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>9</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>10</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>最后合并：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:3.0000000000000004em;vertical-align:-1.2500000000000002em;\"></span><span><span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>11</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>21</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>5</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>6</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>12</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>5</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.13889em;\">P</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>7</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<h2 id=\"_4-3-替换法\"> 4.3 替换法</h2>\n<p>替换法通过两个步骤求解递推式：</p>\n<ol>\n<li>猜测解的形式。</li>\n<li>通过数学归纳法求出常量的值，证明此解确实是该递推式的解。</li>\n</ol>\n<p>可以通过替换法求得渐近上界和渐近下界。以求解渐近上界为例，原递推式：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>2</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>/2</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span></span></p>\n<p>这个递推式已经见到很多次了，可以猜测 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>。此时需要证明，当选择一个合适的正的常数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span></span></span></span> 之后，可以使 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>c</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span> 成立。假设它在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>m</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 时总成立，那么令 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/2</span></span></span></span>，有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>/2</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>c</span><span>(</span><span>n</span><span>/2</span><span>)</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span>(</span><span>n</span><span>/2</span><span>)</span></span></span></span>。所以：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:4.500000000000002em;vertical-align:-2.000000000000001em;\"></span><span><span><span><span><span><span style=\"height:2.5000000000000004em;\"><span style=\"top:-4.66em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-3.16em;\"><span style=\"height:3em;\"></span><span></span></span><span style=\"top:-1.6599999999999993em;\"><span style=\"height:3em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:2.000000000000001em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:2.5000000000000004em;\"><span style=\"top:-4.66em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>2</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>/2</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>2</span><span>[</span><span>c</span><span>(</span><span>n</span><span>/2</span><span>)</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span>(</span><span>n</span><span>/2</span><span>)]</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>n</span></span></span><span style=\"top:-3.16em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>c</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span>(</span><span>n</span><span>/2</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>c</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>c</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>n</span></span></span><span style=\"top:-1.6599999999999993em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>c</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>c</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>c</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:2.000000000000001em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>c</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 时最后一行成立。总结一下，上述过程证明了 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>c</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 并且 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>m</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>c</span><span>m</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>m</span></span></span></span> 对于所有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>m</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 都成立时，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>c</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span> 也成立。只差证明一个边界情况，数学归纳法就完成了。</p>\n<p>可惜的是，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>1</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>，而 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>c</span><span>1</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>，所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>1</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>c</span><span>1</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span></span></span></span> 不成立。但是没关系，回忆一下渐近的定义，只要找到一个 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 使 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 时成立即可。所以让 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>2</span><span>)</span></span></span></span> 作为边界情况就可以了，只要选择 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>c</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>2</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.78111em;vertical-align:-0.13667em;\"></span><span>4</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>c</span><span>2</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>2</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span><span>c</span></span></span></span> 就能够满足。综上，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span> 得证。</p>\n<p>没有轻松猜出解形式的方法，能够依靠的只有经验和运气。有时你猜对了解的形式，但是找不到合适的替换方法来使用数学归纳法。替换法很直接，但是由于这些原因不好用。</p>\n<h2 id=\"_4-4-递归树法\"> 4.4 递归树法</h2>\n<p>在递归树中，每个节点代表了递归调用中一个子问题花费的时间。先算出每一层的总时间花费，然后算出整棵树的总时间花费。</p>\n<p>递归树法比较简单，而且适合多种场景。有时，递归树法可以为替换法提供一些思路。在分析归并排序时使用了递归树法，这里不再多做介绍了。</p>\n<h2 id=\"_4-5-主方法\"> 4.5 主方法</h2>\n<h3 id=\"主定理\"> 主定理</h3>\n<p>令 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>a</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span>b</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> 是函数，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span></span></span></span> 是定义在非负整数上的递推式：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>a</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>/</span><span>b</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span></span></p>\n<ul>\n<li>如果存在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>ϵ</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span> 使 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.138em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.23015999999999992em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span>(</span><span>a</span><span>−</span><span>ϵ</span><span>)</span></span></span></span></span></span></span></span></span><span>)</span></span></span></span>，那么 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.099108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.23015999999999992em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>a</span></span></span></span></span></span></span></span></span><span>)</span></span></span></span>。</li>\n<li>如果 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.099108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.23015999999999992em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>a</span></span></span></span></span></span></span></span></span><span>)</span></span></span></span>，那么 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.099108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.23015999999999992em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>a</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>。</li>\n<li>如果存在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>ϵ</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span> 使 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.138em;vertical-align:-0.25em;\"></span><span>Ω</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8879999999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.23015999999999992em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span>(</span><span>a</span><span>+</span><span>ϵ</span><span>)</span></span></span></span></span></span></span></span></span><span>)</span></span></span></span>，并且存在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>c</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 使任意 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 都满足 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>a</span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>/</span><span>b</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>c</span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span>，那么 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>))</span></span></span></span>。</li>\n</ul>\n<p>不那么数学地讲，以上三条仿佛在比较 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.849108em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.23015999999999992em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>a</span></span></span></span></span></span></span></span></span></span></span></span> 的增长率。如果 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> 较小，那么属于情况 1，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.099108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.23015999999999992em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>a</span></span></span></span></span></span></span></span></span><span>)</span></span></span></span>。如果 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> 较大，那么属于情况 3，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>))</span></span></span></span>。最后，如果二者的增长率相同，那么 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.099108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.23015999999999992em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>a</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>。</p>\n<p>如果更数学一点，以情况 1 为例，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> 不是简单地小于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.849108em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.23015999999999992em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>a</span></span></span></span></span></span></span></span></span></span></span></span>，而是多项式小于。这意味着存在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>ϵ</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>，使得 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> 渐近小于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.849108em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.23015999999999992em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>a</span></span></span></span></span></span></span></span></span></span></span></span> 的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.664392em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>ϵ</span></span></span></span></span></span></span></span></span></span></span> 分之一。另外在第 3 种情况中，不但 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> 要多项式大于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.849108em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.23015999999999992em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>a</span></span></span></span></span></span></span></span></span></span></span></span>，还要满足一个额外的条件。</p>\n<p>不幸的是主定理不能覆盖所有情况，有些递推式无法匹配到三条规则的任何一条。</p>\n<h3 id=\"使用主定理\"> 使用主定理</h3>\n<p>例一：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>9</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>/3</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span></span></p>\n<p><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>a</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>9</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>b</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>3</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>。<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.849108em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.23015999999999992em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>a</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.849108em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.19444571428571428em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>9</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span>。令 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>ϵ</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.099108em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.19444571428571428em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>3</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>9</span><span>−</span><span>ϵ</span></span></span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span>。符合情况 1，所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span>。</p>\n<p>例二：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>2</span><span>n</span><span>/3</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span></span></p>\n<p><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>a</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>b</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>3/2</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>。<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.849108em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.23015999999999992em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>a</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.9049659999999999em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.9049659999999999em;\"><span style=\"top:-3.1188580000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.26984571428571424em;\"><span style=\"top:-2.269845714285714em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5357142857142856em;\"></span><span><span><span>3/2</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.44444000000000006em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>1</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>。<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.099108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.23015999999999992em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>a</span></span></span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>1</span><span>)</span></span></span></span>。符合情况 2，所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>。</p>\n<p>例三：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>3</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>/4</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span></span></p>\n<p><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>a</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>3</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>b</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>4/2</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span>。<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.849108em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.23015999999999992em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>a</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.849108em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.19444571428571428em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>4</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>3</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>0.793</span></span></span></span></span></span></span></span></span><span>)</span></span></span></span>。当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>ϵ</span></span></span></span> 取大约 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0.2</span></span></span></span> 时，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.099108em;vertical-align:-0.25em;\"></span><span>Ω</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.23015999999999992em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>a</span><span>−</span><span>ϵ</span></span></span></span></span></span></span></span></span><span>)</span></span></span></span>。还要检查附加条件，当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>3/4</span></span></span></span> 时，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>a</span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>/</span><span>b</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>3</span><span>(</span><span>n</span><span>/4</span><span>)</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span>(</span><span>n</span><span>/4</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>3/4</span><span>)</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>c</span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> 成立。符合情况 3，所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>。</p>\n<p>例四：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>2</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>/2</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span></span></p>\n<p><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>a</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>b</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span>。<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.849108em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.23015999999999992em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>a</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.849108em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span><span>l</span><span>o</span><span style=\"margin-right:0.01389em;\">g</span></span><span><span><span><span style=\"height:0.19444571428571428em;\"><span style=\"top:-2.2341314285714287em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.26586857142857145em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>2</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>。问题来了，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>n</span><span>)</span></span></span></span> 虽然渐近小于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>，但是它并不多项式小于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>。也就是说，符合情况 3 的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>ϵ</span></span></span></span> 不存在。综上，这个递推式掉进了情况 2 和情况 3 之间的间隙中，无法使用主定理。</p>\n",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": [
        "算法导论"
      ]
    },
    {
      "title": "算法导论6 堆排序",
      "url": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/6%20%E5%A0%86%E6%8E%92%E5%BA%8F/",
      "id": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/6%20%E5%A0%86%E6%8E%92%E5%BA%8F/",
      "content_html": "<h1 id=\"算法导论6-堆排序\"> 算法导论6 堆排序</h1>\n<h2 id=\"_6-1-堆\"> 6.1 堆</h2>\n<p><strong>二叉堆</strong>（binary heap）是一种可以看成完全二叉树的数组，一般简称为堆。满二叉树是满足以下两个条件的二叉树：</p>\n<ul>\n<li>所有叶节点均位于同一高度。</li>\n<li>所有非叶节点都有两个子节点。</li>\n</ul>\n<p>把满二叉树中的节点按层序遍历的顺序编号，那么对于任意整数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83111em;vertical-align:-0.13667em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>，满二叉树的前 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 个节点构成一颗完全二叉树。下面展示了一个最大堆，上半部分是实际的数组结构，下半部分是堆对应的树。</p>\n<div><pre><code>+-----+--+--+--+--+--+--+--+--+--+--+\n|index| 1| 2| 3| 4| 5| 6| 7| 8| 9|10|\n+-----+--+--+--+--+--+--+--+--+--+--+\n|value|16|14|10| 8| 7| 9| 3| 2| 4| 1|\n+-----+--+--+--+--+--+--+--+--+--+--+\n            1[16]\n            /    \\\n       2[14]     3[10]\n        /  \\      /  \\\n    4[8]  5[7] 6[9] 7[3]\n   /  \\    /\n8[2] 9[4] 10[1]\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br></div></div><p>观察上例，容易得到父节点和左右子节点索引之间的关系，伪代码：</p>\n<div><pre><code>PARENT(i)\n  return i / 2\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><div><pre><code>LEFT(i)\n  return 2 * i\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><div><pre><code>RIGHT(i)\n  return 2 * i + 1\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>二叉堆分为两种，<strong>最大堆</strong>（max-heap）和<strong>最小堆</strong>（min-heap）。两种类型中，堆的节点中的数值满足<strong>堆性质</strong>（heap property）。以最大堆为例，最大堆性质是指对于任意节点 <code>i</code>（除了根节点）：</p>\n<div><pre><code>A[PARENT(i)] &gt;= A[i]\n</code></pre>\n<div><span>1</span><br></div></div><p>换句话说，节点中的值不会超过其父节点。所以最大堆中的最大元素一定位于根节点。最小堆的性质刚好相反，对于任意节点 <code>i</code>（除了根节点）：</p>\n<div><pre><code>A[PARENT(i)] &lt;= A[i]\n</code></pre>\n<div><span>1</span><br></div></div><p>节点的<strong>高度</strong>（height）是从该节点出发，到达叶节点的最长简单路径中边的数量。举个例子，上文中堆的 <code>5</code> 号节点的高度是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>。堆的高度等于根节点的高度。由于堆符合完全二叉树相关性质，所以含有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个节点的堆的高度为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span></p>\n<h2 id=\"_6-2-维护堆性质\"> 6.2 维护堆性质</h2>\n<p>可以设计一个单独的函数 <code>MAX-HEAPIFY(A, i)</code> 来维护堆性质。<code>MAX-HEAPIFY</code> 被调用时，以 <code>LEFT(i)</code>、<code>RIGHT(i)</code> 为根节点的子树必须已经是最大堆，节点 <code>i</code> 可能小于它的子节点。<code>MAX-HEAPIFY</code> 会把 <code>i</code> 向下移动，从而维护堆性质。</p>\n<div><pre><code>MAX-HEAPIFY(A, i)\n  l = LEFT(i)\n  r = RIGHT(i)\n\n  // 如果存在左子节点，那么选出本节点与左子节点中较大的\n  if l &lt;= A.heap-size and A[l] &gt; A[i]\n    largest = l\n  else\n    largest = i\n  \n  // 如果存在右子节点，那么选出 largest 与右子节点中较大的\n  if r &lt;= A.heap-size and A[r] &gt; A[largest]\n    largest = r\n  \n  // 如果本节点不是最大的，那么将其和较大的子节点交换位置\n  if largest != i\n    交换 A[i] 和 A[largest]\n    // 继续检查\n    MAX-HEAPIFY(A, largest)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br></div></div><p>在最差情况下，左子节点中的值最大并且树的最底层正好放满了一半。这样就会以左子节点为新的根节点继续调用 <code>MAX-HEAPIFY</code> ，并且此时子问题的规模最大。假设树的高度是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span>，那么以左子节点为根节点的树有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.2887179999999998em;vertical-align:-0.29971000000000003em;\"></span><span><span style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span><span><span><span style=\"height:0.9890079999999999em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>−</span><span>2</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.824664em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span></span></span></span></span></span></span></span> 个节点，以右子节点为根节点的树有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.2887179999999998em;vertical-align:-0.29971000000000003em;\"></span><span><span style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span><span><span><span style=\"height:0.9890079999999999em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>−</span><span>3</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.824664em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span></span></span></span></span></span></span></span> 个节点，一共是：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:8.386672em;vertical-align:-3.9433360000000004em;\"></span><span><span><span><span><span><span style=\"height:4.443336em;\"><span style=\"top:-6.443336em;\"><span style=\"height:3.836113em;\"></span><span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span><span style=\"height:1.8361130000000003em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>h</span><span>−</span><span>2</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.8746639999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span><span style=\"height:1.8361130000000003em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>h</span><span>−</span><span>3</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.8746639999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.029554em;\"><span style=\"height:3.836113em;\"></span><span></span></span><span style=\"top:-0.5527769999999999em;\"><span style=\"height:3.836113em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:3.9433360000000004em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:4.443336em;\"><span style=\"top:-6.443336em;\"><span style=\"height:3.836113em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>2</span><span>(</span><span><span><span><span style=\"height:1.8361130000000003em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>h</span><span>−</span><span>3</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.8746639999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>−</span><span>2</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span><span style=\"height:1.8361130000000003em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>h</span><span>−</span><span>2</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.8746639999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>−</span><span>2</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.029554em;\"><span style=\"height:3.836113em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.8361130000000003em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>h</span><span>−</span><span>2</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.8746639999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>−</span><span>2</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>−</span><span>2</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-0.5527769999999999em;\"><span style=\"height:3.836113em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>3</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>×</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>−</span><span>2</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:3.9433360000000004em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>以左子节点为根节点的子树中节点数量和原树中节点数量的比值的极限是：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:2.857436em;vertical-align:-1.178718em;\"></span><span><span><span><span style=\"height:0.69444em;\"><span style=\"top:-2.347892em;margin-left:0em;\"><span style=\"height:3em;\"></span><span><span><span>h</span><span>→</span><span>∞</span></span></span></span><span style=\"top:-3em;\"><span style=\"height:3em;\"></span><span><span>lim</span></span></span></span><span>​</span></span><span><span style=\"height:0.7521079999999999em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.678718em;\"><span style=\"top:-2.120992em;\"><span style=\"height:3em;\"></span><span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span><span><span><span style=\"height:0.9890079999999999em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>−</span><span>2</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.750664em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span><span><span><span style=\"height:0.9890079999999999em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>−</span><span>3</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.750664em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6897100000000003em;\"><span style=\"height:3em;\"></span><span><span><span style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span><span><span><span style=\"height:0.9890079999999999em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>−</span><span>2</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.29971000000000003em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.824664em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:1.178718em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.295438em;vertical-align:-0.7693300000000001em;\"></span><span><span></span><span><span><span><span style=\"height:1.5261079999999998em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>3</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>×</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.7751079999999999em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>−</span><span>2</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span><span>2</span><span><span><span><span style=\"height:0.8491079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.00744em;vertical-align:-0.686em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>3</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>递推式：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>2</span><span>n</span><span>/3</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>1</span><span>)</span></span></span></span></span></p>\n<p>根据主定理（情况 2），<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>h</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span></p>\n<h2 id=\"_6-3-构建堆\"> 6.3 构建堆</h2>\n<p>假设堆中一共有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个节点，那么最后一个（按层序遍历）的非叶节点编号是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/2</span></span></span></span>。证明如下：假设 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 有子节点，那么它必有左子节点。那么它左子节点的编号应该是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>2</span><span>(</span><span>n</span><span>/2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.68354em;vertical-align:-0.0391em;\"></span><span>2</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>，与堆中仅有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个节点矛盾，所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 没有子节点。</p>\n<p>从节点 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/2</span></span></span></span> 开始，到节点 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span> 结束，调用 <code>MAX-HEAPIFY</code>，即可完成堆构建。</p>\n<div><pre><code>BUILD-MAX-HEAP(A)\n  A.heap-size = A.length\n  for i = A.length / 2 downto 1\n    MAX-HEAPIFY(A, i)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><p>利用循环不变性可以证明 <code>BUILD-MAX-HEAP</code> 的正确性，详细过程略。</p>\n<p>由于 <code>MAX-HEAPIFY</code> 的运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>，而 <code>BUILD-MAX-HEAP</code> 中调用了它 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span> 次，所以一共是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>。这是一个渐近上界，虽然正确但是不紧。容易注意到 <code>BUILD-MAX-HEAP</code> 中每次调用 <code>MAX-HEAPIFY</code> 时，<code>MAX-HEAPIFY</code> 要面对的输入规模是不同的。</p>\n<p>先回顾几个知识点，然后再讨论 <code>MAX-HEAPIFY</code> 更紧的渐近上界。等比数列求和公式：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:2.9535100000000005em;vertical-align:-1.302113em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>x</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.260438em;vertical-align:-0.7693300000000001em;\"></span><span><span></span><span><span><span><span style=\"height:1.491108em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>x</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span><span>x</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>+</span><span>1</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>→</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>∞</span></span></span></span> 且 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>∣</span><span>x</span><span>∣</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 时，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span><span>x</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>+</span><span>1</span></span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>。这时候上式变为：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:2.9535100000000005em;vertical-align:-1.302113em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>∞</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>x</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.09077em;vertical-align:-0.7693300000000001em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>x</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>对上式两边分别求导：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:8.89779em;vertical-align:-4.198895em;\"></span><span><span><span><span><span><span style=\"height:4.698895em;\"><span style=\"top:-7.0288520000000005em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span>d</span><span>(</span><span style=\"position:relative;top:-0.000004999999999977245em;\">∑</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>x</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span><span>)</span><span>/</span><span>d</span><span>x</span></span></span><span style=\"top:-4.308125em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>∞</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>d</span><span>(</span><span><span>x</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span><span>)</span><span>/</span><span>d</span><span>x</span></span></span><span style=\"top:-1.054615em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>∞</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span><span>x</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>−</span><span>1</span></span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:4.198895em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:4.698895em;\"><span style=\"top:-7.0288520000000005em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>d</span><span>(</span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>x</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span></span></span><span>)</span><span>/</span><span>d</span><span>x</span></span></span><span style=\"top:-4.308125em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>x</span><span><span>)</span><span><span><span><span style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.936em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-1.054615em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>x</span><span><span>)</span><span><span><span><span style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.936em;\"><span></span></span></span></span></span><span></span></span></span></span></span><span>​</span></span><span><span style=\"height:4.198895em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>对最后一行左右同时乘以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span>：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:2.9535100000000005em;vertical-align:-1.302113em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>∞</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span><span>x</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.0435600000000003em;vertical-align:-0.936em;\"></span><span><span></span><span><span><span><span style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>x</span><span><span>)</span><span><span><span><span style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>x</span></span></span></span><span>​</span></span><span><span style=\"height:0.936em;\"><span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>注意同时乘以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span> 之后，求和符号下面仍然应该是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>。不过由于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span> 时 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.849108em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span><span>x</span><span><span><span><span style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>，不影响结果，所以可以把 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 扩展到 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>。上式就是后续计算中所需的等式之一。</p>\n<p>第二个知识点是，在总共有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个节点的堆中，高度为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span> 的节点最多有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.0991079999999998em;vertical-align:-0.25em;\"></span><span>⌈</span><span>n</span><span>/</span><span><span>2</span><span><span><span><span style=\"height:0.8491079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>+</span><span>1</span></span></span></span></span></span></span></span></span><span>⌉</span></span></span></span> 个。可以使用数学归纳法来证明这一点，基础情况 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>，也就是说高度为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span> 的节点最多有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⌈</span><span>n</span><span>/2</span><span>⌉</span></span></span></span> 个。由于高度为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span> 的节点一定是叶节点，所以基础情况成立。</p>\n<p>假设命题在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span>h</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 时成立，含 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个节点的堆 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.13889em;\">T</span></span></span></span> 共有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>h</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 个高度为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span> 的节点。把 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.13889em;\">T</span></span></span></span> 的所有叶节点去除，构成新的堆 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.751892em;vertical-align:0em;\"></span><span><span style=\"margin-right:0.13889em;\">T</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span></span></span></span></span></span></span></span>。根据堆的性质，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.751892em;vertical-align:0em;\"></span><span><span style=\"margin-right:0.13889em;\">T</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span></span></span></span></span></span></span></span> 含有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⌊</span><span>n</span><span>/2</span><span>⌋</span></span></span></span> 个节点。注意原先在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.13889em;\">T</span></span></span></span> 中高度为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span> 的节点在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.751892em;vertical-align:0em;\"></span><span><span style=\"margin-right:0.13889em;\">T</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span></span></span></span></span></span></span></span> 中的高度为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span>h</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>。设 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.751892em;vertical-align:0em;\"></span><span><span style=\"margin-right:0.13889em;\">T</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span></span></span></span></span></span></span></span> 中高度为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span>h</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 的节点数量为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.093331em;vertical-align:-0.34143899999999994em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-2.4168920000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>−</span><span>1</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.34143899999999994em;\"><span></span></span></span></span></span></span></span></span></span>。</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>h</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.107223em;vertical-align:-0.305331em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.801892em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>−</span><span>1</span></span></span></span><span style=\"top:-3.1130000000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.305331em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.149108em;vertical-align:-0.25em;\"></span><span>⌈</span><span><span>n</span><span><span><span><span style=\"height:0.801892em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span></span></span></span></span><span>/</span><span><span>2</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>h</span></span></span></span></span></span></span></span><span>⌉</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.149108em;vertical-align:-0.25em;\"></span><span>⌈⌊</span><span>n</span><span>/2</span><span>⌋</span><span>/</span><span><span>2</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>h</span></span></span></span></span></span></span></span><span>⌉</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.149108em;vertical-align:-0.25em;\"></span><span>⌈(</span><span>n</span><span>/2</span><span>)</span><span>/</span><span><span>2</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>h</span></span></span></span></span></span></span></span><span>⌉</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.149108em;vertical-align:-0.25em;\"></span><span>⌈</span><span>n</span><span>/</span><span><span>2</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>+</span><span>1</span></span></span></span></span></span></span></span></span><span>⌉</span></span></span></span></span></p>\n<p>综上所述，在总共有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个节点的堆中，高度为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span> 的节点最多有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.0991079999999998em;vertical-align:-0.25em;\"></span><span>⌈</span><span>n</span><span>/</span><span><span>2</span><span><span><span><span style=\"height:0.8491079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>+</span><span>1</span></span></span></span></span></span></span></span></span><span>⌉</span></span></span></span> 个。</p>\n<p>如果节点 <code>i</code> 的高度为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span>，那么 <code>MAX-HEAPIFY(i)</code> 花费的时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>h</span><span>)</span></span></span></span>。按高度求和：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.2631180000000004em;vertical-align:-1.302113em;\"></span><span><span><span><span style=\"height:1.961005em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>h</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.386005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>⌊</span><span><span>l</span><span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>n</span><span>⌋</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span>⌈</span><span><span></span><span><span><span><span style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span><span>2</span><span><span><span><span style=\"height:0.7751079999999999em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>+</span><span>1</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>⌉</span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>h</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.2631180000000004em;vertical-align:-1.302113em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.961005em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>h</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.386005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>⌊</span><span><span>l</span><span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.19516666666666668em;\"></span><span>n</span><span>⌋</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span><span>2</span><span><span><span><span style=\"height:0.7751079999999999em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>h</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>h</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.9535100000000005em;vertical-align:-1.302113em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>h</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>∞</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span><span>2</span><span><span><span><span style=\"height:0.7751079999999999em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>h</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>h</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>)</span></span></span></span></span></p>\n<p>把前面证明的等式拿过来，令 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/2</span></span></span></span>：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:2.9535100000000005em;vertical-align:-1.302113em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>∞</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span><span>x</span><span><span><span><span style=\"height:0.8991079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.9535100000000005em;vertical-align:-1.302113em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>∞</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span><span>2</span><span><span><span><span style=\"height:0.7751079999999999em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.363em;vertical-align:-0.936em;\"></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1/2</span><span><span>)</span><span><span><span><span style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1/2</span></span></span></span><span>​</span></span><span><span style=\"height:0.936em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span></span></span></span></span></p>\n<p>综上，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span>。</p>\n<h2 id=\"_6-4-堆排序\"> 6.4 堆排序</h2>\n<p>利用 <code>MAX-HEAPIFY(i)</code> 和 <code>BUILD-MAX-HEAP</code> 可以构造出堆排序算法。</p>\n<div><pre><code>HEAPSORT(A)\n  BUILD-MAX-HEAP(A)\n  for i = A.length downto 2\n    交换 A[1] 和 A[i]\n    A.heap-size = A.heap-size - 1\n    MAX-HEAPIFY(A, 1)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div><p>堆排序的最坏情况运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>。</p>\n<h2 id=\"_6-5-优先队列\"> 6.5 优先队列</h2>\n<p><strong>优先队列</strong>（priority queue）是一种与堆类似的数据结构，以最大优先队列为例，它提供以下操作：</p>\n<ul>\n<li><code>INSERT(S, x)</code> 向队列中插入新元素。</li>\n<li><code>MAXIMUM(S)</code> 返回队列中最大的元素。</li>\n<li><code>EXTRACT-MAX(S)</code> 返回并从队列中删除最大的元素。</li>\n<li><code>INCREEASE-KEY(S, x, k)</code> 把元素 <code>x</code> 的值增加到 <code>k</code>，<code>k</code> 必须大于等于元素 <code>x</code> 现在的值。</li>\n</ul>\n<p>借助堆可以很方便地实现优先队列。</p>\n<div><pre><code>HEAP-MAXIMUM(A)\n  // 如果堆已经为空，那么报错\n  if A.heap-size &lt; 1\n    error &quot;heap underflow&quot;\n  return A[1]\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div><div><pre><code>HEAP-EXTRACT-MAX(A)\n  // 如果堆已经为空，那么报错\n  if A.heap-size &lt; 1\n    error &quot;heap underflow&quot;\n\n  max = A[1]\n  A[1] = A[A.heap-size]\n  A.heap-size = A.heap-size - 1\n  MAX-HEAPIFY(A, 1)\n  return max\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br></div></div><div><pre><code>HEAP-INCREEASE-KEY(A, i, key)\n  // 新的 key 必须大于等于当前的 key\n  if key &lt; A[i]\n    error &quot;new key is smaller than current key&quot;\n\n  A[i] = key\n  while i &gt; 1 and A[PARENT(i)] &lt; A[i]\n    交换 A[i] 和 A[PARENT(i)]\n    i = PARENT(i)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></div></div><div><pre><code>HEAP-INSERT(A, key)\n  A.heap-size = A.heap-size + 1\n  A[A.heap-size] = - infinity\n  HEAP-INCREEASE-KEY(A, A.heap-size, key)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div>",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": [
        "算法导论"
      ]
    },
    {
      "title": "算法导论9 中位数和顺序统计",
      "url": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/9%20%E4%B8%AD%E4%BD%8D%E6%95%B0%E5%92%8C%E9%A1%BA%E5%BA%8F%E7%BB%9F%E8%AE%A1/",
      "id": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/9%20%E4%B8%AD%E4%BD%8D%E6%95%B0%E5%92%8C%E9%A1%BA%E5%BA%8F%E7%BB%9F%E8%AE%A1/",
      "content_html": "<h1 id=\"算法导论9-中位数和顺序统计\"> 算法导论9 中位数和顺序统计</h1>\n<p>第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span> 位顺序统计是指 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个元素的集合中第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span> 小的元素。那么元素集合的<strong>最小值</strong>（minimum）就是第一个顺序统计（<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>），<strong>最大值</strong>（maximum）就是第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个顺序统计（<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>）。</p>\n<p><strong>中位数</strong>（median）是集合中位于“中间”的元素。当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 为奇数时，中位数是第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span><span>/2</span></span></span></span> 个顺序统计；当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 为偶数时，中位数是第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/2</span></span></span></span> 和第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 两个顺序统计的平均数。通常把 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⌊(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span><span>/2</span><span>⌋</span></span></span></span> 称为<strong>下中位数</strong>（lower median），把<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⌈(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span><span>/2</span><span>⌉</span></span></span></span> 称为<strong>上中位数</strong>（upper median）。为简化描述，下文中的中位数均指下中位数。</p>\n<p>定义<strong>选择问题</strong>（selection problem）：</p>\n<blockquote>\n<p>输入：<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个互不相同的数字组成的集合 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>A</span></span></span></span> 和整数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span>，且有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.78111em;vertical-align:-0.13667em;\"></span><span>1</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.79619em;vertical-align:-0.13667em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>。</p>\n<p>输出：元素 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>x</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>A</span></span></span></span>，且 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span> 恰好大于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>A</span></span></span></span> 中的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.74285em;vertical-align:-0.08333em;\"></span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 个元素。</p>\n</blockquote>\n<h2 id=\"_9-1-最小值和最大值\"> 9.1 最小值和最大值</h2>\n<p>在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个元素构成的集合中选出最小值需要至少多少次比较？容易得到比较次数的上界 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>，伪代码如下：</p>\n<div><pre><code>MINIMUM(A)\n  min = A[1]\n  for i = 2 to A.length\n    if min &gt; A[i]\n      min = A[i]\n  return min\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div><p><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 也是比较次数的下界，因为每个元素至少要参与一次比较。<code>MAXIMUM(A)</code> 与 <code>MINIMUM(A)</code> 类似。</p>\n<h3 id=\"同时获取最小值和最大值\"> 同时获取最小值和最大值</h3>\n<p>可以直接把 <code>MAXIMUM(A)</code> 与 <code>MINIMUM(A)</code> 循环中的步骤组合，得到同时获取两个最值的函数。为了得到结果，一共会进行 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span>2</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span></span></span></span> 次比较。</p>\n<p>实际上存在只需要 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>3</span><span>n</span><span>/2</span></span></span></span> 次比较的算法。在新算法中，循环时同样需要维护最大值和最小值。每次读入两个元素，先比较这个两个元素的大小，然后将较小的与最小值比较，将较大的与最大值比较。这样一来，新算法就花费了 3 次比较处理了 2 个元素；而原先的算法需要 4 次比较来处理 2 个元素。</p>\n<h2 id=\"_9-2-期望线性时间的选择算法\"> 9.2 期望线性时间的选择算法</h2>\n<p>更加一般的选择问题比最值问题困难得多，但是二者的渐近运行时间都是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span>。改造第七章中的 <code>RANDOMIZED-QUICKSORT</code> 可以得到 <code>RANDOMIZED-SELECT</code> 算法，当输入的元素各不相同时，其期望运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span>。</p>\n<div><pre><code>RANDOMIZED-SELECT(A, p, r, i)\n  if p == r\n    return A[p]\n  q = RANDOMIZED-PARTITION(A, p, r)\n  k = q - p + 1\n  if i == k\n    return A[q]\n  else if i &lt; k\n    return RANDOMIZED-SELECT(A, p, q - 1, i)\n  else\n    return RANDOMIZED-SELECT(A, q + 1, r, i - k)\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br></div></div><p><code>RANDOMIZED-SELECT</code> 随机选择一个轴，将数组划分为小于轴和大于轴的两部分。此时要选择的元素能且只能是以下三种情况之一：等于轴，在轴的左侧，在轴的右侧。因此可以根据当前的情况，选择三者之一。</p>\n<p>类似 <code>RANDOMIZED-QUICKSORT</code>，<code>RANDOMIZED-SELECT</code> 的最坏运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span>。为了分析算法的期望运行时间，这里定义一些数学符号。假设有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个元素组成的集合 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>A</span></span></span></span>，算法每次运行时会把 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>A</span></span></span></span> 分为两个子集合 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>（此处认为轴也放在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 中）。随机变量：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.07847em;\">I</span><span>{</span><span><span>子集合</span><span> </span></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span> </span><span>有</span><span> </span></span><span style=\"margin-right:0.03148em;\">k</span><span><span> </span><span>个元素</span></span><span>}</span></span></span></span></span></p>\n<p>其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.78111em;vertical-align:-0.13667em;\"></span><span>1</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.83111em;vertical-align:-0.13667em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>。假设每个元素各不相同，算法选择任意元素作为轴的概率都是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>n</span></span></span></span>，那么有：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>n</span></span></span></span></span></p>\n<p>递推式（轴不参与递归）：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:6.507020000000001em;vertical-align:-3.0035100000000003em;\"></span><span><span><span><span><span><span style=\"height:3.5035100000000003em;\"><span style=\"top:-5.50351em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.6513970000000002em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:3.0035100000000003em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:3.5035100000000003em;\"><span style=\"top:-5.50351em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>max</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span>))</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>))</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>max</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span>))</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:3.0035100000000003em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>取数学期望：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:13.014039999999998em;vertical-align:-6.25702em;\"></span><span><span><span><span><span><span style=\"height:6.757019999999999em;\"><span style=\"top:-8.757019999999999em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)]</span></span></span><span style=\"top:-5.503509999999999em;\"><span style=\"height:3.6513970000000002em;\"></span><span></span></span><span style=\"top:-2.249999999999999em;\"><span style=\"height:3.6513970000000002em;\"></span><span></span></span><span style=\"top:1.0035099999999995em;\"><span style=\"height:3.6513970000000002em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:6.25702em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:6.757019999999999em;\"><span style=\"top:-8.757019999999999em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>max</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span>))</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)]</span></span></span><span style=\"top:-5.503509999999999em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>max</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span>))]</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-2.249999999999999em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>max</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span>))]</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:1.0035099999999995em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>max</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span>))]</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:6.25702em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>注意到 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>max</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.8388800000000001em;vertical-align:-0.19444em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span>)</span></span></span></span> 具有一定对称性：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>max</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.8388800000000001em;vertical-align:-0.19444em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span><span style=\"top:0em;\"><span>{</span></span><span><span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⌈</span><span>n</span><span>/2</span><span>⌉</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⌈</span><span>n</span><span>/2</span><span>⌉</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>综上：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.3171180000000007em;vertical-align:-1.5160049999999998em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.8011130000000006em;\"><span style=\"top:-1.8089950000000001em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>⌊</span><span>n</span><span>/2</span><span>⌋</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.5160049999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)]</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span></span></p>\n<p>求和终点变为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 是因为换元。接下来使用替换法来证明 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span>，需要证明存在常数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span></span></span></span> 满足 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span><span>n</span></span></span></span>。假设 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.78111em;vertical-align:-0.13667em;\"></span><span>1</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 时，都有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>c</span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 成立，那么（<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>a</span></span></span></span> 为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.02778em;\">O</span></span></span></span> 定义中的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span></span></span></span>）：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:16.301676em;vertical-align:-7.9008379999999985em;\"></span><span><span><span><span><span><span style=\"height:8.400838em;\"><span style=\"top:-10.56073em;\"><span style=\"height:3.961005em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)]</span></span></span><span style=\"top:-6.78372em;\"><span style=\"height:3.961005em;\"></span><span></span></span><span style=\"top:-3.7546070000000005em;\"><span style=\"height:3.961005em;\"></span><span></span></span><span style=\"top:-1.4471670000000008em;\"><span style=\"height:3.961005em;\"></span><span></span></span><span style=\"top:0.8602729999999982em;\"><span style=\"height:3.961005em;\"></span><span></span></span><span style=\"top:2.953832999999998em;\"><span style=\"height:3.961005em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:7.9008379999999985em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:8.400838em;\"><span style=\"top:-10.56073em;\"><span style=\"height:3.961005em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.8011130000000006em;\"><span style=\"top:-1.8089950000000001em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>⌊</span><span>n</span><span>/2</span><span>⌋</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.5160049999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>c</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>an</span></span></span><span style=\"top:-6.78372em;\"><span style=\"height:3.961005em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>2</span><span>c</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>(</span><span><span><span><span style=\"height:1.8011130000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span><span style=\"height:1.961005em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.386005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>⌊</span><span>n</span><span>/2</span><span>⌋</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>an</span></span></span><span style=\"top:-3.7546070000000005em;\"><span style=\"height:3.961005em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>2</span><span>c</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>(</span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>(</span><span>n</span><span>/2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>2</span><span>)</span><span>(</span><span>n</span><span>/2</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>an</span></span></span><span style=\"top:-1.4471670000000008em;\"><span style=\"height:3.961005em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>c</span><span>(</span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>4</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>3</span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>an</span></span></span><span style=\"top:0.8602729999999982em;\"><span style=\"height:3.961005em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>4</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>3</span><span>c</span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>c</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>an</span></span></span><span style=\"top:2.953832999999998em;\"><span style=\"height:3.961005em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>c</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span><span></span><span><span><span><span style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>4</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>c</span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>c</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>an</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:7.9008379999999985em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>我们需要证明的是，存在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span></span></span></span> 使得存在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 使 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 时 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span><span>n</span></span></span></span>。可以取 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>c</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>4</span><span>a</span></span></span></span>，此时存在：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.78667em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.09077em;vertical-align:-0.7693300000000001em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>c</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>4</span><span>a</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>2</span><span>c</span></span></span></span><span>​</span></span><span><span style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>综上，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span>。</p>\n<h2 id=\"_9-3-最坏情况线性时间的选择算法\"> 9.3 最坏情况线性时间的选择算法</h2>\n<p>接下来介绍一种能在最坏情况运行时间 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span> 内完成的选择算法 <code>SELECT</code>。与 <code>RANDOMIZED-SELECT</code> 不同，<code>SELECT</code> 是确定性算法。<code>SELECT</code> 算法从 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个元素中选择第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span> 小的元素的基本步骤如下：</p>\n<ol>\n<li>将 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个元素拆分为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⌈</span><span>n</span><span>/5</span><span>⌉</span></span></span></span> 组，每组 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>5</span></span></span></span> 个元素，最后一组可能不足 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>5</span></span></span></span> 个。</li>\n<li>使用插入排序将 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⌈</span><span>n</span><span>/5</span><span>⌉</span></span></span></span> 组元素各自排序，然后从排序后的列表中选出中位数。</li>\n<li>使用 <code>SELECT</code> 算法从 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⌈</span><span>n</span><span>/5</span><span>⌉</span></span></span></span> 个中位数中选出中位数，并记为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span>。</li>\n<li>使用中位数的中位数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span> 作为轴，把数组划分为两部分。假设左边的数组中有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 个元素，那么 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span> 就是第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 小的元素。</li>\n<li>如果 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span>，那么返回 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span>。否则根据 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span> 的大小，递归地在左边数组或右边数组执行 <code>SELECT</code>。</li>\n</ol>\n<p>为了确定算法的运行时间，首先需要计算比 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span> 大的元素的数量的下界。根据算法，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span> 是中位数的中位数，因此至少有一半的中位数比 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span> 大；每个中位数又代表了一个含有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>5</span></span></span></span> 个元素的数组，因此 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⌈</span><span>n</span><span>/5</span><span>⌉</span></span></span></span> 个数组中至少有一半的数组贡献了 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>3</span></span></span></span> 个比 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span> 大的元素。如果不算上最后一个不够 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>5</span></span></span></span> 个元素的数组和包含 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span> 的数组，那么一共有：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:2.00744em;vertical-align:-0.686em;\"></span><span>3</span><span>(⌈</span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>⌈</span><span><span></span><span><span><span><span style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>5</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>⌉⌉</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>2</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.00744em;vertical-align:-0.686em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>10</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>3</span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>6</span></span></span></span></span></p>\n<p>类似地，也有至少 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>3</span><span>n</span><span>/10</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>6</span></span></span></span> 个元素小于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span>。因此第 4 步中，最多会在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>3</span><span>n</span><span>/10</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>6</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>7</span><span>n</span><span>/10</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>6</span></span></span></span> 个元素上递归调用。递推式：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:3.0000299999999998em;vertical-align:-1.25003em;\"></span><span><span style=\"top:0em;\"><span>{</span></span><span><span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span style=\"margin-right:0.13889em;\">T</span><span>(⌈</span><span>n</span><span>/5</span><span>⌉)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>7</span><span>n</span><span>/10</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>6</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span><span style=\"width:1em;\"></span><span><span><span><span style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>140</span></span></span><span style=\"top:-2.25em;\"><span style=\"height:3.008em;\"></span><span><span><span>如果</span><span> </span></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>140</span></span></span></span><span>​</span></span><span><span style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>140</span></span></span></span> 的含义下文中会解释。还是使用替换法证明 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span>，需要证明存在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span></span></span></span> 使得能够找到 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.6891em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span> 满足任意 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 时 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span><span>n</span></span></span></span>。对递推式进行替换（其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>a</span></span></span></span> 是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.02778em;\">O</span></span></span></span> 定义中的上界）：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:4.500000000000002em;vertical-align:-2.000000000000001em;\"></span><span><span><span><span><span><span style=\"height:2.5000000000000004em;\"><span style=\"top:-4.66em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span></span></span><span style=\"top:-3.16em;\"><span style=\"height:3em;\"></span><span></span></span><span style=\"top:-1.6599999999999993em;\"><span style=\"height:3em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:2.000000000000001em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:2.5000000000000004em;\"><span style=\"top:-4.66em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>c</span><span>⌈</span><span>n</span><span>/5</span><span>⌉</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>c</span><span>(</span><span>7</span><span>n</span><span>/10</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>6</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>an</span></span></span><span style=\"top:-3.16em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>c</span><span>n</span><span>/5</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>c</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>7</span><span>c</span><span>n</span><span>/10</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>6</span><span>c</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>an</span></span></span><span style=\"top:-1.6599999999999993em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>c</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span>−</span><span>c</span><span>n</span><span>/10</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>7</span><span>c</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>an</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:2.000000000000001em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>由于需要证明 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span><span>n</span></span></span></span>，所以必须满足：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>−</span><span>c</span><span>n</span><span>/10</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span>7</span><span>c</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>an</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span></span></p>\n<p>当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>70</span></span></span></span> 时，有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>c</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>10</span><span>a</span><span>(</span><span>n</span><span>/</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>70</span><span>))</span></span></span></span>。由于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&gt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>140</span></span></span></span>，所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>70</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span></span></span></span>，因此选取 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span>c</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>20</span><span>a</span></span></span></span> 即可。<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>140</span></span></span></span> 并不是非常重要，只要随便选一个大于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>70</span></span></span></span> 的数字即可（不过 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span></span></span></span> 的范围需要随之调整）。</p>\n<p>还需要证明基础条件 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>140</span></span></span></span> 时命题成立，才能完成数学归纳法。这非常简单，因为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>140</span></span></span></span> 时函数值是一个非无穷大的数字，所以只要选一个非常大的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>c</span></span></span></span> 就可以使不等式成立了。综上 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>(</span><span>n</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span>。</p>\n",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": [
        "算法导论"
      ]
    },
    {
      "title": "快速排序的优化",
      "url": "https://flyginger.top/post/2021-05-19%20%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F%E7%9A%84%E4%BC%98%E5%8C%96/",
      "id": "https://flyginger.top/post/2021-05-19%20%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F%E7%9A%84%E4%BC%98%E5%8C%96/",
      "content_html": "<h1 id=\"快速排序的优化\"> 快速排序的优化</h1>\n<p>在对快速排序进行优化之前，回忆一下部分基于比较的排序算法的时间复杂度。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">排序算法</th>\n<th style=\"text-align:center\">最好情况</th>\n<th style=\"text-align:center\">最差情况</th>\n<th style=\"text-align:center\">平均情况</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">插入排序</td>\n<td style=\"text-align:center\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span></td>\n<td style=\"text-align:center\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span></td>\n<td style=\"text-align:center\">-</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">归并排序</td>\n<td style=\"text-align:center\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span></td>\n<td style=\"text-align:center\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span></td>\n<td style=\"text-align:center\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">堆排序</td>\n<td style=\"text-align:center\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span></td>\n<td style=\"text-align:center\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span></td>\n<td style=\"text-align:center\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">快速排序</td>\n<td style=\"text-align:center\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span></td>\n<td style=\"text-align:center\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span></td>\n<td style=\"text-align:center\"><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span></td>\n</tr>\n</tbody>\n</table>\n<p>由于描述归并排序和堆排序运行时间的符号是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>Θ</span></span></span></span>，也就是说同时有渐近上界和渐近下界，所以其运行时间是非常稳定的。但是归并排序并不是原地排序的，需要一些复制数据的时间。</p>\n<p>本文中的所有 benchmark 都是运行于以下环境：</p>\n<div><pre><code>goos: windows\ngoarch: amd64\ncpu: AMD Ryzen 5 3500U with Radeon Vega Mobile Gfx\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>设计如下的测试程序：</p>\n<div><pre><code><span>// benchmarkSort benchmarks sort function f.</span>\n<span>func</span> <span>benchmarkSort</span><span>(</span>b <span>*</span>testing<span>.</span>B<span>,</span> f <span>func</span><span>(</span><span>[</span><span>]</span><span>int</span><span>)</span><span>)</span> <span>{</span>\n    b<span>.</span><span>StopTimer</span><span>(</span><span>)</span>\n    <span>for</span> i <span>:=</span> <span>0</span><span>;</span> i <span>&lt;</span> b<span>.</span>N<span>;</span> i<span>++</span> <span>{</span>\n        data <span>:=</span> <span>make</span><span>(</span><span>[</span><span>]</span><span>int</span><span>,</span> <span>1</span><span>&lt;&lt;</span><span>12</span><span>)</span>\n        <span>for</span> j <span>:=</span> <span>0</span><span>;</span> j <span>&lt;</span> <span>len</span><span>(</span>data<span>)</span><span>;</span> j<span>++</span> <span>{</span>\n            data<span>[</span>j<span>]</span> <span>=</span> j <span>&amp;</span> <span>0xCCC</span>\n        <span>}</span>\n        b<span>.</span><span>StartTimer</span><span>(</span><span>)</span>\n        <span>f</span><span>(</span>data<span>)</span>\n        b<span>.</span><span>StopTimer</span><span>(</span><span>)</span>\n    <span>}</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br></div></div><p><code>benchmark</code> 会生成从 0 到 4095 的共 4096 个数字，并通过异或操作，一定程度上把这 4096 个数字打乱顺序。归并排序和堆排序的运行结果如下：</p>\n<div><pre><code>BenchmarkMergeSort-8                2396            535552 ns/op\nBenchmarkHeapSort-8                 3826            427381 ns/op\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>可以看到，由于非原地排序，归并排序比堆排序要慢一些。</p>\n<p>常见的优化方法利用了常数较小的插入排序。在输入的数据量不大的情况下，由于插入排序的常数很小，所以它反而快一些。</p>\n<p><strong>希尔排序</strong>（Shell sort，以发明者 Donald Shell 的名字命名）是插入排序的一种优化版本。插入排序在基本有序的数组上的排序速度非常快，希尔排序针对这一点进行了优化。以 <code>[13, 14, 94, 33, 82, 25, 59, 94, 65, 23, 45, 27, 73, 25, 39, 10]</code> 举例，希尔排序的基本思路如下：</p>\n<p>首先以某个步长，比如说 5，将原数组分为数个子数组，每组 5 个元素：</p>\n<div><pre><code>13, 14, 94, 33, 82,\n25, 59, 94, 65, 23,\n45, 27, 73, 25, 39,\n10\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><p>然后对每一列进行插入排序：</p>\n<div><pre><code>10, 14, 73, 25, 23,\n13, 27, 94, 33, 39,\n25, 59, 94, 65, 82,\n45\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><p>然后再以更小的步长，比如说 3，将原数组分为数个子数组，每组 3 个元素；然后对每一列进行插入排序：</p>\n<div><pre><code>10, 14, 73,          10, 14, 13,\n25, 23, 13,          25, 23, 33,\n27, 94, 33,   --&gt;    27, 25, 59,\n39, 25, 59,          39, 65, 73,\n94, 65, 82,          45, 94, 82,\n45                   94\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div><p>最后，对原数组进行插入排序（相当于步长为 1）。由于原数组已经基本有序，所以此时插入排序很快就能完成。适当选择步长序列，希尔排序可以比插入排序快很多，但是最终还是无法达到 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span>，因此实际排序时基本不会使用以希尔排序为主的排序算法。</p>\n<p>然而，可以使用希尔排序来优化其他的排序算法。比如当数组中元素数量不超过 12（这个魔数来自于 Go 的源码）时，可以使用步长序列为 <code>[6, 1]</code> 的希尔排序：</p>\n<div><pre><code><span>// sort data[p:r]</span>\n<span>for</span> i <span>:=</span> p <span>+</span> <span>6</span><span>;</span> i <span>&lt;</span> r<span>;</span> i<span>++</span> <span>{</span>\n    <span>if</span> data<span>[</span>i<span>-</span><span>6</span><span>]</span> <span>></span> data<span>[</span>i<span>]</span> <span>{</span>\n        data<span>[</span>i<span>-</span><span>6</span><span>]</span><span>,</span> data<span>[</span>i<span>]</span> <span>=</span> data<span>[</span>i<span>]</span><span>,</span> data<span>[</span>i<span>-</span><span>6</span><span>]</span>\n    <span>}</span>\n<span>}</span>\n<span>insertionSort</span><span>(</span>data<span>,</span> p<span>,</span> r<span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></div></div><p>对于元素数量不超过 12 的数组，步长为 6 时最多可以分为两组，即 <code>data[p:p+6]</code> 和 <code>data[p+6:r]</code>。此时由于原数组只能排成两行，所以对每一列进行排序时不需要插入排序，只需要简单地比较并在需要时交换每一列的两个元素即可。</p>\n<p>希尔排序在排序元素数量不超过 12 个的数组时要比其它算法快很多。因此可以用于优化使用分治策略的排序算法，例如归并排序和快速排序。对归并排序进行如下优化：</p>\n<div><pre><code><span>// mergeSort sorts data[a:b] using merge sort and Shell sort.</span>\n<span>func</span> <span>mergeSort</span><span>(</span>data <span>[</span><span>]</span><span>int</span><span>,</span> a<span>,</span> b <span>int</span><span>)</span> <span>{</span>\n    <span>if</span> b<span>-</span>a <span>></span> <span>12</span> <span>{</span>\n        m <span>:=</span> <span>(</span>a <span>+</span> b<span>)</span> <span>/</span> <span>2</span>\n        <span>mergeSort</span><span>(</span>data<span>,</span> a<span>,</span> m<span>)</span>\n        <span>mergeSort</span><span>(</span>data<span>,</span> m<span>,</span> b<span>)</span>\n        <span>merge</span><span>(</span>data<span>,</span> a<span>,</span> m<span>,</span> b<span>)</span>\n    <span>}</span> <span>else</span> <span>{</span>\n        <span>for</span> i <span>:=</span> a <span>+</span> <span>6</span><span>;</span> i <span>&lt;</span> b<span>;</span> i<span>++</span> <span>{</span>\n            <span>if</span> data<span>[</span>i<span>-</span><span>6</span><span>]</span> <span>></span> data<span>[</span>i<span>]</span> <span>{</span>\n                data<span>[</span>i<span>-</span><span>6</span><span>]</span><span>,</span> data<span>[</span>i<span>]</span> <span>=</span> data<span>[</span>i<span>]</span><span>,</span> data<span>[</span>i<span>-</span><span>6</span><span>]</span>\n            <span>}</span>\n        <span>}</span>\n        <span>insertionSort</span><span>(</span>data<span>,</span> a<span>,</span> b<span>)</span>\n    <span>}</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br></div></div><p>此时再进行 benchmark：</p>\n<div><pre><code>BenchmarkMergeSort-8                5910            198517 ns/op\nBenchmarkHeapSort-8                 4400            300410 ns/op\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>可以发现归并排序的性能大幅提升。回到主题快速排序上来，不加任何优化的快速排序的 benchmark 如下：</p>\n<div><pre><code>BenchmarkMergeSort-8                5998            194616 ns/op\nBenchmarkHeapSort-8                 3949            320046 ns/op\nBenchmarkQuickSort-8                1956            624101 ns/op\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>可以说是非常慢了。这种基础款快速排序中，每次递归中会选取第一个元素、最后一个元素和中间元素的中位数作为轴，划分数组并继续递归。这称之为 median-of-three quick sort。理论上很美好，但是实际的运行速度慢很多。</p>\n<p>第一个优化方法，在数组中元素数量较少（不超过 12 个）时使用希尔排序。优化后的 benchmark 是：</p>\n<div><pre><code>BenchmarkMergeSort-8                5082            226612 ns/op\nBenchmarkHeapSort-8                 4099            338226 ns/op\nBenchmarkQuickSort-8                1958            663892 ns/op\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>不能说是毫无反应，甚至可以说是负优化了。快速排序的运行时间主要取决于每次划分是否平衡，平衡的划分会大幅减少运行时间。那么可以考虑检查划分的平衡情况，在不平衡时适当补救。</p>\n<p>在进行快速排序之前，先计算元素数量这个值本身占用多少二进制位。比如说 5 的二进制是 101，占用 3 个二进制位。</p>\n<div><pre><code>height <span>:=</span> <span>0</span>\n<span>for</span> i <span>:=</span> <span>len</span><span>(</span>data<span>)</span><span>;</span> i <span>></span> <span>0</span><span>;</span> i <span>>>=</span> <span>1</span> <span>{</span>\n    height<span>++</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><p>在每次快速排序的递归中，都将 <code>height</code> 减 1。当 <code>height</code> 为 0，而快速排序还没有结束时，可以断定划分不太平衡。此时使用堆排序进行后续的排序，确保排序在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>l<span style=\"margin-right:0.01389em;\">g</span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span><span>)</span></span></span></span> 内完成。这种策略称为 introsort（introspective sort）。</p>\n<div><pre><code><span>// quickSort sorts data[p:r] using quick sort, heap sort and Shell sort.</span>\n<span>func</span> <span>quickSort</span><span>(</span>data <span>[</span><span>]</span><span>int</span><span>,</span> p<span>,</span> r<span>,</span> h <span>int</span><span>)</span> <span>{</span>\n    <span>if</span> r<span>-</span>p <span>></span> <span>12</span> <span>{</span>\n        <span>if</span> h <span>==</span> <span>0</span> <span>{</span>\n            <span>HeapSort</span><span>(</span>data<span>[</span>p<span>:</span>r<span>]</span><span>)</span>\n            <span>return</span>\n        <span>}</span>\n        h<span>--</span>\n\n        i<span>,</span> j<span>,</span> k <span>:=</span> p<span>,</span> <span>(</span>p<span>+</span>r<span>)</span><span>/</span><span>2</span><span>,</span> r<span>-</span><span>1</span>\n        <span>medianOfThree</span><span>(</span>data<span>,</span> i<span>,</span> j<span>,</span> k<span>)</span>\n\n        q <span>:=</span> <span>partition</span><span>(</span>data<span>,</span> p<span>,</span> r<span>)</span>\n        <span>quickSort</span><span>(</span>data<span>,</span> p<span>,</span> q<span>,</span> h<span>)</span>\n        <span>quickSort</span><span>(</span>data<span>,</span> q<span>+</span><span>1</span><span>,</span> r<span>,</span> h<span>)</span>\n    <span>}</span> <span>else</span> <span>{</span>\n        <span>for</span> i <span>:=</span> p <span>+</span> <span>6</span><span>;</span> i <span>&lt;</span> r<span>;</span> i<span>++</span> <span>{</span>\n            <span>if</span> data<span>[</span>i<span>-</span><span>6</span><span>]</span> <span>></span> data<span>[</span>i<span>]</span> <span>{</span>\n                data<span>[</span>i<span>-</span><span>6</span><span>]</span><span>,</span> data<span>[</span>i<span>]</span> <span>=</span> data<span>[</span>i<span>]</span><span>,</span> data<span>[</span>i<span>-</span><span>6</span><span>]</span>\n            <span>}</span>\n        <span>}</span>\n        <span>insertionSort</span><span>(</span>data<span>,</span> p<span>,</span> r<span>)</span>\n    <span>}</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br></div></div><p>结果 benchmark 如下：</p>\n<div><pre><code>BenchmarkMergeSort-8                5408            203932 ns/op\nBenchmarkHeapSort-8                 4149            284530 ns/op\nBenchmarkQuickSort-8                3999            282316 ns/op\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>一顿操作，才终于把快速排序拉到堆排序的水准上。Go 源码中，对于含有 40 个元素以上的数组，还会使用从 9 个元素中选中位数的方法令划分更为平衡；而且还考虑了元素重复的各种情况。加了那么多优化的 Go 源码快排性能怎么样呢？benchmark 如下：</p>\n<div><pre><code>BenchmarkMergeSort-8                6145            188567 ns/op\nBenchmarkHeapSort-8                 3876            304420 ns/op\nBenchmarkQuickSort-8                4798            302864 ns/op\nBenchmarkGoSort-8                   3578            283253 ns/op\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><p>不能说没用，确实好了一点，但是还是比不过优化过的归并排序。为什么还都说实际中快速排序表现好呢？一般认为是硬件实现的问题。在分析算法时，往往认为任何时候访问数组中的任意元素花费的时间是一样的。但是实际上，由于硬件使用了 cache，访问已缓存的元素和未缓存的元素花费的时间有很大的差别。快速排序算法中，分治的策略能够很好地利用 cache 的特性。归并排序由于不是原地排序，所以并不能很好地利用 cache。</p>\n<p>上文中的测试数据是 0 到 4095 的某个固定排列。下面换成随机生成 4096 个在 <code>[-2048, 2048)</code> 区间内的随机数，benchmark 如下：</p>\n<div><pre><code>BenchmarkMergeSort-8                2398            449681 ns/op\nBenchmarkHeapSort-8                 3744            361525 ns/op\nBenchmarkQuickSort-8                6000            287688 ns/op\nBenchmarkGoSort-8                   1546            672338 ns/op\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><p>快速排序的优势出现了，但是 Go 源码的快速排序表现令人疑惑。把数据范围换成 <code>[0, 100)</code>，也就是说会出现大量重复数字，benchmark 如下：</p>\n<div><pre><code>BenchmarkMergeSort-8                2790            403454 ns/op\nBenchmarkHeapSort-8                 3528            355765 ns/op\nBenchmarkQuickSort-8                4490            281145 ns/op\nBenchmarkGoSort-8                   3792            445658 ns/op\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><p>Go 的快速排序表现虽然提升了但也不是很好。接下来把数据规模从 4K 提升到 4M，数据范围是 <code>int</code> 能表示的所有整数。benchmark 如下：</p>\n<div><pre><code>BenchmarkMergeSort-8          15         709368793 ns/op\nBenchmarkHeapSort-8            8        1369536388 ns/op\nBenchmarkQuickSort-8          20         537647930 ns/op\nBenchmarkGoSort-8              9        1257871311 ns/op\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><p>快速排序杀疯了！然而 Go 的快速排序还是不好，不知道为什么。把数据范围缩小到 <code>[0, 1e6)</code> 以产生大量的重复元素，再试试：</p>\n<div><pre><code>BenchmarkMergeSort-8          14         732646471 ns/op\nBenchmarkHeapSort-8            8        1338195625 ns/op\nBenchmarkQuickSort-8          20         531818940 ns/op\nBenchmarkGoSort-8              9        1197205511 ns/op\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><p>我彻底迷惑了。Go 的快速排序到底是因为什么原因，对性能做出了妥协？是 <code>interface{}</code> 吗？</p>\n",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": [
        "每日迷惑"
      ]
    },
    {
      "title": "PyNN",
      "url": "https://flyginger.top/post/2021-05-22%20PyNN/",
      "id": "https://flyginger.top/post/2021-05-22%20PyNN/",
      "content_html": "<h1 id=\"pynn\"> PyNN</h1>\n<p><a href=\"http://neuralensemble.org/PyNN/\" target=\"_blank\" rel=\"noopener noreferrer\">PyNN</a>（发音与 pine 相同）是一种用于构建神经网络模型的语言，且独立于模拟器。使用 PyNN 的 API 和 Python 编程语言编写的模型代码，无需修改即可运行于多种 PyNN 支持的模拟器后端或者神经拟态（neuronmorphic）硬件系统。</p>\n<h2 id=\"安装\"> 安装</h2>\n<p>待续。</p>\n<h2 id=\"构建神经元\"> 构建神经元</h2>\n<p>一般来说，神经网络构建的基本思路是自底向上的。先描述各个神经元，然后再描述连接各个神经元的网络。PyNN 也遵循这个基本思路。</p>\n<h3 id=\"神经元类型-cell-type\"> 神经元类型（Cell Type）</h3>\n<p>在 PyNN 中，定义神经元模型的等式组被封装在 <code>CellType</code> 类中。PyNN 提供一个标准神经元类型库，其中的各种类型在所有的模拟器后端上都能一致运行。需要注意的是，这里的神经元类型是数学意义上的神经元类型。生物学意义上不同的神经元类型可能可以用参数不同的同一种数学神经元类型表示。下文中会混淆使用数学神经元类型和生物神经元类型两个概念，统称为神经元类型。</p>\n<p>举例来说，标准库中提供了神经元类型 <code>EIF_cond_exp_isfa_ista</code>。通过不同的参数，可以得到不同的神经元类型 thalamocortical relay neurons 和 cortical neurons。</p>\n<div><pre><code><span>>></span><span>></span> <span># 参数一</span>\n<span>>></span><span>></span> ctx_parameters <span>=</span> <span>{</span><span>'cm'</span><span>:</span> <span>0.25</span><span>,</span> <span>'tau_m'</span><span>:</span> <span>20.0</span><span>,</span> <span>'v_rest'</span><span>:</span> <span>-</span><span>60</span><span>,</span> <span>'v_thresh'</span><span>:</span> <span>-</span><span>50</span><span>,</span> <span>'tau_refrac'</span><span>:</span> RandomDistribution<span>(</span><span>'uniform'</span><span>,</span> <span>[</span><span>2.0</span><span>,</span> <span>3.0</span><span>]</span><span>,</span> rng<span>=</span>NumpyRNG<span>(</span>seed<span>=</span><span>4242</span><span>)</span><span>)</span><span>,</span> <span>'v_reset'</span><span>:</span> <span>-</span><span>60</span><span>,</span> <span>'v_spike'</span><span>:</span> <span>-</span><span>50.0</span><span>,</span> <span>'a'</span><span>:</span> <span>1.0</span><span>,</span> <span>'b'</span><span>:</span> <span>0.005</span><span>,</span> <span>'tau_w'</span><span>:</span> <span>600</span><span>,</span> <span>'delta_T'</span><span>:</span> <span>2.5</span><span>,</span> <span>'tau_syn_E'</span><span>:</span> <span>5.0</span><span>,</span> <span>'e_rev_E'</span><span>:</span> <span>0.0</span><span>,</span> <span>'tau_syn_I'</span><span>:</span> <span>10.0</span><span>,</span> <span>'e_rev_I'</span><span>:</span> <span>-</span><span>80</span><span>}</span>\n<span>>></span><span>></span> <span># 参数二，基本与参数一相同，只有两项不同</span>\n<span>>></span><span>></span> tc_parameters <span>=</span> ctx_parameters<span>.</span>copy<span>(</span><span>)</span><span>.</span>update<span>(</span><span>{</span><span>'a'</span><span>:</span> <span>20.0</span><span>,</span> <span>'b'</span><span>:</span> <span>0.0</span><span>}</span><span>)</span>\n<span>>></span><span>></span> <span># 获取神经元类型</span>\n<span>>></span><span>></span> thalamocortical_type <span>=</span> EIF_cond_exp_isfa_ista<span>(</span><span>**</span>tc_parameters<span>)</span>\n<span>>></span><span>></span> cortical_type <span>=</span> EIF_cond_exp_isfa_ista<span>(</span><span>**</span>ctx_parameters<span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></div></div><p>注意，通过 <code>CellType</code> 创建的是<strong>神经元类型</strong>而不是神经元。</p>\n<p>可以使用 <code>get_parameter_names()</code> 方法查看神经元类型的所有参数。</p>\n<div><pre><code><span>>></span><span>></span> IF_cond_exp<span>.</span>get_parameter_names<span>(</span><span>)</span>\n<span>[</span><span>'tau_refrac'</span><span>,</span> <span>'cm'</span><span>,</span> <span>'tau_syn_E'</span><span>,</span> <span>'v_rest'</span><span>,</span> <span>'tau_syn_I'</span><span>,</span> <span>'tau_m'</span><span>,</span> <span>'e_rev_E'</span><span>,</span> <span>'i_offset'</span><span>,</span> <span>'e_rev_I'</span><span>,</span> <span>'v_thresh'</span><span>,</span> <span>'v_reset'</span><span>]</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>可以使用 <code>default_parameters</code> 属性查看所有参数的默认值。</p>\n<div><pre><code><span>>></span><span>></span> <span>print</span><span>(</span>IF_cond_exp<span>.</span>default_parameters<span>)</span>\n<span>{</span><span>'tau_refrac'</span><span>:</span> <span>0.1</span><span>,</span> <span>'cm'</span><span>:</span> <span>1.0</span><span>,</span> <span>'tau_syn_E'</span><span>:</span> <span>5.0</span><span>,</span> <span>'v_rest'</span><span>:</span> <span>-</span><span>65.0</span><span>,</span> <span>'tau_syn_I'</span><span>:</span> <span>5.0</span><span>,</span> <span>'tau_m'</span><span>:</span> <span>20.0</span><span>,</span> <span>'e_rev_E'</span><span>:</span> <span>0.0</span><span>,</span> <span>'i_offset'</span><span>:</span> <span>0.0</span><span>,</span> <span>'e_rev_I'</span><span>:</span> <span>-</span><span>70.0</span><span>,</span> <span>'v_thresh'</span><span>:</span> <span>-</span><span>50.0</span><span>,</span> <span>'v_reset'</span><span>:</span> <span>-</span><span>65.0</span><span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><h3 id=\"族群-population\"> 族群（Population）</h3>\n<div><p>注意</p>\n<p>Population 的翻译暂定为族群。</p>\n</div>\n<p>PyNN 是为神经元网络建模而设计的，因此默认的抽象层次是<strong>相同类型神经元构成的族群</strong>，而不是单个神经元。在 PyNN 中，使用 <code>Population</code> 类来表示族群。</p>\n<div><pre><code><span>>></span><span>></span> tc_cells <span>=</span> Population<span>(</span><span>100</span><span>,</span> thalamocortical_type<span>)</span>\n<span>>></span><span>></span> ctx_cells <span>=</span> Population<span>(</span><span>500</span><span>,</span> cortical_type<span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>创建一个族群时至少需要指定神经元数量和神经元类型。除此之外，还可以指定该族群中神经元的空间结构，神经元状态变量的初值，还有族群的标签。</p>\n<div><pre><code><span>>></span><span>></span> <span>from</span> pyNN<span>.</span>space <span>import</span> RandomStructure<span>,</span> Sphere\n<span>>></span><span>></span> tc_cells <span>=</span> Population<span>(</span>\n<span>.</span><span>.</span><span>.</span>     <span>100</span><span>,</span> thalamocortical_type<span>,</span>\n<span>.</span><span>.</span><span>.</span>     structure<span>=</span>RandomStructure<span>(</span>boundary<span>=</span>Sphere<span>(</span>radius<span>=</span><span>200.0</span><span>)</span><span>)</span><span>,</span>\n<span>.</span><span>.</span><span>.</span>     initial_values<span>=</span><span>{</span><span>'v'</span><span>:</span> <span>-</span><span>70.0</span><span>}</span><span>,</span>\n<span>.</span><span>.</span><span>.</span>     label<span>=</span><span>\"Thalamocortical neurons\"</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div><div><pre><code><span>>></span><span>></span> <span>from</span> pyNN<span>.</span>space <span>import</span> Grid2D\n<span>>></span><span>></span> <span>from</span> pyNN<span>.</span>random <span>import</span> RandomDistribution\n<span>>></span><span>></span> v_init <span>=</span> RandomDistribution<span>(</span><span>'uniform'</span><span>,</span> <span>(</span><span>-</span><span>70.0</span><span>,</span> <span>-</span><span>60.0</span><span>)</span><span>)</span>\n<span>>></span><span>></span> ctx_cells <span>=</span> Population<span>(</span>\n<span>.</span><span>.</span><span>.</span>     <span>500</span><span>,</span> cortical_type<span>,</span>\n<span>.</span><span>.</span><span>.</span>     structure<span>=</span>Grid2D<span>(</span>dx<span>=</span><span>10.0</span><span>,</span> dy<span>=</span><span>10.0</span><span>)</span><span>,</span>\n<span>.</span><span>.</span><span>.</span>     initial_values<span>=</span><span>{</span><span>'v'</span><span>:</span> v_init<span>}</span><span>,</span>\n<span>.</span><span>.</span><span>.</span>     label<span>=</span><span>\"Cortical neurons\"</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br></div></div><p>为了向后兼容，PyNN 也提供了 <code>create()</code> 函数作为 <code>Population</code> 的别名。以下两行等价（注意参数顺序不同）：</p>\n<div><pre><code><span>>></span><span>></span> cells <span>=</span> create<span>(</span>my_cell_type<span>,</span> n<span>=</span><span>100</span><span>)</span>\n<span>>></span><span>></span> cells <span>=</span> Population<span>(</span><span>100</span><span>,</span> my_cell_type<span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><h3 id=\"视图-view\"> 视图（View）</h3>\n<p>对族群的子集进行某些操作的需求也是经常出现的，例如修改参数值，添加连接或者记录数值变化等。可以通过 Python 的切片索引创建视图。</p>\n<div><pre><code><span>>></span><span>></span> n <span>=</span> ctx_cells<span>[</span><span>47</span><span>]</span>            <span># 族群中的第 48 个神经元</span>\n<span>>></span><span>></span> view <span>=</span> ctx_cells<span>[</span><span>:</span><span>80</span><span>]</span>        <span># 前 80 个神经元</span>\n<span>>></span><span>></span> view <span>=</span> ctx_cells<span>[</span><span>:</span><span>:</span><span>2</span><span>]</span>        <span># 第 1，3，5……个神经元</span>\n<span>>></span><span>></span> view <span>=</span> ctx_cells<span>[</span><span>45</span><span>,</span> <span>91</span><span>,</span> <span>7</span><span>]</span>  <span># 特定神经元集合</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><p>也可以通过 <code>sample()</code> 函数获取随机神经元集合构成的视图。</p>\n<div><pre><code><span>>></span><span>></span> view <span>=</span> ctx_cells<span>.</span>sample<span>(</span><span>50</span><span>,</span> rng<span>=</span>NumpyRNG<span>(</span>seed<span>=</span><span>6538</span><span>)</span><span>)</span>  <span># 随机选择 50 个神经元</span>\n</code></pre>\n<div><span>1</span><br></div></div><p>以上所有 <code>view</code> 都是一个 <code>PopulationView</code> 对象。<code>PopulationView</code> 中包含 <code>Population</code> 神经元子集的引用。因此通过 <code>PopulationView</code> 对神经元做出的任何修改都可以在 <code>Population</code> 中感知到，反之亦然。</p>\n<p>大部分情况下，<code>PopulationView</code> 都可以当作 <code>Population</code> 来使用。<code>PopulationView</code> 中有一个 <code>parent</code> 引用，指向神经元的 <code>Population</code> 源。<code>PopulationView</code> 中还有一个 <code>mask</code> 属性，列出了其中的所有神经元。</p>\n<div><pre><code><span>>></span><span>></span> view<span>.</span>parent<span>.</span>label\n<span>'Cortical neurons'</span>\n<span>>></span><span>></span> view<span>.</span>mask\narray<span>(</span><span>[</span><span>150</span><span>,</span> <span>181</span><span>,</span> <span>53</span><span>,</span> <span>149</span><span>,</span> <span>496</span><span>,</span> <span>499</span><span>,</span> <span>240</span><span>,</span> <span>444</span><span>,</span> <span>13</span><span>,</span> <span>100</span><span>,</span> <span>28</span><span>,</span> <span>19</span><span>,</span> <span>101</span><span>,</span> <span>122</span><span>,</span> <span>143</span><span>,</span> <span>486</span><span>,</span> <span>467</span><span>,</span> <span>492</span><span>,</span> <span>406</span><span>,</span> <span>90</span><span>,</span> <span>136</span><span>,</span> <span>173</span><span>,</span> <span>8</span><span>,</span> <span>341</span><span>,</span> <span>5</span><span>,</span> <span>348</span><span>,</span> <span>188</span><span>,</span> <span>63</span><span>,</span> <span>129</span><span>,</span> <span>416</span><span>,</span> <span>307</span><span>,</span> <span>298</span><span>,</span> <span>60</span><span>,</span> <span>180</span><span>,</span> <span>382</span><span>,</span> <span>47</span><span>,</span> <span>484</span><span>,</span> <span>370</span><span>,</span> <span>223</span><span>,</span> <span>147</span><span>,</span> <span>72</span><span>,</span> <span>32</span><span>,</span> <span>261</span><span>,</span> <span>193</span><span>,</span> <span>249</span><span>,</span> <span>212</span><span>,</span> <span>58</span><span>,</span> <span>87</span><span>,</span> <span>86</span><span>,</span> <span>456</span><span>]</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><h3 id=\"集群-assembly\"> 集群（Assembly）</h3>\n<div><p>注意</p>\n<p>Assembly 的翻译暂定为集群。这个翻译不太好，会和 cluster 混淆。</p>\n</div>\n<p><code>Assembly</code> 是 <code>Population</code> 和 <code>PopulationView</code> 的集合。<code>Assembly</code> 可以通过 <code>Population</code> 或 <code>PopulationView</code> 对象之间的加法得到，也可以直接构造：</p>\n<div><pre><code><span>>></span><span>></span> all_cells <span>=</span> tc_cells <span>+</span> ctx_cells\n<span>>></span><span>></span> cells_for_plotting <span>=</span> tc_cells<span>[</span><span>:</span><span>10</span><span>]</span> <span>+</span> ctx_cells<span>[</span><span>:</span><span>50</span><span>]</span>\n<span>>></span><span>></span> all_cells <span>=</span> Assembly<span>(</span>tc_cells<span>,</span> ctx_cells<span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>可以通过标签获取集群中的族群。</p>\n<div><pre><code><span>>></span><span>></span> all_cells<span>.</span>get_population<span>(</span><span>\"Thalamocortical neurons\"</span><span>)</span>\nPopulation<span>(</span><span>100</span><span>,</span> EIF_cond_exp_isfa_ista<span>(</span><span>&lt;</span>parameters<span>></span><span>)</span><span>,</span> structure<span>=</span>RandomStructure<span>(</span>origin<span>=</span><span>(</span><span>0.0</span><span>,</span> <span>0.0</span><span>,</span> <span>0.0</span><span>)</span><span>,</span> boundary<span>=</span>Sphere<span>(</span>radius<span>=</span><span>200.0</span><span>)</span><span>,</span> rng<span>=</span>NumpyRNG<span>(</span>seed<span>=</span><span>None</span><span>)</span><span>)</span><span>,</span> label<span>=</span><span>'Thalamocortical neurons'</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>也可以通过迭代 <code>Assembly</code> 的 <code>populations</code> 属性来访问各个族群。</p>\n<h3 id=\"查看和修改参数值和初始条件\"> 查看和修改参数值和初始条件</h3>\n<p>可以使用 <code>get()</code> 方法查看族群、视图和集群的参数。</p>\n<div><pre><code><span>>></span><span>></span> ctx_cells<span>.</span>get<span>(</span><span>'tau_m'</span><span>)</span>\n<span>20.0</span>\n<span>>></span><span>></span> all_cells<span>[</span><span>0</span><span>:</span><span>10</span><span>]</span><span>.</span>get<span>(</span><span>'v_reset'</span><span>)</span>\n<span>-</span><span>60.0</span>\n<span>>></span><span>></span> ctx_cells<span>.</span>get<span>(</span><span>[</span><span>'tau_m'</span><span>,</span> <span>'cm'</span><span>]</span><span>)</span>\n<span>[</span><span>20.0</span><span>,</span> <span>0.25</span><span>]</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div><p>如果该集合中的所有神经元的对应参数值相同，那么 <code>get()</code> 会返回单个数值，否则会返回一个 <code>NumPy</code> 数组。</p>\n<div><pre><code><span>>></span><span>></span> ctx_cells<span>.</span>get<span>(</span><span>'tau_refrac'</span><span>)</span>\narray<span>(</span><span>[</span> <span>2.64655001</span><span>,</span>  <span>2.15914942</span><span>,</span>  <span>2.53500179</span><span>]</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>可以使用 <code>set()</code> 方法修改参数的值。</p>\n<div><pre><code><span>>></span><span>></span> ctx_cells<span>.</span><span>set</span><span>(</span>a<span>=</span><span>2.0</span><span>,</span> b<span>=</span><span>0.2</span><span>)</span>\n</code></pre>\n<div><span>1</span><br></div></div><p><code>initialize()</code> 方法可以修改模型的初值。</p>\n<div><pre><code><span>>></span><span>></span> ctx_cells<span>.</span>initialize<span>(</span>v<span>=</span>RandomDistribution<span>(</span><span>'normal'</span><span>,</span> <span>(</span><span>-</span><span>65.0</span><span>,</span> <span>2.0</span><span>)</span><span>)</span><span>,</span> w<span>=</span><span>0.0</span><span>)</span>\n</code></pre>\n<div><span>1</span><br></div></div><p>模型默认的初值可以通过如下方式查看。</p>\n<div><pre><code><span>>></span><span>></span> ctx_cells<span>.</span>celltype<span>.</span>default_initial_values\n<span>{</span><span>'gsyn_exc'</span><span>:</span> <span>0.0</span><span>,</span> <span>'gsyn_inh'</span><span>:</span> <span>0.0</span><span>,</span> <span>'w'</span><span>:</span> <span>0.0</span><span>,</span> <span>'v'</span><span>:</span> <span>-</span><span>70.6</span><span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><h3 id=\"向神经元输送电流\"> 向神经元输送电流</h3>\n<p>PyNN 提供多种电流相关的类，均为 <code>CurrentSource</code> 的子类。可以通过 <code>CurrentSource</code> 的 <code>inject_into()</code> 方法向神经元输送电流。</p>\n<div><pre><code><span>>></span><span>></span> pulse <span>=</span> DCSource<span>(</span>amplitude<span>=</span><span>0.5</span><span>,</span> start<span>=</span><span>20.0</span><span>,</span> stop<span>=</span><span>80.0</span><span>)</span>\n<span>>></span><span>></span> pulse<span>.</span>inject_into<span>(</span>tc_cells<span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>或者使用族群、视图、集群的<code>inject()</code> 方法向神经元输送电流。</p>\n<div><pre><code><span>>></span><span>></span> <span>import</span> numpy\n<span>>></span><span>></span> times <span>=</span> numpy<span>.</span>arange<span>(</span><span>0.0</span><span>,</span> <span>100.0</span><span>,</span> <span>1.0</span><span>)</span>\n<span>>></span><span>></span> amplitudes <span>=</span> <span>0.1</span><span>*</span>numpy<span>.</span>sin<span>(</span>times<span>*</span>numpy<span>.</span>pi<span>/</span><span>100.0</span><span>)</span>\n<span>>></span><span>></span> sine_wave <span>=</span> StepCurrentSource<span>(</span>times<span>=</span>times<span>,</span> amplitudes<span>=</span>amplitudes<span>)</span>\n<span>>></span><span>></span> ctx_cells<span>[</span><span>80</span><span>:</span><span>90</span><span>]</span><span>.</span>inject<span>(</span>sine_wave<span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div><h3 id=\"记录变量\"> 记录变量</h3>\n<p><code>CellType</code> 的 <code>recordable</code> 属性给出了该神经元类型中的所有可记录的状态变量。</p>\n<div><pre><code><span>>></span><span>></span> ctx_cells<span>.</span>celltype<span>.</span>recordable\n<span>[</span><span>'spikes'</span><span>,</span> <span>'v'</span><span>,</span> <span>'w'</span><span>,</span> <span>'gsyn_exc'</span><span>,</span> <span>'gsyn_inh'</span><span>]</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>使用 <code>record()</code> 方法指定需要被记录的变量。</p>\n<div><pre><code><span>>></span><span>></span> all_cells<span>.</span>record<span>(</span><span>'spikes'</span><span>)</span>\n<span>>></span><span>></span> ctx_cells<span>.</span>sample<span>(</span><span>10</span><span>)</span><span>.</span>record<span>(</span><span>(</span><span>'v'</span><span>,</span> <span>'w'</span><span>)</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>在模拟结束后，可以使用 <code>get_data()</code> 方法取回记录的数据。</p>\n<div><pre><code><span>>></span><span>></span> t <span>=</span> run<span>(</span><span>0.2</span><span>)</span>\n<span>>></span><span>></span> data_block <span>=</span> all_cells<span>.</span>get_data<span>(</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>或者可以使用 <code>write_data()</code> 方法把数据直接写到文件中。</p>\n<div><pre><code><span>>></span><span>></span> <span>from</span> neo<span>.</span>io <span>import</span> NeoHdf5IO\n<span>>></span><span>></span> h5file <span>=</span> NeoHdf5IO<span>(</span><span>\"my_data.h5\"</span><span>)</span>\n<span>>></span><span>></span> ctx_cells<span>.</span>write_data<span>(</span>h5file<span>)</span>\n<span>>></span><span>></span> h5file<span>.</span>close<span>(</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><p><code>get_data()</code> 返回一个 <a href=\"http://neuralensemble.org/neo/\" target=\"_blank\" rel=\"noopener noreferrer\">Neo</a> <code>Block</code> 对象。<code>write_data()</code> 方法同样利用了 Neo。</p>\n<h3 id=\"单个神经元\"> 单个神经元</h3>\n<p>单个神经元是一个 <code>ID</code> 对象。注意 <code>ID</code> 在不同的模拟器后端中可能有不同的值。</p>\n<div><pre><code><span>>></span><span>></span> tc_cells<span>[</span><span>47</span><span>]</span>\n<span>709</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>可以通过 <code>parent</code> 属性访问神经元所在的族群。</p>\n<div><pre><code><span>>></span><span>></span> a_cell <span>=</span> tc_cells<span>[</span><span>47</span><span>]</span>\n<span>>></span><span>></span> a_cell<span>.</span>parent<span>.</span>label\n<span>'Thalamocortical neurons'</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>使用 <code>Population.id_to_index()</code> 可以获取神经元在族群中的原索引值。</p>\n<div><pre><code><span>>></span><span>></span> tc_cells<span>.</span>id_to_index<span>(</span>a_cell<span>)</span>\n<span>47</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>可以直接通过 <code>ID</code> 访问神经元的各个参数，也可以通过 <code>set_parameters()</code> 方法来修改参数的值：</p>\n<div><pre><code><span>>></span><span>></span> a_cell<span>.</span>tau_m\n<span>20.0</span>\n<span>>></span><span>></span> a_cell<span>.</span>set_parameters<span>(</span>tau_m<span>=</span><span>10.0</span><span>,</span> cm<span>=</span><span>0.5</span><span>)</span>\n<span>>></span><span>></span> a_cell<span>.</span>tau_m\n<span>10.0</span>\n<span>>></span><span>></span> a_cell<span>.</span>cm\n<span>0.5</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></div></div><h2 id=\"构建网络\"> 构建网络</h2>\n<p>从概念上来说，突触由突触前部（pre-synaptic structure）、突触间隙（synaptic cleft）和突出后部（post-synaptic structure）构成。在 PyNN 中，突触后反应的时间动态（temporal dynamics）由突触后神经元模型处理。突触后反应的烈度（即突触权重，synaptic weight），权重的时间动态（即突触可塑性，synaptic plasticity）和连接的延迟由突触模型处理。</p>\n<p>PyNN 中的突触连接至少需要提供两种属性，权重和延迟。</p>\n<p>本节中用神经元群指代族群、视图或集群对象。</p>\n<h3 id=\"突触类型-synapse-type\"> 突触类型（Synapse Type）</h3>\n<p>突触模型被封装在 <code>SynapseType</code> 类中。PyNN 提供一个突触类型的标准库，能够保证在各个后端模拟器上的模拟结果是一致的。</p>\n<p>PyNN 的默认突触类型，也是最简单的突触类型，就是固定权重突触。</p>\n<div><pre><code>syn <span>=</span> StaticSynapse<span>(</span>weight<span>=</span><span>0.04</span><span>,</span> delay<span>=</span><span>0.5</span><span>)</span>\n</code></pre>\n<div><span>1</span><br></div></div><p>权重一般分为两类。一类是基于电流的权重，单位是纳安（nanoamps）。抑制性的突触中，基于电流的权重是负数。另一类是基于电导（电导是电阻的倒数）的权重，单位是微西门子（microsiemens）。基于电导的权重总是正数。另外，延迟的单位是毫秒。</p>\n<p>可以使用随机数作为参数值，也可以把参数值定义为突触前和突触后神经元距离的函数：</p>\n<div><pre><code>w <span>=</span> RandomDistribution<span>(</span><span>'gamma'</span><span>,</span> <span>[</span><span>10</span><span>,</span> <span>0.004</span><span>]</span><span>,</span> rng<span>=</span>NumpyRNG<span>(</span>seed<span>=</span><span>4242</span><span>)</span><span>)</span>\nsyn <span>=</span> StaticSynapse<span>(</span>weight<span>=</span>w<span>,</span> delay<span>=</span><span>0.5</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><div><pre><code>syn <span>=</span> StaticSynapse<span>(</span>weight<span>=</span>w<span>,</span> delay<span>=</span><span>\"0.2 + 0.01*d\"</span><span>)</span>\n</code></pre>\n<div><span>1</span><br></div></div><p>PyNN 提供一个短期突触可塑性（short-term synaptic plasticity）的标准模型。</p>\n<div><pre><code><span># depressing - 抑制</span>\ndepressing_synapse <span>=</span> TsodyksMarkramSynapse<span>(</span>weight<span>=</span>w<span>,</span> delay<span>=</span><span>0.2</span><span>,</span> U<span>=</span><span>0.5</span><span>,</span> tau_rec<span>=</span><span>800.0</span><span>,</span> tau_facil<span>=</span><span>0.0</span><span>)</span>\n\n<span># facilitating - 促进</span>\ntau_rec <span>=</span> RandomDistribution<span>(</span><span>'normal'</span><span>,</span> <span>[</span><span>100.0</span><span>,</span> <span>10.0</span><span>]</span><span>)</span>\nfacilitating_synapse <span>=</span> TsodyksMarkramSynapse<span>(</span>weight<span>=</span>w<span>,</span> delay<span>=</span><span>0.5</span><span>,</span> U<span>=</span><span>0.04</span><span>,</span> tau_rec<span>=</span>tau_rec<span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div><p>脉冲时序依赖可塑性（STDP，spike-timing-dependent plasticity）与其他的标准模型略有不同。STDP 突触类型由两个独立的权重依赖（weight-dependence）和时序依赖（timing-dependence）组件构成。</p>\n<div><pre><code>stdp <span>=</span> STDPMechanism<span>(</span>\n    weight<span>=</span><span>0.02</span><span>,</span>  <span># 权重初值</span>\n    delay<span>=</span><span>\"0.2 + 0.01*d\"</span><span>,</span>\n    timing_dependence<span>=</span>SpikePairRule<span>(</span>tau_plus<span>=</span><span>20.0</span><span>,</span> tau_minus<span>=</span><span>20.0</span><span>,</span> A_plus<span>=</span><span>0.01</span><span>,</span> A_minus<span>=</span><span>0.012</span><span>)</span><span>,</span>\n    weight_dependence<span>=</span>AdditiveWeightDependence<span>(</span>w_min<span>=</span><span>0</span><span>,</span> w_max<span>=</span><span>0.04</span><span>)</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div><h3 id=\"连接算法\"> 连接算法</h3>\n<p>PyNN 中每种用于确定哪些突触前神经元连接哪些突触后神经元的算法（connection algorithm，也称为 connection method 或 wiring method）被封装在单独的类中。</p>\n<p>每一个这样的类都是 <code>Connector</code> 的子类，并且实现了 <code>connect(Projection)</code> 方法。注意 <code>Connector</code> 对象只是一种连接方法，并未建立实际的连接。</p>\n<p>突触前神经元群中的每个神经元都连接到突触后神经元群的每个神经元。<code>AllToAllConnector</code> 类提供了这样的连接，其构造器只需要一个可选参数 <code>allow_self_connections</code>，其默认值为 <code>True</code>，代表突触前神经元群和突触后神经元群是同一个神经元群。</p>\n<div><pre><code>connector <span>=</span> AllToAllConnector<span>(</span>allow_self_connections<span>=</span><span>False</span><span>)</span>\n</code></pre>\n<div><span>1</span><br></div></div><p><code>OneToOneConnector</code> 要求突触前和突触后神经元群中的神经元数量相同。两个神经元群中索引相同的神经元将被连接到一起。</p>\n<div><pre><code>connector <span>=</span> OneToOneConnector<span>(</span><span>)</span>\n</code></pre>\n<div><span>1</span><br></div></div><p>连接集代数（CSA，Connection Set Algebra）是一个复杂的系统，可以用精简的语法描述精细的连接模式。</p>\n<div><pre><code><span>import</span> csa\ncset <span>=</span> csa<span>.</span>full <span>-</span> csa<span>.</span>oneToOne\nconnector <span>=</span> CSAConnector<span>(</span>cset<span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>可以通过列表列出所有的连接。</p>\n<div><pre><code>connections <span>=</span> <span>[</span>\n  <span>(</span><span>0</span><span>,</span> <span>0</span><span>,</span> <span>0.0</span><span>,</span> <span>0.1</span><span>)</span><span>,</span>\n  <span>(</span><span>0</span><span>,</span> <span>1</span><span>,</span> <span>0.0</span><span>,</span> <span>0.1</span><span>)</span><span>,</span>\n  <span>(</span><span>0</span><span>,</span> <span>2</span><span>,</span> <span>0.0</span><span>,</span> <span>0.1</span><span>)</span><span>,</span>\n  <span>(</span><span>1</span><span>,</span> <span>5</span><span>,</span> <span>0.0</span><span>,</span> <span>0.1</span><span>)</span>\n<span>]</span>\nconnector <span>=</span> FromListConnector<span>(</span>connections<span>,</span> column_names<span>=</span><span>[</span><span>\"weight\"</span><span>,</span> <span>\"delay\"</span><span>]</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></div></div><p>连接模式也可以从文件中读取，但是文件开头需要有一行“表头”，指定每一列的含义。</p>\n<div><pre><code># columns = [&quot;i&quot;, &quot;j&quot;, &quot;weight&quot;, &quot;delay&quot;, &quot;U&quot;, &quot;tau_rec&quot;]\n</code></pre>\n<div><span>1</span><br></div></div><p>表体中的列需要使用空格间隔。</p>\n<div><pre><code>connector <span>=</span> FromFileConnector<span>(</span><span>\"connections.txt\"</span><span>)</span>\n</code></pre>\n<div><span>1</span><br></div></div><p>连接矩阵。</p>\n<div><pre><code>connections <span>=</span> numpy<span>.</span>array<span>(</span><span>[</span><span>[</span><span>0</span><span>,</span> <span>1</span><span>,</span> <span>1</span><span>,</span> <span>0</span><span>]</span><span>,</span>\n                           <span>[</span><span>1</span><span>,</span> <span>1</span><span>,</span> <span>0</span><span>,</span> <span>1</span><span>]</span><span>,</span>\n                           <span>[</span><span>0</span><span>,</span> <span>0</span><span>,</span> <span>1</span><span>,</span> <span>0</span><span>]</span><span>]</span><span>,</span> dtype<span>=</span><span>bool</span><span>)</span>\nconnector <span>=</span> ArrayConnector<span>(</span>connections<span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><h3 id=\"投影-projection\"> 投影（Projection）</h3>\n<p>投影是两个神经元群之间的连接集合。构造投影的同时，PyNN 会进行实际的连接。构造投影必须指定突触前神经元群，突触后神经元群，连接方法，突触类型。</p>\n<p>还有一些可选参数。首先是突触后机制，如果不指定，PyNN 会根据突触类型的权重参数自动选择。然后是标签，不指定时会自动生成。最后是 <code>Space</code> 对象，指定了突触前和突触后神经元间的距离应该如何计算。</p>\n<p>简单的例子。</p>\n<div><pre><code>excitatory_connections <span>=</span> Projection<span>(</span>\n    pre<span>,</span> post<span>,</span> AllToAllConnector<span>(</span><span>)</span><span>,</span> StaticSynapse<span>(</span>weight<span>=</span><span>0.123</span><span>)</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>复杂的例子。</p>\n<div><pre><code>rng <span>=</span> NumpyRNG<span>(</span>seed<span>=</span><span>64754</span><span>)</span>\nsparse_connectivity <span>=</span> FixedProbabilityConnector<span>(</span><span>0.1</span><span>,</span> rng<span>=</span>rng<span>)</span>\nweight_distr <span>=</span> RandomDistribution<span>(</span><span>'normal'</span><span>,</span> <span>[</span><span>0.01</span><span>,</span> <span>1e</span><span>-</span><span>3</span><span>]</span><span>,</span> rng<span>=</span>rng<span>)</span>\nfacilitating <span>=</span> TsodyksMarkramSynapse<span>(</span>\n    U<span>=</span><span>0.04</span><span>,</span> tau_rec<span>=</span><span>100.0</span><span>,</span> tau_facil<span>=</span><span>1000.0</span><span>,</span>\n    weight<span>=</span>weight_distr<span>,</span> delay<span>=</span><span>lambda</span> d<span>:</span> <span>0.1</span><span>+</span>d<span>/</span><span>100.0</span><span>)</span>\nspace <span>=</span> Space<span>(</span>axes<span>=</span><span>'xy'</span><span>)</span>\ninhibitory_connections <span>=</span> Projection<span>(</span>\n    pre<span>,</span> post<span>,</span>\n    connector<span>=</span>sparse_connectivity<span>,</span>\n    synapse_type<span>=</span>facilitating<span>,</span>\n    receptor_type<span>=</span><span>'inhibitory'</span><span>,</span>\n    space<span>=</span>space<span>,</span>\n    label<span>=</span><span>\"inhibitory connections\"</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br></div></div><p>使用 <code>get()</code> 方法访问投影中的连接。</p>\n<div><pre><code><span>>></span><span>></span> excitatory_connections<span>.</span>get<span>(</span><span>'weight'</span><span>,</span> <span>format</span><span>=</span><span>'list'</span><span>)</span><span>[</span><span>3</span><span>:</span><span>7</span><span>]</span>\n<span>[</span><span>(</span><span>3</span><span>,</span> <span>0</span><span>,</span> <span>0.123</span><span>)</span><span>,</span> <span>(</span><span>4</span><span>,</span> <span>0</span><span>,</span> <span>0.123</span><span>)</span><span>,</span> <span>(</span><span>5</span><span>,</span> <span>0</span><span>,</span> <span>0.123</span><span>)</span><span>,</span> <span>(</span><span>6</span><span>,</span> <span>0</span><span>,</span> <span>0.123</span><span>)</span><span>]</span>\n<span>>></span><span>></span> inhibitory_connections<span>.</span>get<span>(</span><span>'delay'</span><span>,</span> <span>format</span><span>=</span><span>'array'</span><span>)</span><span>[</span><span>:</span><span>3</span><span>,</span><span>:</span><span>5</span><span>]</span>\narray<span>(</span><span>[</span><span>[</span>  nan<span>,</span>   nan<span>,</span>   nan<span>,</span>   nan<span>,</span>  <span>0.14</span><span>]</span><span>,</span>\n       <span>[</span>  nan<span>,</span>   nan<span>,</span>   nan<span>,</span>  <span>0.12</span><span>,</span>  <span>0.13</span><span>]</span><span>,</span>\n       <span>[</span> <span>0.12</span><span>,</span>   nan<span>,</span>   nan<span>,</span>   nan<span>,</span>   nan<span>]</span><span>]</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div><p><code>format</code> 是 <code>list</code> 时，可以使用 <code>with_address</code> 来控制是否输出神经元索引。</p>\n<div><pre><code><span>>></span><span>></span> excitatory_connections<span>.</span>get<span>(</span><span>'weight'</span><span>,</span> <span>format</span><span>=</span><span>'list'</span><span>,</span> with_address<span>=</span><span>False</span><span>)</span><span>[</span><span>3</span><span>:</span><span>7</span><span>]</span>\n<span>[</span><span>0.123</span><span>,</span> <span>0.123</span><span>,</span> <span>0.123</span><span>,</span> <span>0.123</span><span>]</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>使用 <code>set()</code> 方法设置投影中连接的参数。</p>\n<div><pre><code><span>>></span><span>></span> excitatory_connections<span>.</span><span>set</span><span>(</span>weight<span>=</span><span>0.02</span><span>)</span>\n<span>>></span><span>></span> excitatory_connections<span>.</span><span>set</span><span>(</span>weight<span>=</span>RandomDistribution<span>(</span><span>'gamma'</span><span>,</span> <span>[</span><span>1</span><span>,</span> <span>0.1</span><span>]</span><span>)</span><span>,</span> delay<span>=</span><span>0.3</span><span>)</span>\n<span>>></span><span>></span> inhibitory_connections<span>.</span><span>set</span><span>(</span>U<span>=</span>numpy<span>.</span>linspace<span>(</span><span>0.4</span><span>,</span> <span>0.6</span><span>,</span> <span>len</span><span>(</span>inhibitory_connections<span>)</span><span>)</span><span>,</span> tau_rec<span>=</span><span>500.0</span><span>,</span> tau_facil<span>=</span><span>0.1</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br></div></div><p>也可以直接访问 <code>connections</code>。</p>\n<div><pre><code><span>>></span><span>></span> <span>for</span> c <span>in</span> <span>list</span><span>(</span>inhibitory_connections<span>.</span>connections<span>)</span><span>[</span><span>:</span><span>5</span><span>]</span><span>:</span>\n<span>.</span><span>.</span><span>.</span>     c<span>.</span>weight <span>*=</span> <span>2</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div>",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": [
        "每日迷惑"
      ]
    },
    {
      "title": "Go 的正则（一）",
      "url": "https://flyginger.top/post/2021-06-13%20Go%20%E7%9A%84%E6%AD%A3%E5%88%99%EF%BC%88%E4%B8%80%EF%BC%89/",
      "id": "https://flyginger.top/post/2021-06-13%20Go%20%E7%9A%84%E6%AD%A3%E5%88%99%EF%BC%88%E4%B8%80%EF%BC%89/",
      "content_html": "<h1 id=\"go-的正则-一\"> Go 的正则（一）</h1>\n<p>今天想研究一下 Go 的正则包是怎么实现的，看看能不能写一个效率高一些的 tokenizer 。正则包收到正则表达式后，一般首先会对其进行一些处理。 Go 的正则包，据我所知是 <code>re2</code> ，使用的是传统的 NFA/DFA 技术。因此，正则表达式应该会被转换成一个状态机。</p>\n<div><p>提示</p>\n<p>本文基于 Go 的 1.16.5 版本。</p>\n</div>\n<p>Go 的正则包位于 <code>regexp/</code> 。负责处理用户输入的正则表达式的函数之一是 <code>CompilePOSIX()</code> 。对于实现 tokenizer 来说， Perl 和 POSIX 的区别应该可以忽略不计。 <code>CompilePOSIX()</code> 看起来简单些，就以它作为入口。</p>\n<div><pre><code><span>// regexp/regexp.go</span>\n<span>func</span> <span>CompilePOSIX</span><span>(</span>expr <span>string</span><span>)</span> <span>(</span><span>*</span>Regexp<span>,</span> <span>error</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>生成好状态机后，接下来就是模拟状态机运行的过程。可以把 <code>Match()</code> 方法作为入口。</p>\n<div><pre><code><span>// regexp/regexp.go</span>\n<span>func</span> <span>(</span>re <span>*</span>Regexp<span>)</span> <span>Match</span><span>(</span>b <span>[</span><span>]</span><span>byte</span><span>)</span> <span>bool</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p><code>Match()</code> 函数与 tokenizer 的需求有点点不同。首先 tokenizer 需要返回匹配到的内容，而不仅仅是是否有匹配；其次， <code>Match()</code> 检查的是给定字符串内部是否含有正则表达式的匹配，而 tokenizer 只检查给定字符串的前缀是不是正则表达式的匹配。</p>\n<h2 id=\"生成正则表达式语法树\"> 生成正则表达式语法树</h2>\n<p><code>CompilePOSIX()</code> 首先调用了 <code>Parse()</code> 函数将用户输入的正则表达式转换为语法树。</p>\n<div><pre><code><span>// regexp/syntax/parse.go</span>\n<span>func</span> <span>Parse</span><span>(</span>s <span>string</span><span>,</span> flags Flags<span>)</span> <span>(</span><span>*</span>Regexp<span>,</span> <span>error</span><span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><div><p>提示</p>\n<p>注意 <code>Parse()</code> 和 <code>CompilePOSIX()</code> 的返回类型中的 <code>Regexp</code> 不是同一个类型，因为二者并不位于同一个包。</p>\n</div>\n<h3 id=\"语法树的数据结构\"> 语法树的数据结构</h3>\n<div><pre><code><span>// regexp/syntax/regexp.go</span>\n<span>type</span> Regexp <span>struct</span> <span>{</span>\n    Op       Op <span>// operator</span>\n    Flags    Flags\n    Sub      <span>[</span><span>]</span><span>*</span>Regexp  <span>// subexpressions, if any</span>\n    Sub0     <span>[</span><span>1</span><span>]</span><span>*</span>Regexp <span>// storage for short Sub</span>\n    Rune     <span>[</span><span>]</span><span>rune</span>     <span>// matched runes, for OpLiteral, OpCharClass</span>\n    Rune0    <span>[</span><span>2</span><span>]</span><span>rune</span>    <span>// storage for short Rune</span>\n    Min<span>,</span> Max <span>int</span>        <span>// min, max for OpRepeat</span>\n    Cap      <span>int</span>        <span>// capturing index, for OpCapture</span>\n    Name     <span>string</span>     <span>// capturing name, for OpCapture</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br></div></div><p><code>Regexp</code> 是语法树中的一个节点。</p>\n<h3 id=\"解析器的数据结构\"> 解析器的数据结构</h3>\n<div><pre><code><span>// regexp/syntax/parse.go</span>\n<span>type</span> parser <span>struct</span> <span>{</span>\n    flags       Flags     <span>// parse mode flags</span>\n    stack       <span>[</span><span>]</span><span>*</span>Regexp <span>// stack of parsed expressions</span>\n    free        <span>*</span>Regexp\n    numCap      <span>int</span> <span>// number of capturing groups seen</span>\n    wholeRegexp <span>string</span>\n    tmpClass    <span>[</span><span>]</span><span>rune</span> <span>// temporary char class work space</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></div></div><p>在解析过程中，会利用到 <code>parser</code> 这个结构。由于入口函数选择了 <code>CompilePOSIX()</code> ，所以 <code>flags == 0</code> 。其次， tokenizer 也不会用到 <code>group</code> 功能， <code>numCap</code> 也就没用了。 <code>wholeRegexp</code> 的作用比较明显，保存了用户输入的正则表达式。接下来需要关注的只有 <code>stack</code> 、 <code>free</code> 和 <code>tmpClass</code> 三个字段了。</p>\n<p>先解释一下 <code>free</code> 的作用，它其实是一个链表。在解析正则表达式的过程中，难免栈中要进进出出。如果从栈中弹出的节点直接丢掉，交给垃圾回收去处理，效率会低一些。为了提升效率， Go 的实现中复用了那些从栈中弹出的节点。这些节点会被放在以 <code>free</code> 为头的链表中。 <code>free</code> 直接指向一个 <code>Regexp</code> 结构，然后该 <code>Regexp</code> 利用其 <code>Sub0[0]</code> 字段指向下一个 <code>Regexp</code> 结构，从而形成链表。</p>\n<div><pre><code><span>// regexp/syntax/parse.go</span>\n<span>for</span> t <span>!=</span> <span>\"\"</span> <span>{</span>\n    repeat <span>:=</span> <span>\"\"</span>\nBigSwitch<span>:</span>\n    <span>switch</span> t<span>[</span><span>0</span><span>]</span> <span>{</span>\n        <span>// ...</span>\n    <span>}</span>\n    lastRepeat <span>=</span> repeat\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></div></div><p>进入 <code>Parse()</code> 函数后，是经典的 <code>for</code> 循环里放一个大 <code>switch</code> 。接下来依次查看每个 <code>case</code> 。</p>\n<h3 id=\"字面量\"> 字面量</h3>\n<p>字面量由 <code>default</code> 分支处理。大 <code>switch</code> 中把 <code>default</code> 分支写在了最前面。</p>\n<div><pre><code><span>// regexp/syntax/parse.go</span>\n<span>if</span> c<span>,</span> t<span>,</span> err <span>=</span> <span>nextRune</span><span>(</span>t<span>)</span><span>;</span> err <span>!=</span> <span>nil</span> <span>{</span>\n    <span>return</span> <span>nil</span><span>,</span> err\n<span>}</span>\np<span>.</span><span>literal</span><span>(</span>c<span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div><p>注意， <code>switch</code> 后跟随的表达式是 <code>t[0]</code> ，也就是仍未分析的正则表达式中的第一个字符（严格来说，是第一个 <code>byte</code> ）。而 <code>default</code> 分支没有使用这一个条件，直接从 <code>t</code> 中读取出了第一个 <code>rune</code> 。这使得 Go 的正则包支持 Unicode 。</p>\n<h3 id=\"括号\"> 括号</h3>\n<p>括号可以改变优先级和分组，是实现起来比较复杂的部分。</p>\n<div><pre><code><span>// regexp/syntax/parse.go</span>\n<span>case</span> <span>'('</span><span>:</span>\n    <span>// ...</span>\n    p<span>.</span>numCap<span>++</span>\n    p<span>.</span><span>op</span><span>(</span>opLeftParen<span>)</span><span>.</span>Cap <span>=</span> p<span>.</span>numCap\n    t <span>=</span> t<span>[</span><span>1</span><span>:</span><span>]</span>\n<span>case</span> <span>')'</span><span>:</span>\n    <span>if</span> err <span>=</span> p<span>.</span><span>parseRightParen</span><span>(</span><span>)</span><span>;</span> err <span>!=</span> <span>nil</span> <span>{</span>\n        <span>return</span> <span>nil</span><span>,</span> err\n    <span>}</span>\n    t <span>=</span> t<span>[</span><span>1</span><span>:</span><span>]</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br></div></div><p>这两个分支的最后一行都是 <code>t = t[1:]</code> ，删去了待分析正则表达式的第一个字符。再来看 <code>(</code> 分支，前两句仿佛都是与 <code>group</code> 相关的内容。但是其实 <code>op()</code> 方法中还是做了一些正经事的。</p>\n<div><pre><code><span>// regexp/syntax/parse.go</span>\n<span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>op</span><span>(</span>op Op<span>)</span> <span>*</span>Regexp <span>{</span>\n    re <span>:=</span> p<span>.</span><span>newRegexp</span><span>(</span>op<span>)</span>\n    <span>// ...</span>\n    <span>return</span> p<span>.</span><span>push</span><span>(</span>re<span>)</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div><p><code>op()</code> 方法创建了一个新的节点，然后将其压入栈中。创建新节点的方法里利用了 <code>free</code> 。</p>\n<div><pre><code><span>// regexp/syntax/parse.go</span>\n<span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>newRegexp</span><span>(</span>op Op<span>)</span> <span>*</span>Regexp <span>{</span>\n    re <span>:=</span> p<span>.</span>free\n    <span>if</span> re <span>!=</span> <span>nil</span> <span>{</span>\n        p<span>.</span>free <span>=</span> re<span>.</span>Sub0<span>[</span><span>0</span><span>]</span>\n        <span>*</span>re <span>=</span> Regexp<span>{</span><span>}</span>\n    <span>}</span> <span>else</span> <span>{</span>\n        re <span>=</span> <span>new</span><span>(</span>Regexp<span>)</span>\n    <span>}</span>\n    re<span>.</span>Op <span>=</span> op\n    <span>return</span> re\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br></div></div><p>当 <code>free</code> 不为空时， <code>newRegexp()</code> 会从链表 <code>free</code> 中取出第一个节点，并利用 <code>*re = Regexp{}</code> 将节点中原有的值全部重置。如果 <code>free</code> 为空，那么 <code>newRegexp()</code> 会直接创建新节点。</p>\n<div><pre><code><span>// regexp/syntax/parse.go</span>\n<span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>push</span><span>(</span>re <span>*</span>Regexp<span>)</span> <span>*</span>Regexp <span>{</span>\n    <span>// ...</span>\n    <span>}</span> <span>else</span> <span>{</span>\n        <span>// Incremental concatenation.</span>\n        p<span>.</span><span>maybeConcat</span><span>(</span><span>-</span><span>1</span><span>,</span> <span>0</span><span>)</span>\n    <span>}</span>\n\n    p<span>.</span>stack <span>=</span> <span>append</span><span>(</span>p<span>.</span>stack<span>,</span> re<span>)</span>\n    <span>return</span> re\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br></div></div><p>压栈是通过 <code>push()</code> 方法，这个方法的篇幅就很长了。但是如果略去处理括号的过程中不会执行的部分，那其实也没多少。然而这短短几行中调用了一个非常重要的方法 <code>maybeConcat()</code> 。</p>\n<div><pre><code><span>// regexp/syntax/parse.go</span>\n<span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>maybeConcat</span><span>(</span>r <span>rune</span><span>,</span> flags Flags<span>)</span> <span>bool</span> <span>{</span>\n    n <span>:=</span> <span>len</span><span>(</span>p<span>.</span>stack<span>)</span>\n    <span>if</span> n <span>&lt;</span> <span>2</span> <span>{</span>\n        <span>return</span> <span>false</span>\n    <span>}</span>\n\n    re1 <span>:=</span> p<span>.</span>stack<span>[</span>n<span>-</span><span>1</span><span>]</span>\n    re2 <span>:=</span> p<span>.</span>stack<span>[</span>n<span>-</span><span>2</span><span>]</span>\n    <span>if</span> re1<span>.</span>Op <span>!=</span> OpLiteral <span>||</span> re2<span>.</span>Op <span>!=</span> OpLiteral <span>||</span> re1<span>.</span>Flags<span>&amp;</span>FoldCase <span>!=</span> re2<span>.</span>Flags<span>&amp;</span>FoldCase <span>{</span>\n        <span>return</span> <span>false</span>\n    <span>}</span>\n\n    <span>// Push re1 into re2.</span>\n    re2<span>.</span>Rune <span>=</span> <span>append</span><span>(</span>re2<span>.</span>Rune<span>,</span> re1<span>.</span>Rune<span>...</span><span>)</span>\n\n    <span>// Reuse re1 if possible.</span>\n    <span>if</span> r <span>>=</span> <span>0</span> <span>{</span>\n        re1<span>.</span>Rune <span>=</span> re1<span>.</span>Rune0<span>[</span><span>:</span><span>1</span><span>]</span>\n        re1<span>.</span>Rune<span>[</span><span>0</span><span>]</span> <span>=</span> r\n        re1<span>.</span>Flags <span>=</span> flags\n        <span>return</span> <span>true</span>\n    <span>}</span>\n\n    p<span>.</span>stack <span>=</span> p<span>.</span>stack<span>[</span><span>:</span>n<span>-</span><span>1</span><span>]</span>\n    p<span>.</span><span>reuse</span><span>(</span>re1<span>)</span>\n    <span>return</span> <span>false</span> <span>// did not push r</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br></div></div><p><code>maybeConcat()</code> 会尝试对栈顶元素进行压缩，把连续的字面量字符放到同一个节点中。 <code>maybeConcat()</code> 的前几行进行了一个判断，如果解析栈中的节点数量少于 2 ，那么直接返回 <code>false</code> 。然后， <code>maybeConcat()</code> 读取了最后入栈的两个节点，命名为 <code>re1</code> 、 <code>re2</code> ，注意 <code>re2</code> 是先入栈的节点。如果 <code>re1</code> 和 <code>re2</code> 都是 <code>OpLiteral</code> 节点（字面量类型），并且对于是否忽略大小写的设置相同，那么继续执行；否则不能压缩，直接返回 <code>false</code> 。</p>\n<p>接下来， <code>maybeConcat()</code> 把 <code>re1.Rune</code> 附加到了 <code>re2.Rune</code> 之后，此时可以认为 <code>re1.Rune</code> 空了出来。当输入的字符 <code>r &gt;= 0</code> ，也就是说 <code>r</code> 是一个合法的 Unicode 字符时， <code>maybeConcat()</code> 会把 <code>r</code> 放到 <code>re1.Rune</code> 中，等价于 <code>re1.Rune = []rune{r}</code>。<code>re1.Rune0</code> 是一个定长数组 <code>[2]rune</code> ，推测其作用是在字符数量不多时，减少内存操作的次数。最后， <code>maybeConcat()</code> 返回 <code>ture</code> ，代表 <code>r</code> 已经被压入栈中。这是对 <code>re1</code> 的直接利用， <code>re1</code> 不必从栈中弹出，它里面原本保存的内容合并到了 <code>re2</code> 中，而它现在保存的内容是 <code>r</code> 。</p>\n<p>不过，处理括号的 <code>case</code> 在调用 <code>maybeConcat()</code> 时的参数 <code>r == -1</code> ，不是一个合法的 Unicode 字符。此时 <code>re1</code> 无法被直接利用，会被从栈中弹出，调用 <code>reuse()</code> 方法对其废物利用。最后 <code>maybeConcat()</code> 返回 <code>false</code> ， 代表 <code>r</code> 没有被压入栈中。</p>\n<div><pre><code><span>// regexp/syntax/parse.go</span>\n<span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>reuse</span><span>(</span>re <span>*</span>Regexp<span>)</span> <span>{</span>\n    re<span>.</span>Sub0<span>[</span><span>0</span><span>]</span> <span>=</span> p<span>.</span>free\n    p<span>.</span>free <span>=</span> re\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div><p>在 <code>reuse()</code> 方法中，从栈中弹出的节点被放在了链表 <code>free</code> 的头部。</p>\n<p><code>(</code> 分支创建了一个新节点压入栈中，接下来看 <code>)</code> 分支。它做的事情不多，只调用了一个 <code>parseRightParen()</code> 方法。</p>\n<div><pre><code><span>// regexp/syntax/parse.go</span>\n<span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>parseRightParen</span><span>(</span><span>)</span> <span>error</span> <span>{</span>\n    p<span>.</span><span>concat</span><span>(</span><span>)</span>\n    <span>if</span> p<span>.</span><span>swapVerticalBar</span><span>(</span><span>)</span> <span>{</span>\n        <span>// pop vertical bar</span>\n        p<span>.</span>stack <span>=</span> p<span>.</span>stack<span>[</span><span>:</span><span>len</span><span>(</span>p<span>.</span>stack<span>)</span><span>-</span><span>1</span><span>]</span>\n    <span>}</span>\n    p<span>.</span><span>alternate</span><span>(</span><span>)</span>\n\n    n <span>:=</span> <span>len</span><span>(</span>p<span>.</span>stack<span>)</span>\n    <span>if</span> n <span>&lt;</span> <span>2</span> <span>{</span>\n        <span>return</span> <span>&amp;</span>Error<span>{</span>ErrUnexpectedParen<span>,</span> p<span>.</span>wholeRegexp<span>}</span>\n    <span>}</span>\n    re1 <span>:=</span> p<span>.</span>stack<span>[</span>n<span>-</span><span>1</span><span>]</span>\n    re2 <span>:=</span> p<span>.</span>stack<span>[</span>n<span>-</span><span>2</span><span>]</span>\n    p<span>.</span>stack <span>=</span> p<span>.</span>stack<span>[</span><span>:</span>n<span>-</span><span>2</span><span>]</span>\n    <span>if</span> re2<span>.</span>Op <span>!=</span> opLeftParen <span>{</span>\n        <span>return</span> <span>&amp;</span>Error<span>{</span>ErrUnexpectedParen<span>,</span> p<span>.</span>wholeRegexp<span>}</span>\n    <span>}</span>\n    <span>// Restore flags at time of paren.</span>\n    p<span>.</span>flags <span>=</span> re2<span>.</span>Flags\n    <span>if</span> re2<span>.</span>Cap <span>==</span> <span>0</span> <span>{</span>\n        <span>// Just for grouping.</span>\n        p<span>.</span><span>push</span><span>(</span>re1<span>)</span>\n    <span>}</span> <span>else</span> <span>{</span>\n        re2<span>.</span>Op <span>=</span> OpCapture\n        re2<span>.</span>Sub <span>=</span> re2<span>.</span>Sub0<span>[</span><span>:</span><span>1</span><span>]</span>\n        re2<span>.</span>Sub<span>[</span><span>0</span><span>]</span> <span>=</span> re1\n        p<span>.</span><span>push</span><span>(</span>re2<span>)</span>\n    <span>}</span>\n    <span>return</span> <span>nil</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br></div></div><p><code>parseRightParen()</code> 调用了 <code>concat()</code> 方法对栈进行了预处理。</p>\n<div><pre><code><span>// regexp/syntax/parse.go</span>\n<span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>concat</span><span>(</span><span>)</span> <span>*</span>Regexp <span>{</span>\n    p<span>.</span><span>maybeConcat</span><span>(</span><span>-</span><span>1</span><span>,</span> <span>0</span><span>)</span>\n\n    <span>// Scan down to find pseudo-operator | or (.</span>\n    i <span>:=</span> <span>len</span><span>(</span>p<span>.</span>stack<span>)</span>\n    <span>for</span> i <span>></span> <span>0</span> <span>&amp;&amp;</span> p<span>.</span>stack<span>[</span>i<span>-</span><span>1</span><span>]</span><span>.</span>Op <span>&lt;</span> opPseudo <span>{</span>\n        i<span>--</span>\n    <span>}</span>\n    subs <span>:=</span> p<span>.</span>stack<span>[</span>i<span>:</span><span>]</span>\n    p<span>.</span>stack <span>=</span> p<span>.</span>stack<span>[</span><span>:</span>i<span>]</span>\n\n    <span>// Empty concatenation is special case.</span>\n    <span>if</span> <span>len</span><span>(</span>subs<span>)</span> <span>==</span> <span>0</span> <span>{</span>\n        <span>return</span> p<span>.</span><span>push</span><span>(</span>p<span>.</span><span>newRegexp</span><span>(</span>OpEmptyMatch<span>)</span><span>)</span>\n    <span>}</span>\n\n    <span>return</span> p<span>.</span><span>push</span><span>(</span>p<span>.</span><span>collapse</span><span>(</span>subs<span>,</span> OpConcat<span>)</span><span>)</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br></div></div><p>首先是熟悉的 <code>maybeConcat()</code> 方法，在几乎所有操作之前，都会顺手调用一下，压缩一下栈中的节点。 <code>Op</code> 代表着节点的类型，是事先定义好的常量，可以认为是枚举。</p>\n<div><pre><code><span>// regexp/syntax/regexp.go</span>\n<span>// An Op is a single regular expression operator.</span>\n<span>type</span> Op <span>uint8</span>\n\n<span>const</span> <span>(</span>\n    OpNoMatch        Op <span>=</span> <span>1</span> <span>+</span> <span>iota</span> <span>// matches no strings</span>\n    <span>// ...</span>\n    OpAlternate                    <span>// matches alternation of Subs</span>\n<span>)</span>\n\n<span>const</span> opPseudo Op <span>=</span> <span>128</span> <span>// where pseudo-ops start</span>\n\n<span>// regexp/syntax/parse.go</span>\n<span>const</span> <span>(</span>\n    opLeftParen <span>=</span> opPseudo <span>+</span> <span>iota</span>\n    opVerticalBar\n<span>)</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br></div></div><p>显然，值大于等于分界线 <code>opPseudo</code> 的只有 <code>opLeftParen</code> 和 <code>opVerticalBar</code> 。所以 <code>concat()</code> 是在找最后入栈的 <code>(</code> 或者是 <code>|</code> 。找到之后，<code>concat()</code> 把栈分成了两截，前半截（包括找到的 <code>(</code> 或 <code>|</code> ，如果有的话）仍在栈中，后半截保存到了 <code>subs</code> 中。</p>\n<p>如果 <code>subs</code> 为空，代表这一段正则表达式匹配空，例如正则表达式 <code>a()b</code> 。 <code>concat()</code> 会向栈中压入一个匹配空的节点。如果 <code>subs</code> 不为空，那么 <code>concat()</code> 会调用 <code>collapse()</code> 方法。</p>\n<p><code>subs</code> 是一个节点数组，数组中的每一个节点可以看作是一个子表达式。 <code>collapse()</code> 会对第一参数执行第二个参数指定的操作。具体来说， <code>collapse(subs, OpConcat)</code> 会把 <code>subs</code> 中的所有元素连接起来。</p>\n<h2 id=\"本文小结\"> 本文小结</h2>\n<p>今天先到这了。</p>\n<p>目前来说，没什么复杂的。主要是因为 Go 的实现使用了一些奇技淫巧来优化性能，搞得代码看起来比较难懂。</p>\n",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": [
        "编译器"
      ]
    },
    {
      "title": "Go 的正则（三）",
      "url": "https://flyginger.top/post/2021-06-15%20Go%20%E7%9A%84%E6%AD%A3%E5%88%99%EF%BC%88%E4%B8%89%EF%BC%89/",
      "id": "https://flyginger.top/post/2021-06-15%20Go%20%E7%9A%84%E6%AD%A3%E5%88%99%EF%BC%88%E4%B8%89%EF%BC%89/",
      "content_html": "<h1 id=\"go-的正则-三\"> Go 的正则（三）</h1>\n<p>括号的处理还没有说完……</p>\n<h2 id=\"括号\"> 括号</h2>\n<p>终于看完了 <code>parseRightParen()</code> 的第一行，接下来它调用了 <code>swapVerticalBar()</code> 方法。</p>\n<div><pre><code><span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>swapVerticalBar</span><span>(</span><span>)</span> <span>bool</span> <span>{</span>\n    <span>// If above and below vertical bar are literal or char class,</span>\n    <span>// can merge into a single char class.</span>\n    n <span>:=</span> <span>len</span><span>(</span>p<span>.</span>stack<span>)</span>\n    <span>if</span> n <span>>=</span> <span>3</span> <span>&amp;&amp;</span> p<span>.</span>stack<span>[</span>n<span>-</span><span>2</span><span>]</span><span>.</span>Op <span>==</span> opVerticalBar <span>&amp;&amp;</span> <span>isCharClass</span><span>(</span>p<span>.</span>stack<span>[</span>n<span>-</span><span>1</span><span>]</span><span>)</span> <span>&amp;&amp;</span> <span>isCharClass</span><span>(</span>p<span>.</span>stack<span>[</span>n<span>-</span><span>3</span><span>]</span><span>)</span> <span>{</span>\n        re1 <span>:=</span> p<span>.</span>stack<span>[</span>n<span>-</span><span>1</span><span>]</span>\n        re3 <span>:=</span> p<span>.</span>stack<span>[</span>n<span>-</span><span>3</span><span>]</span>\n        <span>// Make re3 the more complex of the two.</span>\n        <span>if</span> re1<span>.</span>Op <span>></span> re3<span>.</span>Op <span>{</span>\n            re1<span>,</span> re3 <span>=</span> re3<span>,</span> re1\n            p<span>.</span>stack<span>[</span>n<span>-</span><span>3</span><span>]</span> <span>=</span> re3\n        <span>}</span>\n        <span>mergeCharClass</span><span>(</span>re3<span>,</span> re1<span>)</span>\n        p<span>.</span><span>reuse</span><span>(</span>re1<span>)</span>\n        p<span>.</span>stack <span>=</span> p<span>.</span>stack<span>[</span><span>:</span>n<span>-</span><span>1</span><span>]</span>\n        <span>return</span> <span>true</span>\n    <span>}</span>\n\n    <span>if</span> n <span>>=</span> <span>2</span> <span>{</span>\n        re1 <span>:=</span> p<span>.</span>stack<span>[</span>n<span>-</span><span>1</span><span>]</span>\n        re2 <span>:=</span> p<span>.</span>stack<span>[</span>n<span>-</span><span>2</span><span>]</span>\n        <span>if</span> re2<span>.</span>Op <span>==</span> opVerticalBar <span>{</span>\n            <span>if</span> n <span>>=</span> <span>3</span> <span>{</span>\n                <span>// Now out of reach.</span>\n                <span>// Clean opportunistically.</span>\n                <span>cleanAlt</span><span>(</span>p<span>.</span>stack<span>[</span>n<span>-</span><span>3</span><span>]</span><span>)</span>\n            <span>}</span>\n            p<span>.</span>stack<span>[</span>n<span>-</span><span>2</span><span>]</span> <span>=</span> re1\n            p<span>.</span>stack<span>[</span>n<span>-</span><span>1</span><span>]</span> <span>=</span> re2\n            <span>return</span> <span>true</span>\n        <span>}</span>\n    <span>}</span>\n    <span>return</span> <span>false</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br></div></div><p>首先是第一个 <code>if</code> 分支。它检查的是栈顶的节点是不是字符类、选择操作 <code>|</code> 、字符类这样的结构。在类似的结构中，两个字符类可以被合并为一个。比如 <code>[a-z]|[0-9]</code> 可以变为 <code>[a-z0-9]</code> 。合并完之后，直接回收了栈顶的字符类节点，让选择操作的节点暴露了出来。</p>\n<p>再来看第二个 <code>if</code> 分支。如果栈顶节点是选择操作 <code>|</code> 、任意类型这样的结构，那么交换这两个节点的位置，并且返回 <code>true</code> 。如果此时栈中的节点数量达到了 3 ，还会顺手对栈顶第三个节点进行 <code>cleanAlt()</code> 。</p>\n<p>返回 <code>parseRightParen()</code> ，它丢弃了栈顶的选择操作 <code>|</code> 节点，然后调用了 <code>alternate()</code> 方法。</p>\n<div><pre><code><span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>alternate</span><span>(</span><span>)</span> <span>*</span>Regexp <span>{</span>\n    <span>// Scan down to find pseudo-operator (.</span>\n    <span>// There are no | above (.</span>\n    i <span>:=</span> <span>len</span><span>(</span>p<span>.</span>stack<span>)</span>\n    <span>for</span> i <span>></span> <span>0</span> <span>&amp;&amp;</span> p<span>.</span>stack<span>[</span>i<span>-</span><span>1</span><span>]</span><span>.</span>Op <span>&lt;</span> opPseudo <span>{</span>\n        i<span>--</span>\n    <span>}</span>\n    subs <span>:=</span> p<span>.</span>stack<span>[</span>i<span>:</span><span>]</span>\n    p<span>.</span>stack <span>=</span> p<span>.</span>stack<span>[</span><span>:</span>i<span>]</span>\n\n    <span>// Make sure top class is clean.</span>\n    <span>// All the others already are (see swapVerticalBar).</span>\n    <span>if</span> <span>len</span><span>(</span>subs<span>)</span> <span>></span> <span>0</span> <span>{</span>\n        <span>cleanAlt</span><span>(</span>subs<span>[</span><span>len</span><span>(</span>subs<span>)</span><span>-</span><span>1</span><span>]</span><span>)</span>\n    <span>}</span>\n\n    <span>// Empty alternate is special case</span>\n    <span>// (shouldn't happen but easy to handle).</span>\n    <span>if</span> <span>len</span><span>(</span>subs<span>)</span> <span>==</span> <span>0</span> <span>{</span>\n        <span>return</span> p<span>.</span><span>push</span><span>(</span>p<span>.</span><span>newRegexp</span><span>(</span>OpNoMatch<span>)</span><span>)</span>\n    <span>}</span>\n\n    <span>return</span> p<span>.</span><span>push</span><span>(</span>p<span>.</span><span>collapse</span><span>(</span>subs<span>,</span> OpAlternate<span>)</span><span>)</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br></div></div><p>嗯，不长。 <code>alternate()</code> 的第一个 <code>for</code> 循环会向前寻找遇到的第一个 <code>(</code> 或者栈底。根据注释，在第一个 <code>(</code> 或栈底之后不会有 <code>|</code> 节点。现在还看不出来为什么能这样保证。</p>\n<p>然后对栈顶节点进行了 <code>cleanAlt()</code> ，并且根据注释，其他的节点都进行过 <code>cleanAlt()</code> 了。同样，现在还看不出来为什么能这样保证。</p>\n<p>最后，处理了空选择的特殊情况。然后使用 <code>collapse()</code> 方法对找到的所有选项进行了合并。</p>\n<p>回到 <code>parseRightParen()</code> ，进行了以上处理之后，它先检查了一下栈中节点的数量是否达到了 2 ，然后弹出了栈顶的两个节点。如果第二个节点不是左括号将会产生错误。</p>\n<p>括号在正则表达式中的另一个作用是捕获。因此接下来检查了 <code>re2.Cap</code> 的值。注意，括号中的内容放在 <code>re1</code> 中， <code>re2</code> 是 <code>(</code> 。 <code>Cap</code> 具体怎么样记录，目前还不清楚，注释里说它是捕获索引。</p>\n<p>不论如何， <code>re2.Cap == 0</code> 时，只把 <code>re1</code> 压回了栈中。否则，会把 <code>re2</code> 当场重新利用，改成一个 <code>OpCapture</code> 节点，然后令 <code>re1</code> 作为它唯一的子节点，最后把 <code>re2</code> 压回栈中。</p>\n<p>这样一来终于看完了括号的处理，但是疑问更多了。</p>\n<h2 id=\"选择\"> 选择</h2>\n<p>选择符号 <code>|</code> 也是很复杂的，它通过 <code>parseVerticalBar()</code> 进行处理。</p>\n<div><pre><code><span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>parseVerticalBar</span><span>(</span><span>)</span> <span>error</span> <span>{</span>\n    p<span>.</span><span>concat</span><span>(</span><span>)</span>\n\n    <span>// The concatenation we just parsed is on top of the stack.</span>\n    <span>// If it sits above an opVerticalBar, swap it below</span>\n    <span>// (things below an opVerticalBar become an alternation).</span>\n    <span>// Otherwise, push a new vertical bar.</span>\n    <span>if</span> <span>!</span>p<span>.</span><span>swapVerticalBar</span><span>(</span><span>)</span> <span>{</span>\n        p<span>.</span><span>op</span><span>(</span>opVerticalBar<span>)</span>\n    <span>}</span>\n\n    <span>return</span> <span>nil</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br></div></div><p><code>parseVerticalBar()</code> 一上来首先进行了 <code>concat()</code> ，把最后一个 <code>(</code> 或者 <code>|</code> 之后的所有节点连接在了一起。然后，又进行了 <code>swapVerticalBar()</code> 操作，如果没能把 <code>|</code> 交换到栈顶，那么手动插入一个 <code>opVerticalBar</code> 类型的节点。</p>\n<p>现在感觉稍微有点明白了。举个例子来说，正则表达式 <code>A|B|C</code> ，解析过程中栈中的内容应该是：</p>\n<div><pre><code>A - B - | - C\n</code></pre>\n<div><span>1</span><br></div></div><p>最后一个 <code>C</code> 代表当前正在处理的部分，可能还有其他字符连接在它后面，比如 <code>A|B|CD</code> 。当确认没有其他字符之后，应该会调用 <code>swapVerticalBar()</code> 将 <code>|</code> 交换出来。</p>\n<div><pre><code>A - B - C - |\n</code></pre>\n<div><span>1</span><br></div></div><p><code>|</code> 代表之前的所有节点都应该选择到一起。目前只是推测，继续往下看了。</p>\n<h2 id=\"起始符和终止符\"> 起始符和终止符</h2>\n<p>起始符指的是 <code>^</code> ，它匹配的是文本的开始。终止符指的是 <code>$</code> ，它匹配的时文本的结束。</p>\n<div><pre><code>        <span>case</span> <span>'^'</span><span>:</span>\n            <span>if</span> p<span>.</span>flags<span>&amp;</span>OneLine <span>!=</span> <span>0</span> <span>{</span>\n                p<span>.</span><span>op</span><span>(</span>OpBeginText<span>)</span>\n            <span>}</span> <span>else</span> <span>{</span>\n                p<span>.</span><span>op</span><span>(</span>OpBeginLine<span>)</span>\n            <span>}</span>\n            t <span>=</span> t<span>[</span><span>1</span><span>:</span><span>]</span>\n        <span>case</span> <span>'$'</span><span>:</span>\n            <span>if</span> p<span>.</span>flags<span>&amp;</span>OneLine <span>!=</span> <span>0</span> <span>{</span>\n                p<span>.</span><span>op</span><span>(</span>OpEndText<span>)</span><span>.</span>Flags <span>|=</span> WasDollar\n            <span>}</span> <span>else</span> <span>{</span>\n                p<span>.</span><span>op</span><span>(</span>OpEndLine<span>)</span>\n            <span>}</span>\n            t <span>=</span> t<span>[</span><span>1</span><span>:</span><span>]</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br></div></div><p>是否开始 <code>OneLine</code> 模式对于起始符的匹配有一些影响。然而 tokenizer 不太关心这些东西。</p>\n<h2 id=\"通配符\"> 通配符</h2>\n<p>通配符 <code>.</code> 能够匹配任意字符。</p>\n<div><pre><code>        <span>case</span> <span>'.'</span><span>:</span>\n            <span>if</span> p<span>.</span>flags<span>&amp;</span>DotNL <span>!=</span> <span>0</span> <span>{</span>\n                p<span>.</span><span>op</span><span>(</span>OpAnyChar<span>)</span>\n            <span>}</span> <span>else</span> <span>{</span>\n                p<span>.</span><span>op</span><span>(</span>OpAnyCharNotNL<span>)</span>\n            <span>}</span>\n            t <span>=</span> t<span>[</span><span>1</span><span>:</span><span>]</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></div></div><p><code>.</code> 一般来说匹配的是除了 <code>\\n</code> 之外的所有字符。如果打开了某些 flag ，就可以令它匹配任意字符。</p>\n<h2 id=\"字符类\"> 字符类</h2>\n<p>字符类指的是 <code>[]</code> 包裹的内容，代表其中的任何一个字符。</p>\n<div><pre><code>        <span>case</span> <span>'['</span><span>:</span>\n            <span>if</span> t<span>,</span> err <span>=</span> p<span>.</span><span>parseClass</span><span>(</span>t<span>)</span><span>;</span> err <span>!=</span> <span>nil</span> <span>{</span>\n                <span>return</span> <span>nil</span><span>,</span> err\n            <span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></div></div><p><code>[]</code> 其实还挺复杂的，所以单独写了一个方法对其进行解析。</p>\n<div><pre><code><span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>parseClass</span><span>(</span>s <span>string</span><span>)</span> <span>(</span>rest <span>string</span><span>,</span> err <span>error</span><span>)</span> <span>{</span>\n    t <span>:=</span> s<span>[</span><span>1</span><span>:</span><span>]</span> <span>// chop [</span>\n    re <span>:=</span> p<span>.</span><span>newRegexp</span><span>(</span>OpCharClass<span>)</span>\n    re<span>.</span>Flags <span>=</span> p<span>.</span>flags\n    re<span>.</span>Rune <span>=</span> re<span>.</span>Rune0<span>[</span><span>:</span><span>0</span><span>]</span>\n\n    sign <span>:=</span> <span>+</span><span>1</span>\n    <span>if</span> t <span>!=</span> <span>\"\"</span> <span>&amp;&amp;</span> t<span>[</span><span>0</span><span>]</span> <span>==</span> <span>'^'</span> <span>{</span>\n        sign <span>=</span> <span>-</span><span>1</span>\n        t <span>=</span> t<span>[</span><span>1</span><span>:</span><span>]</span>\n\n        <span>// If character class does not match \\n, add it here,</span>\n        <span>// so that negation later will do the right thing.</span>\n        <span>if</span> p<span>.</span>flags<span>&amp;</span>ClassNL <span>==</span> <span>0</span> <span>{</span>\n            re<span>.</span>Rune <span>=</span> <span>append</span><span>(</span>re<span>.</span>Rune<span>,</span> <span>'\\n'</span><span>,</span> <span>'\\n'</span><span>)</span>\n        <span>}</span>\n    <span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br></div></div><p>首先去掉了开头的 <code>[</code> ，创建了一个新节点，然后开始分析字符类中的内容。然后， <code>parseClass()</code> 判断了 <code>[]</code> 中的第一个字符是否是 <code>^</code> 。否定字符类匹配的是除了类中字符的任意一个字符。注意，在 <code>POSIX</code> 模式下， <code>[^a]</code> 这种否定字符类，与 <code>.</code> 类似，是不能匹配 <code>\\n</code> 的。</p>\n<div><pre><code>    class <span>:=</span> re<span>.</span>Rune\n    first <span>:=</span> <span>true</span> <span>// ] and - are okay as first char in class</span>\n    <span>for</span> t <span>==</span> <span>\"\"</span> <span>||</span> t<span>[</span><span>0</span><span>]</span> <span>!=</span> <span>']'</span> <span>||</span> first <span>{</span>\n        <span>// POSIX: - is only okay unescaped as first or last in class.</span>\n        <span>// Perl: - is okay anywhere.</span>\n        <span>if</span> t <span>!=</span> <span>\"\"</span> <span>&amp;&amp;</span> t<span>[</span><span>0</span><span>]</span> <span>==</span> <span>'-'</span> <span>&amp;&amp;</span> p<span>.</span>flags<span>&amp;</span>PerlX <span>==</span> <span>0</span> <span>&amp;&amp;</span> <span>!</span>first <span>&amp;&amp;</span> <span>(</span><span>len</span><span>(</span>t<span>)</span> <span>==</span> <span>1</span> <span>||</span> t<span>[</span><span>1</span><span>]</span> <span>!=</span> <span>']'</span><span>)</span> <span>{</span>\n            <span>_</span><span>,</span> size <span>:=</span> utf8<span>.</span><span>DecodeRuneInString</span><span>(</span>t<span>[</span><span>1</span><span>:</span><span>]</span><span>)</span>\n            <span>return</span> <span>\"\"</span><span>,</span> <span>&amp;</span>Error<span>{</span>Code<span>:</span> ErrInvalidCharRange<span>,</span> Expr<span>:</span> t<span>[</span><span>:</span><span>1</span><span>+</span>size<span>]</span><span>}</span>\n        <span>}</span>\n        first <span>=</span> <span>false</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br></div></div><p><code>-</code> 在字符类中有特殊的作用，因此需要使用 <code>\\</code> 逃逸符来转义。但是有一种特殊情况，如果把 <code>-</code> 放在字符类中第一个，或者最后一个，那么就可以不使用 <code>\\</code> 。</p>\n<p>另外，还有一个特殊情况，那就是 <code>[]]</code> 是合法的字符类。匹配的是 <code>]</code> 这个字符。注意 <code>]</code> 一定要紧邻在 <code>[</code> 之后。也就是说 <code>[]abcd]</code> 是一个字符类，而 <code>[ab]cd]</code> 的意思是字符类 <code>[ab]</code> 后面连接 <code>cd]</code> 。</p>\n<p>第一次迭代时，因为 <code>first == ture</code> ，所以 <code>if</code> 中的逻辑不会执行。之后的迭代中，如果当前的字符是 <code>-</code> ，而且：</p>\n<ol>\n<li>后面没有字符了，比如 <code>[a-</code> ，这时， <code>parseClass()</code> 会产生错误。</li>\n<li>后面不是 <code>]</code> ，比如 <code>[a-b-c]</code> 中的第二个 <code>-</code> 。这时，如果是 POSIX 模式，那么会产生错误。否则，会把这个 <code>-</code> 理解成字面的 <code>-</code> 。</li>\n</ol>\n<div><pre><code>        <span>// Look for POSIX [:alnum:] etc.</span>\n        <span>if</span> <span>len</span><span>(</span>t<span>)</span> <span>></span> <span>2</span> <span>&amp;&amp;</span> t<span>[</span><span>0</span><span>]</span> <span>==</span> <span>'['</span> <span>&amp;&amp;</span> t<span>[</span><span>1</span><span>]</span> <span>==</span> <span>':'</span> <span>{</span>\n            nclass<span>,</span> nt<span>,</span> err <span>:=</span> p<span>.</span><span>parseNamedClass</span><span>(</span>t<span>,</span> class<span>)</span>\n            <span>if</span> err <span>!=</span> <span>nil</span> <span>{</span>\n                <span>return</span> <span>\"\"</span><span>,</span> err\n            <span>}</span>\n            <span>if</span> nclass <span>!=</span> <span>nil</span> <span>{</span>\n                class<span>,</span> t <span>=</span> nclass<span>,</span> nt\n                <span>continue</span>\n            <span>}</span>\n        <span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br></div></div><p>这个分支，解决的是 POSIX 提供的一些字符类。</p>\n<div><pre><code>[[:alnum:]]    alphanumeric (== [0-9A-Za-z])\n[[:alpha:]]    alphabetic (== [A-Za-z])\n[[:ascii:]]    ASCII (== [\\x00-\\x7F])\n[[:blank:]]    blank (== [\\t ])\n[[:cntrl:]]    control (== [\\x00-\\x1F\\x7F])\n[[:digit:]]    digits (== [0-9])\n[[:graph:]]    graphical (== [!-~] == [A-Za-z0-9!&quot;#$%&amp;&#39;()*+,\\-./:;&lt;=&gt;?@[\\\\\\]^_`{|}~])\n[[:lower:]]    lower case (== [a-z])\n[[:print:]]    printable (== [ -~] == [ [:graph:]])\n[[:punct:]]    punctuation (== [!-/:-@[-`{-~])\n[[:space:]]    whitespace (== [\\t\\n\\v\\f\\r ])\n[[:upper:]]    upper case (== [A-Z])\n[[:word:]]     word characters (== [0-9A-Za-z_])\n[[:xdigit:]]   hex digit (== [0-9A-Fa-f])\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br></div></div><p><code>parseNamedClass()</code> 解决了这些命名字符类，不贴代码了。回到 <code>parseClass()</code> ，后面判断了 Unicode 字符类。</p>\n<div><pre><code>        <span>// Look for Unicode character group like \\p{Han}.</span>\n        nclass<span>,</span> nt<span>,</span> err <span>:=</span> p<span>.</span><span>parseUnicodeClass</span><span>(</span>t<span>,</span> class<span>)</span>\n        <span>if</span> err <span>!=</span> <span>nil</span> <span>{</span>\n            <span>return</span> <span>\"\"</span><span>,</span> err\n        <span>}</span>\n        <span>if</span> nclass <span>!=</span> <span>nil</span> <span>{</span>\n            class<span>,</span> t <span>=</span> nclass<span>,</span> nt\n            <span>continue</span>\n        <span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></div></div><p>接下来是 Perl 字符类。 POSIX 应该也支持，因为这里没有判断 flag 就进去了。</p>\n<div><pre><code>        <span>// Single character or simple range.</span>\n        rng <span>:=</span> t\n        <span>var</span> lo<span>,</span> hi <span>rune</span>\n        <span>if</span> lo<span>,</span> t<span>,</span> err <span>=</span> p<span>.</span><span>parseClassChar</span><span>(</span>t<span>,</span> s<span>)</span><span>;</span> err <span>!=</span> <span>nil</span> <span>{</span>\n            <span>return</span> <span>\"\"</span><span>,</span> err\n        <span>}</span>\n        hi <span>=</span> lo\n        <span>// [a-] means (a|-) so check for final ].</span>\n        <span>if</span> <span>len</span><span>(</span>t<span>)</span> <span>>=</span> <span>2</span> <span>&amp;&amp;</span> t<span>[</span><span>0</span><span>]</span> <span>==</span> <span>'-'</span> <span>&amp;&amp;</span> t<span>[</span><span>1</span><span>]</span> <span>!=</span> <span>']'</span> <span>{</span>\n            t <span>=</span> t<span>[</span><span>1</span><span>:</span><span>]</span>\n            <span>if</span> hi<span>,</span> t<span>,</span> err <span>=</span> p<span>.</span><span>parseClassChar</span><span>(</span>t<span>,</span> s<span>)</span><span>;</span> err <span>!=</span> <span>nil</span> <span>{</span>\n                <span>return</span> <span>\"\"</span><span>,</span> err\n            <span>}</span>\n            <span>if</span> hi <span>&lt;</span> lo <span>{</span>\n                rng <span>=</span> rng<span>[</span><span>:</span><span>len</span><span>(</span>rng<span>)</span><span>-</span><span>len</span><span>(</span>t<span>)</span><span>]</span>\n                <span>return</span> <span>\"\"</span><span>,</span> <span>&amp;</span>Error<span>{</span>Code<span>:</span> ErrInvalidCharRange<span>,</span> Expr<span>:</span> rng<span>}</span>\n            <span>}</span>\n        <span>}</span>\n        <span>if</span> p<span>.</span>flags<span>&amp;</span>FoldCase <span>==</span> <span>0</span> <span>{</span>\n            class <span>=</span> <span>appendRange</span><span>(</span>class<span>,</span> lo<span>,</span> hi<span>)</span>\n        <span>}</span> <span>else</span> <span>{</span>\n            class <span>=</span> <span>appendFoldedRange</span><span>(</span>class<span>,</span> lo<span>,</span> hi<span>)</span>\n        <span>}</span>\n    <span>}</span>\n    t <span>=</span> t<span>[</span><span>1</span><span>:</span><span>]</span> <span>// chop ]</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br></div></div><p>最后的问题就简单了，判断了 <code>a-b</code> 这类情况。特别提一下 <code>parseClassChar()</code> ，它从正则表达式中读取一个字符，并且处理了转义的情况。</p>\n<div><pre><code><span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>parseClassChar</span><span>(</span>s<span>,</span> wholeClass <span>string</span><span>)</span> <span>(</span>r <span>rune</span><span>,</span> rest <span>string</span><span>,</span> err <span>error</span><span>)</span> <span>{</span>\n    <span>if</span> s <span>==</span> <span>\"\"</span> <span>{</span>\n        <span>return</span> <span>0</span><span>,</span> <span>\"\"</span><span>,</span> <span>&amp;</span>Error<span>{</span>Code<span>:</span> ErrMissingBracket<span>,</span> Expr<span>:</span> wholeClass<span>}</span>\n    <span>}</span>\n\n    <span>// Allow regular escape sequences even though</span>\n    <span>// many need not be escaped in this context.</span>\n    <span>if</span> s<span>[</span><span>0</span><span>]</span> <span>==</span> <span>'\\\\'</span> <span>{</span>\n        <span>return</span> p<span>.</span><span>parseEscape</span><span>(</span>s<span>)</span>\n    <span>}</span>\n\n    <span>return</span> <span>nextRune</span><span>(</span>s<span>)</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br></div></div><p><code>parseEscape()</code> 也很长，处理了转义的问题，不过逻辑很简单，就不细看了。</p>\n<div><pre><code>    <span>// Use &amp;re.Rune instead of &amp;class to avoid allocation.</span>\n    re<span>.</span>Rune <span>=</span> class\n    class <span>=</span> <span>cleanClass</span><span>(</span><span>&amp;</span>re<span>.</span>Rune<span>)</span>\n    <span>if</span> sign <span>&lt;</span> <span>0</span> <span>{</span>\n        class <span>=</span> <span>negateClass</span><span>(</span>class<span>)</span>\n    <span>}</span>\n    re<span>.</span>Rune <span>=</span> class\n    p<span>.</span><span>push</span><span>(</span>re<span>)</span>\n    <span>return</span> t<span>,</span> <span>nil</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br></div></div><p>最后，给字符类清理一下，然后处理否定字符类的情况，返回。</p>\n<h2 id=\"重复\"> 重复</h2>\n<p>重复有 <code>*</code> 、 <code>+</code> 、 <code>?</code> 三个，这里把它们放在一块处理。</p>\n<div><pre><code>        <span>case</span> <span>'*'</span><span>,</span> <span>'+'</span><span>,</span> <span>'?'</span><span>:</span>\n            before <span>:=</span> t\n            <span>switch</span> t<span>[</span><span>0</span><span>]</span> <span>{</span>\n            <span>case</span> <span>'*'</span><span>:</span>\n                op <span>=</span> OpStar\n            <span>case</span> <span>'+'</span><span>:</span>\n                op <span>=</span> OpPlus\n            <span>case</span> <span>'?'</span><span>:</span>\n                op <span>=</span> OpQuest\n            <span>}</span>\n            after <span>:=</span> t<span>[</span><span>1</span><span>:</span><span>]</span>\n            <span>if</span> after<span>,</span> err <span>=</span> p<span>.</span><span>repeat</span><span>(</span>op<span>,</span> <span>0</span><span>,</span> <span>0</span><span>,</span> before<span>,</span> after<span>,</span> lastRepeat<span>)</span><span>;</span> err <span>!=</span> <span>nil</span> <span>{</span>\n                <span>return</span> <span>nil</span><span>,</span> err\n            <span>}</span>\n            repeat <span>=</span> before\n            t <span>=</span> after\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br></div></div><p>这里把处理之前的 <code>t</code> 保存到了 <code>repeat</code> 中，知识点，记一下。主要的处理过程是在 <code>repeat()</code> 方法中实现的。</p>\n<div><pre><code><span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>repeat</span><span>(</span>op Op<span>,</span> min<span>,</span> max <span>int</span><span>,</span> before<span>,</span> after<span>,</span> lastRepeat <span>string</span><span>)</span> <span>(</span><span>string</span><span>,</span> <span>error</span><span>)</span> <span>{</span>\n    flags <span>:=</span> p<span>.</span>flags\n\n    <span>// Perl-related code was removed</span>\n\n    n <span>:=</span> <span>len</span><span>(</span>p<span>.</span>stack<span>)</span>\n    <span>if</span> n <span>==</span> <span>0</span> <span>{</span>\n        <span>return</span> <span>\"\"</span><span>,</span> <span>&amp;</span>Error<span>{</span>ErrMissingRepeatArgument<span>,</span> before<span>[</span><span>:</span><span>len</span><span>(</span>before<span>)</span><span>-</span><span>len</span><span>(</span>after<span>)</span><span>]</span><span>}</span>\n    <span>}</span>\n    sub <span>:=</span> p<span>.</span>stack<span>[</span>n<span>-</span><span>1</span><span>]</span>\n    <span>if</span> sub<span>.</span>Op <span>>=</span> opPseudo <span>{</span>\n        <span>return</span> <span>\"\"</span><span>,</span> <span>&amp;</span>Error<span>{</span>ErrMissingRepeatArgument<span>,</span> before<span>[</span><span>:</span><span>len</span><span>(</span>before<span>)</span><span>-</span><span>len</span><span>(</span>after<span>)</span><span>]</span><span>}</span>\n    <span>}</span>\n\n    re <span>:=</span> p<span>.</span><span>newRegexp</span><span>(</span>op<span>)</span>\n    re<span>.</span>Min <span>=</span> min\n    re<span>.</span>Max <span>=</span> max\n    re<span>.</span>Flags <span>=</span> flags\n    re<span>.</span>Sub <span>=</span> re<span>.</span>Sub0<span>[</span><span>:</span><span>1</span><span>]</span>\n    re<span>.</span>Sub<span>[</span><span>0</span><span>]</span> <span>=</span> sub\n    p<span>.</span>stack<span>[</span>n<span>-</span><span>1</span><span>]</span> <span>=</span> re\n\n    <span>if</span> op <span>==</span> OpRepeat <span>&amp;&amp;</span> <span>(</span>min <span>>=</span> <span>2</span> <span>||</span> max <span>>=</span> <span>2</span><span>)</span> <span>&amp;&amp;</span> <span>!</span><span>repeatIsValid</span><span>(</span>re<span>,</span> <span>1000</span><span>)</span> <span>{</span>\n        <span>return</span> <span>\"\"</span><span>,</span> <span>&amp;</span>Error<span>{</span>ErrInvalidRepeatSize<span>,</span> before<span>[</span><span>:</span><span>len</span><span>(</span>before<span>)</span><span>-</span><span>len</span><span>(</span>after<span>)</span><span>]</span><span>}</span>\n    <span>}</span>\n\n    <span>return</span> after<span>,</span> <span>nil</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br></div></div><p>一开始 <code>repeat()</code> 检查了两种情况，第一个是 <code>*ab</code> ，第二个是 <code>a|*</code> 或者 <code>a(*b)</code> 。通过测试之后， <code>repeat()</code> 创建了一个新的节点。</p>\n<p>疑惑更多了，比如，<code>x*?</code> 可以代表非贪婪的匹配，这里似乎没有进行处理。</p>\n<h2 id=\"固定次数的重复\"> 固定次数的重复</h2>\n<div><pre><code>        <span>case</span> <span>'{'</span><span>:</span>\n            op <span>=</span> OpRepeat\n            before <span>:=</span> t\n            min<span>,</span> max<span>,</span> after<span>,</span> ok <span>:=</span> p<span>.</span><span>parseRepeat</span><span>(</span>t<span>)</span>\n            <span>if</span> <span>!</span>ok <span>{</span>\n                <span>// If the repeat cannot be parsed, { is a literal.</span>\n                p<span>.</span><span>literal</span><span>(</span><span>'{'</span><span>)</span>\n                t <span>=</span> t<span>[</span><span>1</span><span>:</span><span>]</span>\n                <span>break</span>\n            <span>}</span>\n            <span>if</span> min <span>&lt;</span> <span>0</span> <span>||</span> min <span>></span> <span>1000</span> <span>||</span> max <span>></span> <span>1000</span> <span>||</span> max <span>>=</span> <span>0</span> <span>&amp;&amp;</span> min <span>></span> max <span>{</span>\n                <span>// Numbers were too big, or max is present and min > max.</span>\n                <span>return</span> <span>nil</span><span>,</span> <span>&amp;</span>Error<span>{</span>ErrInvalidRepeatSize<span>,</span> before<span>[</span><span>:</span><span>len</span><span>(</span>before<span>)</span><span>-</span><span>len</span><span>(</span>after<span>)</span><span>]</span><span>}</span>\n            <span>}</span>\n            <span>if</span> after<span>,</span> err <span>=</span> p<span>.</span><span>repeat</span><span>(</span>op<span>,</span> min<span>,</span> max<span>,</span> before<span>,</span> after<span>,</span> lastRepeat<span>)</span><span>;</span> err <span>!=</span> <span>nil</span> <span>{</span>\n                <span>return</span> <span>nil</span><span>,</span> err\n            <span>}</span>\n            repeat <span>=</span> before\n            t <span>=</span> after\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br></div></div><p>固定次数的重复指的是 <code>x{5,8}</code> 这种类型的重复，处理逻辑也不复杂，不多说了。</p>\n<h2 id=\"转义\"> 转义</h2>\n<div><pre><code>        <span>case</span> <span>'\\\\'</span><span>:</span>\n\n            <span>// Perl-related code was removed</span>\n\n            re <span>:=</span> p<span>.</span><span>newRegexp</span><span>(</span>OpCharClass<span>)</span>\n            re<span>.</span>Flags <span>=</span> p<span>.</span>flags\n\n            <span>// Look for Unicode character group like \\p{Han}</span>\n            <span>if</span> <span>len</span><span>(</span>t<span>)</span> <span>>=</span> <span>2</span> <span>&amp;&amp;</span> <span>(</span>t<span>[</span><span>1</span><span>]</span> <span>==</span> <span>'p'</span> <span>||</span> t<span>[</span><span>1</span><span>]</span> <span>==</span> <span>'P'</span><span>)</span> <span>{</span>\n                r<span>,</span> rest<span>,</span> err <span>:=</span> p<span>.</span><span>parseUnicodeClass</span><span>(</span>t<span>,</span> re<span>.</span>Rune0<span>[</span><span>:</span><span>0</span><span>]</span><span>)</span>\n                <span>if</span> err <span>!=</span> <span>nil</span> <span>{</span>\n                    <span>return</span> <span>nil</span><span>,</span> err\n                <span>}</span>\n                <span>if</span> r <span>!=</span> <span>nil</span> <span>{</span>\n                    re<span>.</span>Rune <span>=</span> r\n                    t <span>=</span> rest\n                    p<span>.</span><span>push</span><span>(</span>re<span>)</span>\n                    <span>break</span> BigSwitch\n                <span>}</span>\n            <span>}</span>\n\n            <span>// Perl character class escape.</span>\n            <span>if</span> r<span>,</span> rest <span>:=</span> p<span>.</span><span>parsePerlClassEscape</span><span>(</span>t<span>,</span> re<span>.</span>Rune0<span>[</span><span>:</span><span>0</span><span>]</span><span>)</span><span>;</span> r <span>!=</span> <span>nil</span> <span>{</span>\n                re<span>.</span>Rune <span>=</span> r\n                t <span>=</span> rest\n                p<span>.</span><span>push</span><span>(</span>re<span>)</span>\n                <span>break</span> BigSwitch\n            <span>}</span>\n            p<span>.</span><span>reuse</span><span>(</span>re<span>)</span>\n\n            <span>// Ordinary single-character escape.</span>\n            <span>if</span> c<span>,</span> t<span>,</span> err <span>=</span> p<span>.</span><span>parseEscape</span><span>(</span>t<span>)</span><span>;</span> err <span>!=</span> <span>nil</span> <span>{</span>\n                <span>return</span> <span>nil</span><span>,</span> err\n            <span>}</span>\n            p<span>.</span><span>literal</span><span>(</span>c<span>)</span>\n        <span>}</span>\n        lastRepeat <span>=</span> repeat\n    <span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br></div></div><p>这部分逻辑也很简单，不提了。</p>\n<h2 id=\"最后\"> 最后</h2>\n<div><pre><code>    p<span>.</span><span>concat</span><span>(</span><span>)</span>\n    <span>if</span> p<span>.</span><span>swapVerticalBar</span><span>(</span><span>)</span> <span>{</span>\n        <span>// pop vertical bar</span>\n        p<span>.</span>stack <span>=</span> p<span>.</span>stack<span>[</span><span>:</span><span>len</span><span>(</span>p<span>.</span>stack<span>)</span><span>-</span><span>1</span><span>]</span>\n    <span>}</span>\n    p<span>.</span><span>alternate</span><span>(</span><span>)</span>\n\n    n <span>:=</span> <span>len</span><span>(</span>p<span>.</span>stack<span>)</span>\n    <span>if</span> n <span>!=</span> <span>1</span> <span>{</span>\n        <span>return</span> <span>nil</span><span>,</span> <span>&amp;</span>Error<span>{</span>ErrMissingParen<span>,</span> s<span>}</span>\n    <span>}</span>\n    <span>return</span> p<span>.</span>stack<span>[</span><span>0</span><span>]</span><span>,</span> <span>nil</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br></div></div><p>最后，把栈中剩余的东西处理处理，返回结果。</p>\n<p>到这里， <code>Parse()</code> 终于结束了，是时候理一理思路了。</p>\n",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": [
        "编译器"
      ]
    },
    {
      "title": "算法导论11 哈希表",
      "url": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/11%20%E5%93%88%E5%B8%8C%E8%A1%A8/",
      "id": "https://flyginger.top/note/%E7%AE%97%E6%B3%95%E5%AF%BC%E8%AE%BA/doc/11%20%E5%93%88%E5%B8%8C%E8%A1%A8/",
      "content_html": "<h1 id=\"算法导论11-哈希表\"> 算法导论11 哈希表</h1>\n<p>很多应用需要一种只支持 <code>INSERT</code>、<code>SEARCH</code>、<code>DELETE</code> 即可的动态集合。<strong>哈希表</strong>（hashing table）是能够高效实现这种动态集合的数据结构，类似的动态集合通常被称为<strong>字典</strong>（dictionary）。一般认为哈希表中搜索的平均情况运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span></span>。</p>\n<h2 id=\"_11-1-直接寻址\"> 11.1 直接寻址</h2>\n<p>当键的全集 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.10903em;\">U</span></span></span></span> 不大时，<strong>直接寻址</strong>（direct-address）法是一个简单实用的方法。假设 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.10903em;\">U</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>{</span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>}</span></span></span></span> 中， <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 不太大，并且任意两个元素的键不相同。</p>\n<p>可以使用一个数组来表示这个动态集合，该数组也被称为<strong>直接寻址表</strong>（direct-address table），记为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>[</span><span>0..</span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>]</span></span></span></span>。表中的每个<strong>槽</strong>（slot）对应 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.10903em;\">U</span></span></span></span> 中的一个键。</p>\n<div><pre><code>DIRECT-ADDRESS-SEARCH(T, k)\n  return T[k]\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><div><pre><code>DIRECT-ADDRESS-INSERT(T, x)\n  T[x.key] = x\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><div><pre><code>DIRECT-ADDRESS-DELETE(T, x)\n  T[x.key] = nil\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>每种操作都只花费 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span></span> 时间。</p>\n<h2 id=\"_11-2-哈希表\"> 11.2 哈希表</h2>\n<p>上述方法的缺点也十分明显，当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.10903em;\">U</span></span></span></span> 很大时，存储一个大小为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>∣</span><span style=\"margin-right:0.10903em;\">U</span><span>∣</span></span></span></span> 的表 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.13889em;\">T</span></span></span></span> 是不实际的。实际存储的键构成的集合 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.07153em;\">K</span></span></span></span> 可能远远小于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.10903em;\">U</span></span></span></span>，导致 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.13889em;\">T</span></span></span></span> 中大量的空间被浪费了。</p>\n<p>当使用直接寻址表时，键为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 的元素会被存储在槽 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 中。而使用哈希表时，键为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 的元素会被储存在槽 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span></span></span></span> 中。<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span> 就是哈希函数，用于计算键 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 对应的槽。也就是说，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span> 需要把全集 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.10903em;\">U</span></span></span></span> 映射到哈希表 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>[</span><span>0..</span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>]</span></span></span></span> 的槽上：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>:</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.10903em;\">U</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>→</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>{</span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>}</span></span></span></span></span></p>\n<p>通常，哈希表的大小 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 远小于全集的大小 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>∣</span><span style=\"margin-right:0.10903em;\">U</span><span>∣</span></span></span></span>。</p>\n<p>当两个键被哈希到一个槽中时，就发生了<strong>碰撞</strong>（collision）。一般从两个方向处理这种情况，其一是直接处理碰撞，其二是避免发生碰撞。</p>\n<h3 id=\"使用链表解决碰撞\"> 使用链表解决碰撞</h3>\n<p>在这种方法中，哈希表把哈希到同一个槽中的元素以链表的形式保存起来。</p>\n<div><pre><code>CHAINED-HASH-SEARCH(T, k)\n  在链表 T[h(k)] 中搜索键为 k 的元素\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><div><pre><code>CHAINED-HASH-INSERT(T, x)\n  把 x 插入到链表 T[h(x.key)] 的头部\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><div><pre><code>CHAINED-HASH-DELETE(T, x)\n  从链表 T[h(x.key)] 中删除 x\n</code></pre>\n<div><span>1</span><br><span>2</span><br></div></div><p>插入操作的最坏情况运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span></span>，然而这是以 <code>x</code> 不在哈希表中为前提的。如果插入前需要检查一遍哈希表中是否已经存有 <code>x</code>，那么就要先执行一次搜索。搜索的最坏情况运行时间与链表的长度成正比。如果使用双向链表，那么删除的最坏情况运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span></span>。这是因为 <code>x</code> 中已经存有链表前一个节点和后一个节点的信息，不需要搜索。</p>\n<h3 id=\"分析使用链表的哈希表\"> 分析使用链表的哈希表</h3>\n<p>假设哈希表 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.13889em;\">T</span></span></span></span> 有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 个槽，存储了 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个元素，定义 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.13889em;\">T</span></span></span></span> 的<strong>装载因子</strong>（load factor）<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.0037em;\">α</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/</span><span>m</span></span></span></span>。装载因子可以理解为哈希表中链表的平均长度。</p>\n<p>在最坏情况下，所有的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个键全部被哈希到同一个槽中，此时搜索的最坏情况运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span>。</p>\n<p>而平均情况运行时间取决于哈希函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span> 的表现。后续章节会详细讨论这个问题，现在可以假定任意键哈希到 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 个槽中的每个槽的概率是相等的，且与其他键的哈希结果无关，这种假设也被称为<strong>简单均匀哈希</strong>（simple uniform hashing）假设：</p>\n<p>对于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.05724em;\">j</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8388800000000001em;vertical-align:-0.19444em;\"></span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>，把链表 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>[</span><span style=\"margin-right:0.05724em;\">j</span><span>]</span></span></span></span> 的长度记为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>，可得 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>⋯</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.638891em;vertical-align:-0.208331em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>m</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span>，且有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span>n</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.0037em;\">α</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/</span><span>m</span></span></span></span>。</p>\n<p>假设计算 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span></span></span></span> 只需要 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span></span> 的时间，接下来需要在链表 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span>[</span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)]</span></span></span></span> 上搜索。有两种结果，第一是没有搜素到键为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 的元素（失败），第二是搜索到了该元素（成功）。</p>\n<h3 id=\"定理-11-1\"> 定理 11.1</h3>\n<p>在使用链表解决碰撞的哈希表中，假设使用简单均匀哈希，那么失败的搜索花费 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.0037em;\">α</span><span>)</span></span></span></span> 的平均情况运行时间。</p>\n<h3 id=\"定理-11-2\"> 定理 11.2</h3>\n<p>在使用链表解决碰撞的哈希表中，假设使用简单均匀哈希，那么成功的搜索花费 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.0037em;\">α</span><span>)</span></span></span></span> 的平均情况运行时间。</p>\n<p>定理 11.1 很好理解，接下来主要证明一下定理 11.2。为了从链表中找到 <code>x</code>，算法需要把 <code>x</code> 以及 <code>x</code> 之前的元素全部遍历一次。而上文中提到，向哈希表中插入元素时，元素会被放在对应槽的链表头部。所以下面要计算的就是有多少元素在 <code>x</code> 之后被插入了 <code>x</code> 所在的槽。</p>\n<p>假设 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>x</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span> 个被插入哈希表中的元素，其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8388800000000001em;vertical-align:-0.19444em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>2</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>n</span></span></span></span>，令 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span>x</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>.</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.03588em;\">ey</span></span></span></span>。对于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.980548em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>，定义指示随机变量 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.07847em;\">I</span><span>{</span><span>h</span><span>(</span><span><span style=\"margin-right:0.03148em;\">k</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span>h</span><span>(</span><span><span style=\"margin-right:0.03148em;\">k</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>)}</span></span></span></span>。根据简单均匀哈希假设，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Pr</span><span>{</span><span>h</span><span>(</span><span><span style=\"margin-right:0.03148em;\">k</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span>h</span><span>(</span><span><span style=\"margin-right:0.03148em;\">k</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>)}</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>m</span></span></span></span>。所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>m</span></span></span></span>。最终，在一次成功的搜索中需要遍历的元素期望数目是：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:15.806187999999999em;vertical-align:-7.653094em;\"></span><span><span><span><span><span><span style=\"height:8.153094em;\"><span style=\"top:-10.302810000000001em;\"><span style=\"height:3.801113em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>i</span><span>+</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>)]</span></span></span><span style=\"top:-6.9376359999999995em;\"><span style=\"height:3.801113em;\"></span><span></span></span><span style=\"top:-3.5724619999999985em;\"><span style=\"height:3.801113em;\"></span><span></span></span><span style=\"top:-0.057571999999997736em;\"><span style=\"height:3.801113em;\"></span><span></span></span><span style=\"top:2.865981em;\"><span style=\"height:3.801113em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:7.653094em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:8.153094em;\"><span style=\"top:-10.302810000000001em;\"><span style=\"height:3.801113em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>i</span><span>+</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>])</span></span></span><span style=\"top:-6.9376359999999995em;\"><span style=\"height:3.801113em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>i</span><span>+</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>m</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>)</span></span></span><span style=\"top:-3.5724619999999985em;\"><span style=\"height:3.801113em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>nm</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000007em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>i</span><span>+</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>nm</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>i</span><span>)</span></span></span><span style=\"top:-0.057571999999997736em;\"><span style=\"height:3.801113em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>nm</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.8011130000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>nm</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:2.865981em;\"><span style=\"height:3.801113em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span><span>m</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>)</span><span style=\"margin-right:0.0037em;\">α</span></span></span></span><span>​</span></span><span><span style=\"height:7.653094em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>因为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span><span>lim</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>n</span><span>→</span><span>∞</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1/</span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>，所以最终期望运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.0037em;\">α</span><span>)</span></span></span></span>。</p>\n<p>这意味着，如果可以做到表中元素的数量和哈希表的槽的数量成正比，即 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>m</span><span>)</span></span></span></span>，那么就可以有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.0037em;\">α</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>m</span><span>)</span><span>/</span><span>m</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span></span>。此时哈希表的插入、搜索、删除操作都可以在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span></span> 时间内完成。</p>\n<h2 id=\"_11-3-哈希函数\"> 11.3 哈希函数</h2>\n<p>本节将介绍三种哈希方法：除法哈希、乘法哈希和通用哈希。</p>\n<h3 id=\"优秀函数哈希\"> 优秀函数哈希</h3>\n<p>优秀的哈希函数满足或者渐近满足简单均匀哈希假设。不幸的是，通常没办法检查简单均匀哈希是否成立，因为键的概率分布一般是未知的。</p>\n<p>如果能够知道键的概率分布，比如键 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 是满足 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.78111em;vertical-align:-0.13667em;\"></span><span>0</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 的实数，且满足独立均匀分布。那么：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⌊</span><span>km</span><span>⌋</span></span></span></span></span></p>\n<p>就满足简单均匀哈希。</p>\n<p>在实践中，通常使用启发式的技巧来构造表现良好的哈希函数。输入分布的定性分析往往能提供很大帮助。</p>\n<h3 id=\"把键转换为自然数\"> 把键转换为自然数</h3>\n<p>大多数哈希函数都假设键的全集是自然数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68889em;vertical-align:0em;\"></span><span>N</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>{</span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>2</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>}</span></span></span></span>。当键不是自然数时，就需要将其转换为自然数。比如说，可以把字符串解释为适当进制的数字。比如字符串 <code>&quot;pt&quot;</code>，其中 <code>p</code> 的 ASCII 码是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>112</span></span></span></span>，<code>t</code> 的 ASCII 码是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>116</span></span></span></span>。<code>&quot;pt&quot;</code> 可以表示为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>112</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>116</span><span>)</span></span></span></span>，如果把该序列理解为一个 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>128</span></span></span></span> 进制的数字，那么 <code>pt</code> 相当于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span>112</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>×</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span>123</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>116</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>14452</span></span></span></span>。</p>\n<h3 id=\"_11-3-1-除法哈希\"> 11.3.1 除法哈希</h3>\n<p>在使用<strong>除法</strong>（division method）构造的哈希函数中，算法利用 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 除以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 的余数把 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 哈希到 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 个槽中：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span></span></p>\n<p>使用除法哈希时，要避免使用特定的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 数值。比如说，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 不应该是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span></span></span></span> 的幂次。如果 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.664392em;vertical-align:0em;\"></span><span><span>2</span><span><span><span><span style=\"height:0.664392em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>p</span></span></span></span></span></span></span></span></span></span></span>，相当于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span></span></span></span> 只使用了 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 的低 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span>p</span></span></span></span> 比特。为了用上键中的所有比特，通常会选择一个不太接近 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span></span></span></span> 的幂次的质数作为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span>。</p>\n<h3 id=\"_11-3-2-乘法哈希\"> 11.3.2 乘法哈希</h3>\n<p>乘法哈希包含两个步骤。第一步，将键 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 乘以一个常数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span>A</span></span></span></span>，其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68354em;vertical-align:-0.0391em;\"></span><span>0</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.72243em;vertical-align:-0.0391em;\"></span><span>A</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>。第二步，把 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span>A</span></span></span></span> 的小数部分乘以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span>，然后进行下取整操作，得到哈希值。</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⌊</span><span>m</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>A</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⌊</span><span style=\"margin-right:0.03148em;\">k</span><span>A</span><span>⌋)⌋</span></span></span></span></span></p>\n<p>乘法哈希的优势在于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 的选择变得不重要了，此时通常会使用 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span></span></span></span> 的幂次作为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span>，因为这样的乘法运算更快。</p>\n<h3 id=\"_11-3-3-通用哈希\"> 11.3.3 通用哈希</h3>\n<p>对于固定的哈希函数来说，攻击者可以设计特殊的输入序列，使所有元素都映射到同一个槽中。通用哈希借助与键无关的随机性来实现良好的平均表现。</p>\n<p>在通用哈希中，创建哈希表时会从特定的一系列函数中随机地选择一个作为哈希函数。注意不是每次做哈希时随机选择，而是创建哈希表时随机选择，在后续的所有操作中，选定的哈希函数是不变的。</p>\n<p>假设 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.00965em;\">H</span></span></span></span> 是一系列能把全集 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.10903em;\">U</span></span></span></span> 映射到 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>{</span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>}</span></span></span></span> 的函数。如果对于任意不同的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.10903em;\">U</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span style=\"margin-right:0.01968em;\">l</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.10903em;\">U</span></span></span></span>，满足 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>h</span><span>(</span><span style=\"margin-right:0.01968em;\">l</span><span>)</span></span></span></span> 的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span>h</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.00965em;\">H</span></span></span></span> 的数量不超过 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>∣</span><span style=\"margin-right:0.00965em;\">H</span><span>∣/</span><span>m</span></span></span></span>，那么 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.00965em;\">H</span></span></span></span> 是<strong>通用</strong>（universal）的。也就是说，随机选取哈希函数时，任意不同的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.10903em;\">U</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span style=\"margin-right:0.01968em;\">l</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.10903em;\">U</span></span></span></span> 之间发生碰撞的概率不超过 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>m</span></span></span></span>。</p>\n<h3 id=\"定理-11-3\"> 定理 11.3</h3>\n<p>假设哈希函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span> 是从哈希函数的通用集合中随机选出的，用于把 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个键哈希到有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 个槽的哈希表 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.13889em;\">T</span></span></span></span> 中，并且使用链表来解决碰撞。如果键 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 不在表中，那么 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 对应的槽中的链表的期望长度 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.1052em;vertical-align:-0.3551999999999999em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span>n</span><span><span><span><span style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.0037em;\">α</span></span></span></span>。如果键 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 在表中，那么含 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 的槽中的链表的期望长度 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.1052em;vertical-align:-0.3551999999999999em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span>n</span><span><span><span><span style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.0037em;\">α</span></span></span></span>。</p>\n<p>接下来的证明中，仅依赖于通用哈希的定义，而不依赖于输入的概率分布。假设不同的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.10903em;\">U</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span style=\"margin-right:0.01968em;\">l</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.10903em;\">U</span></span></span></span>，定义指示随机变量 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.07847em;\">I</span><span>{</span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>h</span><span>(</span><span style=\"margin-right:0.01968em;\">l</span><span>)}</span></span></span></span>。根据定义中给出的概率，可知 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>m</span></span></span></span>。</p>\n<p>定义另一个随机变量 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 等于除了 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 之外还有多少键被哈希到同一个槽中：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.488226em;vertical-align:-1.438221em;\"></span><span><span><span><span style=\"height:1.050005em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.01968em;\">l</span><span>∈</span><span style=\"margin-right:0.13889em;\">T</span><span><span>，</span></span><span style=\"margin-right:0.01968em;\">l</span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span></span><span>​</span></span><span><span style=\"height:1.438221em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>求数学期望：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:8.636113em;vertical-align:-4.0680565em;\"></span><span><span><span><span><span><span style=\"height:4.5680565em;\"><span style=\"top:-6.8394915em;\"><span style=\"height:3.32144em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-4.0512655em;\"><span style=\"height:3.32144em;\"></span><span></span></span><span style=\"top:-0.9916045em;\"><span style=\"height:3.32144em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:4.0680565em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:4.5680565em;\"><span style=\"top:-6.8394915em;\"><span style=\"height:3.32144em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span><span><span style=\"height:1.050005em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.01968em;\">l</span><span>∈</span><span style=\"margin-right:0.13889em;\">T</span><span><span>，</span></span><span style=\"margin-right:0.01968em;\">l</span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span></span><span>​</span></span><span><span style=\"height:1.438221em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-4.0512655em;\"><span style=\"height:3.32144em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.050005em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.01968em;\">l</span><span>∈</span><span style=\"margin-right:0.13889em;\">T</span><span><span>，</span></span><span style=\"margin-right:0.01968em;\">l</span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span></span><span>​</span></span><span><span style=\"height:1.438221em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.07847em;\">X</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-0.9916045em;\"><span style=\"height:3.32144em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.050005em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.01968em;\">l</span><span>∈</span><span style=\"margin-right:0.13889em;\">T</span><span><span>，</span></span><span style=\"margin-right:0.01968em;\">l</span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span></span><span>​</span></span><span><span style=\"height:1.438221em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>m</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span></span><span>​</span></span><span><span style=\"height:4.0680565em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>接下来要根据 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 是否在哈希表中进行分类讨论：</p>\n<ul>\n<li>如果 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 不在表中，那么 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7857599999999999em;vertical-align:-0.3551999999999999em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，且 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>∣</span><span>{</span><span style=\"margin-right:0.01968em;\">l</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>:</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span style=\"margin-right:0.01968em;\">l</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span><span> </span><span>并且</span><span> </span></span><span style=\"margin-right:0.01968em;\">l</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span>}</span><span>∣</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>。所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.1052em;vertical-align:-0.3551999999999999em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span>n</span><span><span><span><span style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/</span><span>m</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.0037em;\">α</span></span></span></span>。</li>\n<li>如果 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 在表中，那么 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7857599999999999em;vertical-align:-0.3551999999999999em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>，且 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>∣</span><span>{</span><span style=\"margin-right:0.01968em;\">l</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>:</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span style=\"margin-right:0.01968em;\">l</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.13889em;\">T</span><span><span> </span><span>并且</span><span> </span></span><span style=\"margin-right:0.01968em;\">l</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span>}</span><span>∣</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>。所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.1052em;vertical-align:-0.3551999999999999em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span>n</span><span><span><span><span style=\"height:0.34480000000000005em;\"><span style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.3551999999999999em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"margin-right:0.22222em;\">Y</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.78111em;vertical-align:-0.13667em;\"></span><span>1</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span><span>/</span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span style=\"margin-right:0.0037em;\">α</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>m</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.0037em;\">α</span></span></span></span>。</li>\n</ul>\n<h3 id=\"推论-11-4\"> 推论 11.4</h3>\n<p>如果使用通用哈希，使用链表解决碰撞，那么对于有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 个槽的哈希表来说，处理长度为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 的，含有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>m</span><span>)</span></span></span></span> 个 <code>INSERT</code> 操作的，任意 <code>INSERT</code>、<code>SEARCH</code>、<code>DELETE</code> 操作的组合的期望运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span>。</p>\n<p>证明非常简单，因为插入元素的数量是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>m</span><span>)</span></span></span></span>，所以有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.0037em;\">α</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/</span><span>m</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span></span>。因此 <code>SEARCH</code> 的期望运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span></span>，而 <code>INSERT</code> 和 <code>DELETE</code> 本来就只花费常数时间，所以总的运行时间是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span>。又由于每个操作至少是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Ω</span><span>(</span><span>1</span><span>)</span></span></span></span>，所以最终得到 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>n</span><span>)</span></span></span></span>。</p>\n<h3 id=\"设计通用哈希\"> 设计通用哈希</h3>\n<p>首先选择一个非常大的质数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span>p</span></span></span></span>，保证所有可能的键 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 都在区间 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>[</span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>p</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>]</span></span></span></span> 中。令 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.974998em;vertical-align:-0.286108em;\"></span><span><span>Z</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>p</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>{</span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>p</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>}</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.071998em;vertical-align:-0.383108em;\"></span><span><span>Z</span><span><span><span><span style=\"height:0.688696em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>p</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>∗</span></span></span></span><span>​</span></span><span><span style=\"height:0.383108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>{</span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>2</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>p</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>}</span></span></span></span>。可以构造：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span><span>h</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>ab</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>((</span><span style=\"margin-right:0.03148em;\">ak</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>b</span><span>)</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>p</span><span>)</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span></span></p>\n<p>利用以上形式，得到：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.00965em;\">H</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00965em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>p</span><span>m</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>{</span><span><span>h</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>ab</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>:</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>a</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.121804em;vertical-align:-0.383108em;\"></span><span><span>Z</span><span><span><span><span style=\"height:0.738696em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>p</span></span></span><span style=\"top:-3.1130000000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>∗</span></span></span></span><span>​</span></span><span><span style=\"height:0.383108em;\"><span></span></span></span></span></span></span><span><span> </span><span>并且</span><span> </span></span><span>b</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span><span>Z</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>p</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>}</span></span></span></span></span></p>\n<p>当需要从 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.00965em;\">H</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00965em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>p</span><span>m</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 中随机选出哈希函数时，只需要随机确定 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>a</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>b</span></span></span></span> 即可。由于一共有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7777700000000001em;vertical-align:-0.19444em;\"></span><span>p</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 种 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>a</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span>p</span></span></span></span> 种 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>b</span></span></span></span>，所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.00965em;\">H</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00965em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>p</span><span>m</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 中一共有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>p</span><span>(</span><span>p</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span></span></span></span> 个哈希函数。</p>\n<h3 id=\"定理-11-5\"> 定理 11.5</h3>\n<p><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.00965em;\">H</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00965em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>p</span><span>m</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 是通用的。</p>\n<p>假设 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.974998em;vertical-align:-0.286108em;\"></span><span><span>Z</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>p</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 中的两个不同的键 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.01968em;\">l</span></span></span></span>。对于给定的哈希函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span><span>h</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>ab</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>，可以得到：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:3.0000000000000004em;vertical-align:-1.2500000000000002em;\"></span><span><span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.02778em;\">r</span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span>s</span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span style=\"margin-right:0.03148em;\">ak</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>b</span><span>)</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>p</span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span>a</span><span style=\"margin-right:0.01968em;\">l</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>b</span><span>)</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>p</span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>首先能够确定的是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.02778em;\">r</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>s</span></span></span></span>，因为上面两式相减：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span style=\"margin-right:0.02778em;\">r</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.46375em;vertical-align:0em;\"></span><span>s</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>≡</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>a</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.01968em;\">l</span><span>)</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span>p</span></span></span></span></span></p>\n<p>由于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span>p</span></span></span></span> 是质数，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>a</span></span></span></span> 乘以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.01968em;\">l</span></span></span></span> 不可能得到一个质数，所以取模的结果必不为零。因此，在模 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span>p</span></span></span></span> 这一级，不会发生碰撞。模 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span>p</span></span></span></span> 之后还有模 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span>，继续分析。</p>\n<p>当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.02778em;\">r</span></span></span></span> 是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span>p</span></span></span></span> 个数字中的某一个时，由于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.02778em;\">r</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>s</span></span></span></span>，所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>s</span></span></span></span> 只可能是剩下的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7777700000000001em;vertical-align:-0.19444em;\"></span><span>p</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 个数字中的一个。因此 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span style=\"margin-right:0.02778em;\">r</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>s</span><span>)</span></span></span></span> 的组合有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>p</span><span>(</span><span>p</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span></span></span></span> 种可能。注意到 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>a</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>b</span><span>)</span></span></span></span> 的组合也有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>p</span><span>(</span><span>p</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span></span></span></span> 种可能，如果能够证明 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>a</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>b</span><span>)</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span style=\"margin-right:0.02778em;\">r</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>s</span><span>)</span></span></span></span> 之间存在一对一的关系，那么就能够推导出 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span style=\"margin-right:0.02778em;\">r</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>s</span><span>)</span></span></span></span> 也是随机分布的（因为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>a</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>b</span><span>)</span></span></span></span> 是随机选择的）。</p>\n<p>对于满足 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 或 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 的两个组合 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span></span></span></span>，代入求 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.02778em;\">r</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>s</span></span></span></span> 的式子中：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:3.0000000000000004em;vertical-align:-1.2500000000000002em;\"></span><span><span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span><span style=\"margin-right:0.02778em;\">r</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span style=\"margin-right:0.02778em;\">r</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span><span>s</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>s</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>((</span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>))</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>p</span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>((</span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.01968em;\">l</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>))</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>p</span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>根据前提，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 最多只有一个为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>。当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span> 时，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.02778em;\">r</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.02778em;\">r</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span><span>s</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>s</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 都不为零（因为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>∣</span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>∣</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span>p</span></span></span></span>），所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span><span style=\"margin-right:0.02778em;\">r</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>s</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span><span style=\"margin-right:0.02778em;\">r</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>s</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span></span></span></span> 不相同。</p>\n<p>当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 不为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span> 时，使用反证法，假设两式同时为零：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:6.743560000000001em;vertical-align:-3.121780000000001em;\"></span><span><span><span><span><span><span style=\"height:3.62178em;\"><span style=\"top:-5.889340000000001em;\"><span style=\"height:3.10756em;\"></span><span><span>((</span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>))</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>p</span></span></span><span style=\"top:-4.389340000000001em;\"><span style=\"height:3.10756em;\"></span><span><span>(</span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>x</span><span>p</span></span></span><span style=\"top:-2.8893399999999994em;\"><span style=\"height:3.10756em;\"></span><span><span>(</span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>x</span><span>p</span></span></span><span style=\"top:-1.121779999999999em;\"><span style=\"height:3.10756em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.1075599999999999em;\"><span style=\"top:-2.3139999999999996em;\"><span style=\"height:3em;\"></span><span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>x</span><span>p</span></span></span></span><span>​</span></span><span><span style=\"height:0.8360000000000001em;\"><span></span></span></span></span></span><span></span></span></span></span></span><span>​</span></span><span><span style=\"height:3.121780000000001em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:3.62178em;\"><span style=\"top:-5.889340000000001em;\"><span style=\"height:3.10756em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>((</span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.01968em;\">l</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>))</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>p</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>0</span></span></span><span style=\"top:-4.389340000000001em;\"><span style=\"height:3.10756em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.01968em;\">l</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>b</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span></span></span><span style=\"top:-2.8893399999999994em;\"><span style=\"height:3.10756em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.01968em;\">l</span></span></span><span style=\"top:-1.121779999999999em;\"><span style=\"height:3.10756em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.01968em;\">l</span></span></span></span><span>​</span></span><span><span style=\"height:3.121780000000001em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span></span></span></span> 是使第二行成立的整数。如果 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>x</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>，那么有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.01968em;\">l</span></span></span></span>，与 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.01968em;\">l</span></span></span></span> 的前提矛盾；如果 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span>x</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>，由于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>∣</span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>∣</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span>p</span></span></span></span> 且 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span>p</span></span></span></span> 是质数，所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>x</span><span>p</span><span>/</span><span>(</span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span></span></span></span> 不可能整除，与 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.01968em;\">l</span></span></span></span> 都是整数的前提矛盾。因此假设不成立，两式不同时为零，所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span><span style=\"margin-right:0.02778em;\">r</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>s</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span><span style=\"margin-right:0.02778em;\">r</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>s</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span></span></span></span> 不相同。综上 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>a</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>b</span><span>)</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span style=\"margin-right:0.02778em;\">r</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>s</span><span>)</span></span></span></span> 之间存在一对一的关系。</p>\n<p>因此，给定不同的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.01968em;\">l</span></span></span></span>，如果随机从 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.071998em;vertical-align:-0.383108em;\"></span><span><span>Z</span><span><span><span><span style=\"height:0.688696em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>p</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>∗</span></span></span></span><span>​</span></span><span><span style=\"height:0.383108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>×</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.974998em;vertical-align:-0.286108em;\"></span><span><span>Z</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>p</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 中选择 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>a</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>b</span><span>)</span></span></span></span>，那么得到的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span style=\"margin-right:0.02778em;\">r</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>s</span><span>)</span></span></span></span> 也应该是随机的。那么给定 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.02778em;\">r</span></span></span></span>，剩下的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7777700000000001em;vertical-align:-0.19444em;\"></span><span>p</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 个值中满足 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.46375em;vertical-align:0em;\"></span><span>s</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>≡</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">r</span><span>(</span><span style=\"margin-right:0.05555555555555555em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span>m</span><span>)</span></span></span></span> 的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>s</span></span></span></span> 的数量有：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:3.0000000000000004em;vertical-align:-1.2500000000000002em;\"></span><span><span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span>⌈</span><span>p</span><span>/</span><span>m</span><span>⌉</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:1.7500000000000002em;\"><span style=\"top:-3.91em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span>p</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span>/</span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span><span style=\"top:-2.41em;\"><span style=\"height:3em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span>p</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span>/</span><span>m</span></span></span></span><span>​</span></span><span><span style=\"height:1.2500000000000002em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>那么发生碰撞的概率，也就是从 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7777700000000001em;vertical-align:-0.19444em;\"></span><span>p</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 个可选项中选到满足上述条件的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>p</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span><span>/</span><span>m</span></span></span></span> 个值的概率是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>((</span><span>p</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span><span>/</span><span>m</span><span>))</span><span>/</span><span>(</span><span>p</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>m</span></span></span></span>。</p>\n<p>因此，对于任意不同的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.01968em;\">l</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Pr</span><span>{</span><span><span>h</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>ab</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span><span>h</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>ab</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.01968em;\">l</span><span>)}</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>m</span></span></span></span>，所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.00965em;\">H</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00965em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>p</span><span>m</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 是通用的。</p>\n<h2 id=\"_11-4-开放寻址\"> 11.4 开放寻址</h2>\n<p>在<strong>开放寻址</strong>（open addressing）中，所有元素只占用哈希表本身的空间。哈希表中的每个槽装有一个动态集合的元素，或者装有一个代表空标志。\n与链表法不同，开放寻址法的装载因子 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.7733399999999999em;vertical-align:-0.13667em;\"></span><span style=\"margin-right:0.0037em;\">α</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>。</p>\n<p>为了解决哈希碰撞，哈希函数会生成一个连续的<strong>探查</strong>（probe）序列。哈希表会逐个检查这个序列中给出的槽位是否是空的，然后把要插入的数据放在第一个空位。因此，哈希函数是：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>:</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span style=\"margin-right:0.10903em;\">U</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>×</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>{</span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>}</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>→</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>{</span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>}</span></span></span></span></span></p>\n<p>对于每个 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span>，可以求得<strong>探查序列</strong>（probe sequence）：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⟨</span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>0</span><span>)</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>)</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)⟩</span></span></span></span></span></p>\n<p>伪代码：</p>\n<div><pre><code>HASH-INSERT(T, k)\n  i = 0\n  repeat\n    j = h(k, i)\n    if T[j] == nil\n      T[j] = k\n      return j\n    else\n      i = i + 1\n  until i == m\n  error &quot;hash table overflow&quot;\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br></div></div><div><pre><code>HASH-SEARCH(T, k)\n  i = 0\n  repeat\n    j = h(k, i)\n    if T[j] == k\n      return j\n    i = i + 1\n  until T[j] == nil or i == m\n  return nil\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></div></div><p>删除时有一些问题需要注意。如果只是简单地把元素所在槽设为 <code>nil</code>，那么搜索时就无法再搜索到该探查序列中后续位置中的元素。可以使用一个简单的标志 <code>DELETED</code> 来标记该槽中的元素已经被删除。当使用这样的删除方法时，搜索所需要的运行时间就不仅与装载因子 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.0037em;\">α</span></span></span></span> 相关了。因此在实际的使用中，还是链表法更常见一些。</p>\n<p>这里引入<strong>均匀哈希</strong>（uniform hashing）的概念：每个键对应的探查序列是序列 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⟨</span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>⟩</span></span></span></span> 的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>m</span><span>!</span></span></span></span> 个排列中的任何一个的可能性都是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>(</span><span>m</span><span>!)</span></span></span></span>。</p>\n<p>接下来将介绍三种方法：线性探查，二次探查和二次哈希。它们都能保证对于任何键 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⟨</span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>0</span><span>)</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>)</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)⟩</span></span></span></span> 总是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⟨</span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>⟩</span></span></span></span> 的排列之一。然而，这三种方法都不满足均匀哈希假设。它们能够提供的所有可能的探查序列都不超过 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span><span>m</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span></span></span></span> 种，远不及均匀哈希假设中所要求的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>m</span><span>!</span></span></span></span> 种。</p>\n<h3 id=\"线性探查\"> 线性探查</h3>\n<p><strong>线性探查</strong>（linear probe）使用一个普通的哈希函数作为<strong>辅助哈希函数</strong>（auxiliary hashing function）：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>i</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.051892em;vertical-align:-0.25em;\"></span><span>(</span><span><span>h</span><span><span><span><span style=\"height:0.801892em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>i</span><span>)</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span></span></p>\n<p>其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8388800000000001em;vertical-align:-0.19444em;\"></span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>。</p>\n<p>线性探查的实现比较简单，但是容易发生<strong>主聚集</strong>（primary clustering）效应。当一个空槽的前面有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span> 个装满的槽时，下一次插入时它被装满的概率提升到了 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span><span>/</span><span>m</span></span></span></span>。因此长时间运行以后，装满的槽倾向于聚集在一起，从而使得平均搜索时间变长。</p>\n<h3 id=\"二次探查\"> 二次探查</h3>\n<p><strong>二次探查</strong>（quadratic probe）使用如下形式的哈希函数：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>i</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.051892em;vertical-align:-0.25em;\"></span><span>(</span><span><span>h</span><span><span><span><span style=\"height:0.801892em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.80952em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1.1141079999999999em;vertical-align:-0.25em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span><span>i</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span></span></p>\n<p>其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.751892em;vertical-align:0em;\"></span><span><span>h</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span></span></span></span></span></span></span></span> 是辅助哈希函数，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是正的辅助常数，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8388800000000001em;vertical-align:-0.19444em;\"></span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>。这种方法比线性探查更好，但是为了使探查序列是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>⟨</span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>⟩</span></span></span></span> 的排列，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>、<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 需要满足某些关系。典型的算法是：</p>\n<ol>\n<li><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span></span></span></span> 的幂，令 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>0</span></span></span></span>，计算 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.05724em;\">j</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.001892em;vertical-align:-0.25em;\"></span><span><span>h</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span></span></span></span>。</li>\n<li>探查位置 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.05724em;\">j</span></span></span></span>，如果是目标则停止探查。</li>\n<li>令 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.74285em;vertical-align:-0.08333em;\"></span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>：\n<ul>\n<li>如果 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span>，那么哈希表已满，停止探查。</li>\n<li>否则，令 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.05724em;\">j</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05724em;\">j</span><span>)</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span>，回到步骤 2。</li>\n</ul>\n</li>\n</ol>\n<p>根据以上算法，可知 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span> 给定时，对应的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05724em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 满足：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:8.134222000000001em;vertical-align:-3.8171110000000006em;\"></span><span><span><span><span><span><span style=\"height:4.317111000000001em;\"><span style=\"top:-6.317111000000001em;\"><span style=\"height:3.811669em;\"></span><span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>i</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05724em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.2879979999999995em;\"><span style=\"height:3.811669em;\"></span><span></span></span><span style=\"top:-0.9805579999999997em;\"><span style=\"height:3.811669em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:3.8171110000000006em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:4.317111000000001em;\"><span style=\"top:-6.317111000000001em;\"><span style=\"height:3.811669em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span><span>h</span><span><span><span><span style=\"height:0.801892em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span><span style=\"height:1.8116690000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>m</span></span></span><span style=\"top:-3.2879979999999995em;\"><span style=\"height:3.811669em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span><span>h</span><span><span><span><span style=\"height:0.801892em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>i</span><span>(</span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>)</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>m</span></span></span><span style=\"top:-0.9805579999999997em;\"><span style=\"height:3.811669em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span><span>h</span><span><span><span><span style=\"height:0.801892em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span><span>i</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>m</span></span></span></span><span>​</span></span><span><span style=\"height:3.8171110000000006em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>所以有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span><span>c</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/2</span></span></span></span>。接下来证明 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8388800000000001em;vertical-align:-0.19444em;\"></span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 时正好遍历哈希表的每个位置：假设 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.78111em;vertical-align:-0.13667em;\"></span><span>0</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>a</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span>b</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span>，可知：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05724em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span><span style=\"margin-right:0.05724em;\">j</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05724em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>a</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>a</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>a</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>2</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>⋯</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>b</span><span>)</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span></span></p>\n<p>使用反证法，假设 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05724em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>a</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>≡</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05724em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.05555555555555555em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span>m</span><span>)</span></span></span></span>，那么有：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:13.835320000000003em;vertical-align:-6.6676600000000015em;\"></span><span><span><span><span><span><span style=\"height:7.1676600000000015em;\"><span style=\"top:-9.754660000000001em;\"><span style=\"height:3.427em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05724em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>a</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>m</span></span></span><span style=\"top:-8.254660000000001em;\"><span style=\"height:3.427em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05724em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>a</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>m</span></span></span><span style=\"top:-6.754660000000001em;\"><span style=\"height:3.427em;\"></span><span><span>0</span></span></span><span style=\"top:-4.66766em;\"><span style=\"height:3.427em;\"></span><span><span>0</span></span></span><span style=\"top:-2.36022em;\"><span style=\"height:3.427em;\"></span><span><span>0</span></span></span><span style=\"top:-0.052779999999998384em;\"><span style=\"height:3.427em;\"></span><span><span>0</span></span></span><span style=\"top:2.254660000000001em;\"><span style=\"height:3.427em;\"></span><span><span>0</span></span></span></span><span>​</span></span><span><span style=\"height:6.6676600000000015em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:7.1676600000000015em;\"><span style=\"top:-9.754660000000001em;\"><span style=\"height:3.427em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05724em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>m</span></span></span><span style=\"top:-8.254660000000001em;\"><span style=\"height:3.427em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span><span style=\"margin-right:0.05724em;\">j</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05724em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>a</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span>a</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span>a</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>2</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋯</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>b</span><span>)</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>m</span></span></span><span style=\"top:-6.754660000000001em;\"><span style=\"height:3.427em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>((</span><span>a</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span>a</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>2</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋯</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>b</span><span>)</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>m</span></span></span><span style=\"top:-4.66766em;\"><span style=\"height:3.427em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>b</span><span>(</span><span>b</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>a</span><span>(</span><span>a</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>)</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>m</span></span></span><span style=\"top:-2.36022em;\"><span style=\"height:3.427em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>(</span><span><span>b</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>b</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>a</span><span>)</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>m</span></span></span><span style=\"top:-0.052779999999998384em;\"><span style=\"height:3.427em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>((</span><span><span>b</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>(</span><span>b</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>a</span><span>)))</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>m</span></span></span><span style=\"top:2.254660000000001em;\"><span style=\"height:3.427em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>(</span><span>b</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>a</span><span>)</span><span>(</span><span>b</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>a</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>))</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>m</span></span></span></span><span>​</span></span><span><span style=\"height:6.6676600000000015em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>注意到 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span>b</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>a</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.77777em;vertical-align:-0.08333em;\"></span><span>b</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>a</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 不同时为偶数，所以不可能被 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 整除（因为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span></span></span></span> 的幂），与前提矛盾。综上，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.78111em;vertical-align:-0.13667em;\"></span><span>0</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>a</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span>b</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span><span><span><span><span style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05724em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>a</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span><span><span style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span><span><span></span></span></span><span></span></span></span></span></span><span>=</span></span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span><span><span><span><span style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05724em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>b</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>。所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8388800000000001em;vertical-align:-0.19444em;\"></span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 时正好遍历了哈希表的每个位置。</p>\n<p>如果两个键 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 满足 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.001892em;vertical-align:-0.25em;\"></span><span><span>h</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span></span></span></span></span><span>(</span><span><span style=\"margin-right:0.03148em;\">k</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.001892em;vertical-align:-0.25em;\"></span><span><span>h</span><span><span><span><span style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>′</span></span></span></span></span></span></span></span></span><span>(</span><span><span style=\"margin-right:0.03148em;\">k</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>)</span></span></span></span>，那么它们的探查序列是相同的。这导致了比较轻微的聚集，称为<strong>次聚集</strong>（secondary clustering）效应。</p>\n<h3 id=\"二次哈希\"> 二次哈希</h3>\n<p><strong>二次哈希</strong>（double hashing）使用如下形式的哈希函数：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>h</span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>i</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span><span>h</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>i</span><span><span>h</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>))</span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span><span>mod</span></span></span><span style=\"margin-right:0.05555555555555555em;\"></span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span></span></p>\n<p>其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span><span>h</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span><span>h</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是辅助哈希函数。<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span><span>h</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>(</span><span style=\"margin-right:0.03148em;\">k</span><span>)</span></span></span></span> 的值必须与 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 互质，才能使得<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8388800000000001em;vertical-align:-0.19444em;\"></span><span>0</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>1</span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>,</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 时哈希函数正好遍历哈希表的每个位置。通常的办法是让 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span></span></span></span> 的幂，然后使 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span><span>h</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 总产生比 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 小的正奇数哈希值。</p>\n<p>在线性探查和二次探查中，只有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span>m</span><span>)</span></span></span></span> 种探查序列；而在二次哈希中有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span>Θ</span><span>(</span><span><span>m</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span>)</span></span></span></span> 种探查序列。因此二次哈希的表现与理想中的均匀哈希非常接近。</p>\n<h3 id=\"开放寻址法的分析\"> 开放寻址法的分析</h3>\n<p>为了简化分析，假设使用的哈希函数符合均匀哈希假设。</p>\n<h3 id=\"定理-11-6\"> 定理 11.6</h3>\n<p>假设使用均匀哈希函数，给定使用开放寻址法的哈希表，其装载因子 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.0037em;\">α</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/</span><span>m</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>，那么不成功的搜索中期望探查次数最多为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.0037em;\">α</span><span>)</span></span></span></span>。</p>\n<p>在不成功的搜索中，除了最后一次探查之外，每次探查都访问到了一个不空的槽，但槽中装的不是目标元素；而最后一次探查会访问到一个空槽，或者发现已经探查了哈希表的所有地址。定义事件 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 是在第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span> 次探查时发现了一个不空的槽，并且槽中不是目标元素。定义随机变量 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.07847em;\">X</span></span></span></span> 代表不成功的搜索中探查的次数。所以事件 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>{</span><span style=\"margin-right:0.07847em;\">X</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>i</span><span>}</span></span></span></span> 等于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>∩</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>∩</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.55556em;vertical-align:0em;\"></span><span>⋯</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>∩</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.891661em;vertical-align:-0.208331em;\"></span><span><span>A</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span>。</p>\n<p>由于表中存在 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个元素和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 个槽，所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Pr</span><span>{</span><span><span>A</span><span><span><span><span style=\"height:0.30110799999999993em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.15em;\"><span></span></span></span></span></span></span><span>}</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>n</span><span>/</span><span>m</span></span></span></span>。而 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span>Pr</span><span>{</span><span><span>A</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>}</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.05724em;\">j</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span><span>/</span><span>(</span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.05724em;\">j</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>)</span></span></span></span>，因为已经有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.05724em;\">j</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 个槽已经确定不空。</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:6.034074em;vertical-align:-2.767037em;\"></span><span><span><span><span><span><span style=\"height:3.267037em;\"><span style=\"top:-5.267037em;\"><span style=\"height:3.33652em;\"></span><span><span>Pr</span><span>{</span><span style=\"margin-right:0.07847em;\">X</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>i</span><span>}</span></span></span><span style=\"top:-3.0901470000000004em;\"><span style=\"height:3.33652em;\"></span><span></span></span><span style=\"top:-1.229483em;\"><span style=\"height:3.33652em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:2.767037em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:3.267037em;\"><span style=\"top:-5.267037em;\"><span style=\"height:3.33652em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>m</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>…</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.3365200000000002em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-3.0901470000000004em;\"><span style=\"height:3.33652em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>(</span><span><span></span><span><span><span><span style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>m</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span><span>)</span><span><span><span><span style=\"height:0.8746639999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span></span></span></span></span></span></span><span style=\"top:-1.229483em;\"><span style=\"height:3.33652em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.0037em;\">α</span><span><span><span><span style=\"height:0.8746639999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:2.767037em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>求数学期望：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:12.077968000000002em;vertical-align:-5.788984em;\"></span><span><span><span><span><span><span style=\"height:6.288984000000001em;\"><span style=\"top:-8.288984000000001em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.07847em;\">X</span><span>]</span></span></span><span style=\"top:-5.059918000000001em;\"><span style=\"height:3.6513970000000002em;\"></span><span></span></span><span style=\"top:-1.830851999999999em;\"><span style=\"height:3.6513970000000002em;\"></span><span></span></span><span style=\"top:1.0682569999999998em;\"><span style=\"height:3.6513970000000002em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:5.788984em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:6.288984000000001em;\"><span style=\"top:-8.288984000000001em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>∞</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>Pr</span><span>{</span><span style=\"margin-right:0.07847em;\">X</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>i</span><span>}</span></span></span><span style=\"top:-5.059918000000001em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>∞</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.0037em;\">α</span><span><span><span><span style=\"height:0.874664em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>i</span><span>−</span><span>1</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-1.830851999999999em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>∞</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.0037em;\">α</span><span><span><span><span style=\"height:0.8746639999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>i</span></span></span></span></span></span></span></span></span></span><span style=\"top:1.0682569999999998em;\"><span style=\"height:3.6513970000000002em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.0037em;\">α</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span></span></span></span></span></span><span>​</span></span><span><span style=\"height:5.788984em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<h3 id=\"推论-11-7\"> 推论 11.7</h3>\n<p>假设使用均匀哈希函数，给定使用开放寻址法的哈希表，其装载因子 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span style=\"margin-right:0.0037em;\">α</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>，那么向哈希表中插入元素的期望探查次数最多是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.0037em;\">α</span><span>)</span></span></span></span>。</p>\n<p>在每次插入之前，都需要一次不成功的搜索来找到一个空位。所以期望探查次数的上界与不成功的搜索相同</p>\n<h3 id=\"定理-11-8\"> 定理 11.8</h3>\n<p>假设使用均匀哈希函数，给定使用开放寻址法的哈希表，其装载因子 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span style=\"margin-right:0.0037em;\">α</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>，那么成功的搜索中的期望探查次数最多为：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:2.09077em;vertical-align:-0.7693300000000001em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.0037em;\">α</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>ln</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.0037em;\">α</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>搜索某个键 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 时使用的探查序列与插入该键时相同。假设 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 是第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.74285em;vertical-align:-0.08333em;\"></span><span>i</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span> 个插入到表中的元素，那么此时 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.65952em;vertical-align:0em;\"></span><span>i</span></span></span></span>，所以 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span style=\"margin-right:0.0037em;\">α</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>i</span><span>/</span><span>m</span></span></span></span>。插入时的期望探查次数最多为 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>(</span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>i</span><span>/</span><span>m</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>m</span><span>/</span><span>(</span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>i</span><span>)</span></span></span></span>。那么对于表中的 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个元素求平均：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:14.156736em;vertical-align:-6.828368em;\"></span><span><span><span><span><span><span style=\"height:7.328368em;\"><span style=\"top:-9.328368000000001em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>i</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>m</span></span></span></span><span>​</span></span><span><span style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-6.0993020000000016em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:-3.024566000000002em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:-0.43284500000000015em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span><span style=\"top:1.9579249999999997em;\"><span style=\"height:3.8011130000000004em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:6.828368em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:7.328368em;\"><span style=\"top:-9.328368000000001em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>m</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.8011130000000004em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>i</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.277669em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>i</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-6.0993020000000016em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.0037em;\">α</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>m</span><span>−</span><span>n</span><span>+</span><span>1</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span>m</span></span></span></span><span>​</span></span><span><span style=\"height:1.360444em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-3.024566000000002em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.0037em;\">α</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;\">∫</span><span><span><span><span style=\"height:1.414292em;\"><span style=\"top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>m</span><span>−</span><span>n</span></span></span></span><span style=\"top:-3.8129000000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>m</span></span></span></span><span>​</span></span><span><span style=\"height:0.970281em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>x</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span>d</span><span>x</span></span></span><span style=\"top:-0.43284500000000015em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.0037em;\">α</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>ln</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.10756em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>m</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>m</span></span></span></span><span>​</span></span><span><span style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:1.9579249999999997em;\"><span style=\"height:3.8011130000000004em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.0037em;\">α</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>ln</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>1</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span style=\"margin-right:0.0037em;\">α</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span></span></span></span></span></span><span>​</span></span><span><span style=\"height:6.828368em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>简要证明一下含积分的一步。假设 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 是整数且 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span>m</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>，<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>x</span><span>)</span></span></span></span> 是值为正的单调递增的函数，那么有：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:2.9535100000000005em;vertical-align:-1.302113em;\"></span><span><span><span><span style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.03148em;\">k</span><span>=</span><span>m</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>n</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.302113em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>x</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.3262420000000006em;vertical-align:-0.9119499999999999em;\"></span><span><span style=\"margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;\">∫</span><span><span><span><span style=\"height:1.4142920000000005em;\"><span style=\"top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>m</span></span></span><span style=\"top:-3.812900000000001em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.9119499999999999em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(⌊</span><span>x</span><span>⌋)</span><span>d</span><span>x</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.3262420000000006em;vertical-align:-0.9119499999999999em;\"></span><span><span style=\"margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;\">∫</span><span><span><span><span style=\"height:1.4142920000000005em;\"><span style=\"top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>m</span></span></span><span style=\"top:-3.812900000000001em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.9119499999999999em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>x</span><span>)</span><span>d</span><span>x</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.384573em;vertical-align:-0.970281em;\"></span><span><span style=\"margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;\">∫</span><span><span><span><span style=\"height:1.414292em;\"><span style=\"top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>m</span><span>−</span><span>1</span></span></span></span><span style=\"top:-3.8129000000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.970281em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>x</span><span>)</span><span>d</span><span>x</span></span></span></span></span></p>\n<h2 id=\"_11-5-完美哈希\"> 11.5 完美哈希</h2>\n<p>以上几个小节展示了哈希表能够提供良好的平均情况性能。如果键的集合是<strong>静态</strong>（static）的，那么哈希表的最坏情况性能也非常好。静态指的是一旦哈希表建立完成，键的集合就再也不会改变。</p>\n<p>如果某种哈希在最坏情况中只需要 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>1</span><span>)</span></span></span></span> 次内存访问，那么就称这种哈希为<strong>完美哈希</strong>（perfect hashing）。</p>\n<p>为了构造一种完美哈希，可以使用两级通用哈希。第一级与链表法中的哈希类似，使用通用哈希函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span> 把 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 个键哈希到 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span></span></span></span> 个槽中。</p>\n<p>与链表法不同的是，每个槽中不是一个链表，而是<strong>二级哈希表</strong>（secondary hash table）<span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.05764em;\">S</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>。每个二级哈希表对应一个通用哈希函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.980548em;vertical-align:-0.286108em;\"></span><span><span>h</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>。如果能够恰当地选择 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.980548em;vertical-align:-0.286108em;\"></span><span><span>h</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>，那么二级哈希表里就可以不发生碰撞。</p>\n<p>为了不发生碰撞，需要让二级哈希表的大小 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span><span>m</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 是表中存储元素数量 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 的平方。如果恰当地选择一级哈希函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span>，能够保证在二级哈希表不发生碰撞的情况下，整个哈希表（包括一级和二级）的总空间使用不超过 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span>。</p>\n<p>通用哈希函数选择前面小节中构造的那款。一级哈希函数是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.00965em;\">H</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00965em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>p</span><span>m</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>，二级哈希函数是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.03065em;vertical-align:-0.34731999999999996em;\"></span><span><span style=\"margin-right:0.00965em;\">H</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00965em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>p</span><span><span>m</span><span><span><span><span style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.34731999999999996em;\"><span></span></span></span></span></span></span></span></span></span>。</p>\n<p>接下来分别证明二级哈希表中不会发生碰撞和总体空间使用是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.02778em;\">O</span><span>(</span><span>n</span><span>)</span></span></span></span>。</p>\n<h3 id=\"定理-11-9\"> 定理 11.9</h3>\n<p>假设哈希函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span>h</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.03065em;vertical-align:-0.34731999999999996em;\"></span><span><span style=\"margin-right:0.00965em;\">H</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00965em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>p</span><span><span>m</span><span><span><span><span style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.34731999999999996em;\"><span></span></span></span></span></span></span></span></span></span>，哈希表的大小 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span></span></span></span>，其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 是表中存储的元素的数量。那么发生碰撞的可能性小于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/2</span></span></span></span>。</p>\n<p>共有 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.061108em;vertical-align:-0.247em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span> 种可能发生的碰撞。根据通用哈希的定义，每一对键发生碰撞的概率是 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>m</span></span></span></span>。令随机变量 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.07847em;\">X</span></span></span></span> 是发生碰撞的次数，那么数学期望是：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:7.091988000000001em;vertical-align:-3.2959940000000008em;\"></span><span><span><span><span><span><span style=\"height:3.795994em;\"><span style=\"top:-5.965661999999999em;\"><span style=\"height:3.491108em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.07847em;\">X</span><span>]</span></span></span><span style=\"top:-3.4885539999999993em;\"><span style=\"height:3.491108em;\"></span><span></span></span><span style=\"top:-1.1811139999999996em;\"><span style=\"height:3.491108em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:3.2959940000000008em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:3.795994em;\"><span style=\"top:-5.965661999999999em;\"><span style=\"height:3.491108em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.247em;\"><span></span></span></span></span></span></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span><span><span><span style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-3.4885539999999993em;\"><span style=\"height:3.491108em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.491108em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span><span>n</span><span><span><span><span style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-1.1811139999999996em;\"><span style=\"height:3.491108em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span></span><span>​</span></span><span><span style=\"height:3.2959940000000008em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>然后使用 Markov 不等式：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Pr</span><span>{</span><span style=\"margin-right:0.07847em;\">X</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>t</span><span>}</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.113em;vertical-align:-0.686em;\"></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>t</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.07847em;\">X</span><span>]</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>证明如下（使用了概率论的数学期望定义 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.07847em;\">X</span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.11112em;vertical-align:-0.30612em;\"></span><span style=\"margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;\">∫</span><span style=\"margin-right:0.16666666666666666em;\"></span><span>x</span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>x</span><span>)</span><span>d</span><span>x</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Pr</span><span>{</span><span style=\"margin-right:0.07847em;\">X</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>t</span><span>}</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.11112em;vertical-align:-0.30612em;\"></span><span style=\"margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;\">∫</span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>x</span><span>)</span><span>d</span><span>x</span></span></span></span>，其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>x</span><span>)</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Pr</span><span>{</span><span style=\"margin-right:0.07847em;\">X</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>x</span><span>}</span></span></span></span>）：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:12.004967999999998em;vertical-align:-5.752483999999999em;\"></span><span><span><span><span><span><span style=\"height:6.252483999999999em;\"><span style=\"top:-8.252483999999999em;\"><span style=\"height:3.414292em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.07847em;\">X</span><span>]</span></span></span><span style=\"top:-5.6262419999999995em;\"><span style=\"height:3.414292em;\"></span><span></span></span><span style=\"top:-2.999999999999999em;\"><span style=\"height:3.414292em;\"></span><span></span></span><span style=\"top:-0.37375800000000003em;\"><span style=\"height:3.414292em;\"></span><span></span></span><span style=\"top:1.6781919999999988em;\"><span style=\"height:3.414292em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:5.752483999999999em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:6.252483999999999em;\"><span style=\"top:-8.252483999999999em;\"><span style=\"height:3.414292em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;\">∫</span><span><span><span><span style=\"height:1.414292em;\"><span style=\"top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>0</span></span></span><span style=\"top:-3.8129000000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>∞</span></span></span></span><span>​</span></span><span><span style=\"height:0.9119499999999999em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>x</span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>x</span><span>)</span><span>d</span><span>x</span></span></span><span style=\"top:-5.6262419999999995em;\"><span style=\"height:3.414292em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;\">∫</span><span><span><span><span style=\"height:1.414292em;\"><span style=\"top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>t</span></span></span><span style=\"top:-3.8129000000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>∞</span></span></span></span><span>​</span></span><span><span style=\"height:0.9119499999999999em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>x</span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>x</span><span>)</span><span>d</span><span>x</span></span></span><span style=\"top:-2.999999999999999em;\"><span style=\"height:3.414292em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span style=\"margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;\">∫</span><span><span><span><span style=\"height:1.414292em;\"><span style=\"top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>t</span></span></span><span style=\"top:-3.8129000000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>∞</span></span></span></span><span>​</span></span><span><span style=\"height:0.9119499999999999em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span>t</span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>x</span><span>)</span><span>d</span><span>x</span></span></span><span style=\"top:-0.37375800000000003em;\"><span style=\"height:3.414292em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>t</span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;\">∫</span><span><span><span><span style=\"height:1.414292em;\"><span style=\"top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>t</span></span></span><span style=\"top:-3.8129000000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>∞</span></span></span></span><span>​</span></span><span><span style=\"height:0.9119499999999999em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span style=\"margin-right:0.10764em;\">f</span><span>(</span><span>x</span><span>)</span><span>d</span><span>x</span></span></span><span style=\"top:1.6781919999999988em;\"><span style=\"height:3.414292em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>t</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>⋅</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>Pr</span><span>{</span><span style=\"margin-right:0.07847em;\">X</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>t</span><span>}</span></span></span></span><span>​</span></span><span><span style=\"height:5.752483999999999em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>令 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.61508em;vertical-align:0em;\"></span><span>t</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>1</span></span></span></span>：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>Pr</span><span>{</span><span style=\"margin-right:0.07847em;\">X</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1</span><span>}</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span style=\"margin-right:0.07847em;\">X</span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.00744em;vertical-align:-0.686em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>综上，当 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span></span></span></span> 时，发生碰撞的概率很小。由于键的集合 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.68333em;vertical-align:0em;\"></span><span style=\"margin-right:0.07153em;\">K</span></span></span></span> 是静态的，所以很容易找到一个不会发生碰撞的哈希函数。换句话说，当从 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.03065em;vertical-align:-0.34731999999999996em;\"></span><span><span style=\"margin-right:0.00965em;\">H</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00965em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>p</span><span><span>m</span><span><span><span><span style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.34731999999999996em;\"><span></span></span></span></span></span></span></span></span></span> 中随机挑选的哈希函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span>h</span></span></span></span> 会导致碰撞时，那么就再随机从 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1.03065em;vertical-align:-0.34731999999999996em;\"></span><span><span style=\"margin-right:0.00965em;\">H</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00965em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>p</span><span><span>m</span><span><span><span><span style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span style=\"height:0.34731999999999996em;\"><span></span></span></span></span></span></span></span></span></span> 中挑一个哈希函数。由于碰撞的概率很低，所以容易在数次挑选中找到一个不会发生碰撞的哈希函数。</p>\n<h3 id=\"定理-11-10\"> 定理 11.10</h3>\n<p>假设哈希函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span>h</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.00965em;\">H</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00965em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>p</span><span>m</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>，哈希表的大小 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>，其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 是表中存储的元素的数量。那么</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:3.2148900000000005em;vertical-align:-1.4137769999999998em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span><span><span style=\"height:1.8011130000000006em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>m</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.864108em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.1130000000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.383108em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span><span>n</span></span></span></span></span></p>\n<p>其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span> 是第 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span style=\"margin-right:0.05724em;\">j</span></span></span></span> 个槽中存储的元素数量。</p>\n<p>后续证明中会使用这个等式：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.8641079999999999em;vertical-align:0em;\"></span><span><span>a</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span>a</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span></span><span><span style=\"height:1.1111079999999998em;vertical-align:-0.247em;\"></span><span>2</span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>a</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>然后开始证明（第一步就把上式代入）：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:14.059560000000001em;vertical-align:-6.7797800000000015em;\"></span><span><span><span><span><span><span style=\"height:7.279780000000001em;\"><span style=\"top:-9.279780000000002em;\"><span style=\"height:3.801113000000001em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span><span><span style=\"height:1.8011130000000006em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>m</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.864108em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.1130000000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.383108em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-5.764890000000001em;\"><span style=\"height:3.801113000000001em;\"></span><span></span></span><span style=\"top:-2.2500000000000004em;\"><span style=\"height:3.801113000000001em;\"></span><span></span></span><span style=\"top:1.2648900000000007em;\"><span style=\"height:3.801113000000001em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:6.7797800000000015em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:7.279780000000001em;\"><span style=\"top:-9.279780000000002em;\"><span style=\"height:3.801113000000001em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span><span><span style=\"height:1.8011130000000006em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>m</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span>(</span><span><span>n</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>2</span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span>n</span><span><span><span><span style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.44432em;\"><span></span></span></span></span></span></span><span>)]</span></span></span><span style=\"top:-5.764890000000001em;\"><span style=\"height:3.801113000000001em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span><span><span style=\"height:1.8011130000000006em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>m</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>]</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>2</span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span><span><span style=\"height:1.8011130000000006em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>m</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span>n</span><span><span><span><span style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.44432em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-2.2500000000000004em;\"><span style=\"height:3.801113000000001em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span>n</span><span>]</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>2</span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span><span><span style=\"height:1.8011130000000006em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>m</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span>n</span><span><span><span><span style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.44432em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:1.2648900000000007em;\"><span style=\"height:3.801113000000001em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>2</span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span><span><span style=\"height:1.8011130000000006em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>m</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span><span>n</span><span><span><span><span style=\"height:0.3280857142857143em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span style=\"height:2.5em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.44432em;\"><span></span></span></span></span></span></span><span>]</span></span></span></span><span>​</span></span><span><span style=\"height:6.7797800000000015em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>回忆通用哈希的定义，两个键 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.03148em;\">k</span></span></span></span> 和 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.69444em;vertical-align:0em;\"></span><span style=\"margin-right:0.01968em;\">l</span></span></span></span> 被映射到同一个槽中的概率不超过 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/</span><span>m</span></span></span></span>。那么映射到同一个槽中的元素数量的最大值是：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:2.00744em;vertical-align:-0.686em;\"></span><span><span style=\"margin-right:0.07153em;\">C</span><span><span><span><span style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>n</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.247em;\"><span></span></span></span></span></span></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>m</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.113em;vertical-align:-0.686em;\"></span><span><span></span><span><span><span><span style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span><span>m</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span><span>(</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:2.00744em;vertical-align:-0.686em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span></span></span></p>\n<p>代入：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:6.51489em;vertical-align:-3.0074450000000006em;\"></span><span><span><span><span><span><span style=\"height:3.5074449999999997em;\"><span style=\"top:-5.507445000000001em;\"><span style=\"height:3.801113000000001em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span><span><span style=\"height:1.8011130000000006em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>m</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.864108em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.1130000000000004em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.383108em;\"><span></span></span></span></span></span></span><span>]</span></span></span><span style=\"top:-2.9536680000000004em;\"><span style=\"height:3.801113000000001em;\"></span><span></span></span><span style=\"top:-1.4536680000000004em;\"><span style=\"height:3.801113000000001em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:3.0074450000000006em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:3.5074449999999997em;\"><span style=\"top:-5.507445000000001em;\"><span style=\"height:3.801113000000001em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩽</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>+</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>2</span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-2.9536680000000004em;\"><span style=\"height:3.801113000000001em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>2</span><span>n</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>−</span><span style=\"margin-right:0.2222222222222222em;\"></span><span>1</span></span></span><span style=\"top:-1.4536680000000004em;\"><span style=\"height:3.801113000000001em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>2</span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:3.0074450000000006em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<h3 id=\"推论-11-11\"> 推论 11.11</h3>\n<p>假设哈希函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span>h</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.00965em;\">H</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00965em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>p</span><span>m</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>，哈希表的大小 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>，其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 是表中存储的元素的数量，而且每个二级哈希表的大小 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span><span>m</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.20888em;vertical-align:-0.394772em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-2.441336em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.394772em;\"><span></span></span></span></span></span></span></span></span></span>。那么完美哈希中所有二级哈希表的期望空间不超过 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>2</span><span>n</span></span></span></span>。</p>\n<p><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span><span>m</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.20888em;vertical-align:-0.394772em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-2.441336em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.394772em;\"><span></span></span></span></span></span></span></span></span></span>，代入上式即可证得。</p>\n<h3 id=\"推论-11-12\"> 推论 11.12</h3>\n<p>假设哈希函数 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.73354em;vertical-align:-0.0391em;\"></span><span>h</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>∈</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.969438em;vertical-align:-0.286108em;\"></span><span><span style=\"margin-right:0.00965em;\">H</span><span><span><span><span style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00965em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>p</span><span>m</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span>，哈希表的大小 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>m</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span>，其中 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.43056em;vertical-align:0em;\"></span><span>n</span></span></span></span> 是表中存储的元素的数量，而且每个二级哈希表的大小 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.716668em;vertical-align:-0.286108em;\"></span><span><span>m</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span></span><span><span style=\"height:1.20888em;vertical-align:-0.394772em;\"></span><span><span>n</span><span><span><span><span style=\"height:0.8141079999999999em;\"><span style=\"top:-2.441336em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span>2</span></span></span></span><span>​</span></span><span><span style=\"height:0.394772em;\"><span></span></span></span></span></span></span></span></span></span>。那么完美哈希中所有二级哈希表的空间等于或超过 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:0.64444em;vertical-align:0em;\"></span><span>4</span><span>n</span></span></span></span> 的概率低于 <span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:1em;vertical-align:-0.25em;\"></span><span>1/2</span></span></span></span>。</p>\n<p>使用 Markov 不等式：</p>\n<p class='katex-block'><span><span><span><i>Not supported content</i></span><span aria-hidden=\"true\"><span><span style=\"height:8.129769999999999em;vertical-align:-3.814884999999999em;\"></span><span><span><span><span><span><span style=\"height:4.314885em;\"><span style=\"top:-6.314885em;\"><span style=\"height:3.801113000000001em;\"></span><span><span>Pr</span><span>{</span><span><span><span><span style=\"height:1.8011130000000006em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.050005em;\"><span style=\"height:3.05em;\"></span><span><span>∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span style=\"height:3.05em;\"></span><span><span><span>m</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:1.4137769999999998em;\"><span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>m</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>⩾</span><span style=\"margin-right:0.2777777777777778em;\"></span><span>4</span><span>n</span><span>}</span></span></span><span style=\"top:-3.2796680000000014em;\"><span style=\"height:3.801113000000001em;\"></span><span></span></span><span style=\"top:-0.972228000000002em;\"><span style=\"height:3.801113000000001em;\"></span><span></span></span></span><span>​</span></span><span><span style=\"height:3.814884999999999em;\"><span></span></span></span></span></span><span><span><span><span style=\"height:4.314885em;\"><span style=\"top:-6.314885em;\"><span style=\"height:3.801113000000001em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.779826em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>4</span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.825818em;\"><span style=\"height:3em;\"></span><span><span style=\"margin-right:0.05764em;\">E</span><span>[</span><span><span style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span><span><span><span style=\"height:0.954008em;\"><span style=\"top:-2.40029em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span style=\"margin-right:0.05724em;\">j</span><span>=</span><span>0</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span><span>m</span><span>−</span><span>1</span></span></span></span></span><span>​</span></span><span><span style=\"height:0.43581800000000004em;\"><span></span></span></span></span></span></span><span style=\"margin-right:0.16666666666666666em;\"></span><span><span>m</span><span><span><span><span style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span style=\"height:2.7em;\"></span><span><span style=\"margin-right:0.05724em;\">j</span></span></span></span><span>​</span></span><span><span style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span>]</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-3.2796680000000014em;\"><span style=\"height:3.801113000000001em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>&lt;</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>4</span><span>n</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>2</span><span>n</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span><span style=\"top:-0.972228000000002em;\"><span style=\"height:3.801113000000001em;\"></span><span><span></span><span style=\"margin-right:0.2777777777777778em;\"></span><span>=</span><span style=\"margin-right:0.2777777777777778em;\"></span><span><span></span><span><span><span><span style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span style=\"height:3em;\"></span><span><span>2</span></span></span><span style=\"top:-3.23em;\"><span style=\"height:3em;\"></span><span style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span style=\"height:3em;\"></span><span><span>1</span></span></span></span><span>​</span></span><span><span style=\"height:0.686em;\"><span></span></span></span></span></span><span></span></span></span></span></span><span>​</span></span><span><span style=\"height:3.814884999999999em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": [
        "算法导论"
      ]
    },
    {
      "title": "Go 的正则（二）",
      "url": "https://flyginger.top/post/2021-06-14%20Go%20%E7%9A%84%E6%AD%A3%E5%88%99%EF%BC%88%E4%BA%8C%EF%BC%89/",
      "id": "https://flyginger.top/post/2021-06-14%20Go%20%E7%9A%84%E6%AD%A3%E5%88%99%EF%BC%88%E4%BA%8C%EF%BC%89/",
      "content_html": "<h1 id=\"go-的正则-二\"> Go 的正则（二）</h1>\n<p>括号的处理还没有说完。</p>\n<h2 id=\"括号\"> 括号</h2>\n<p>上次结束在 <code>collapse()</code> 方法，以下是它的源码。</p>\n<div><pre><code><span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>collapse</span><span>(</span>subs <span>[</span><span>]</span><span>*</span>Regexp<span>,</span> op Op<span>)</span> <span>*</span>Regexp <span>{</span>\n    <span>if</span> <span>len</span><span>(</span>subs<span>)</span> <span>==</span> <span>1</span> <span>{</span>\n        <span>return</span> subs<span>[</span><span>0</span><span>]</span>\n    <span>}</span>\n    re <span>:=</span> p<span>.</span><span>newRegexp</span><span>(</span>op<span>)</span>\n    re<span>.</span>Sub <span>=</span> re<span>.</span>Sub0<span>[</span><span>:</span><span>0</span><span>]</span>\n    <span>for</span> <span>_</span><span>,</span> sub <span>:=</span> <span>range</span> subs <span>{</span>\n        <span>if</span> sub<span>.</span>Op <span>==</span> op <span>{</span>\n            re<span>.</span>Sub <span>=</span> <span>append</span><span>(</span>re<span>.</span>Sub<span>,</span> sub<span>.</span>Sub<span>...</span><span>)</span>\n            p<span>.</span><span>reuse</span><span>(</span>sub<span>)</span>\n        <span>}</span> <span>else</span> <span>{</span>\n            re<span>.</span>Sub <span>=</span> <span>append</span><span>(</span>re<span>.</span>Sub<span>,</span> sub<span>)</span>\n        <span>}</span>\n    <span>}</span>\n    <span>if</span> op <span>==</span> OpAlternate <span>{</span>\n        re<span>.</span>Sub <span>=</span> p<span>.</span><span>factor</span><span>(</span>re<span>.</span>Sub<span>)</span>\n        <span>if</span> <span>len</span><span>(</span>re<span>.</span>Sub<span>)</span> <span>==</span> <span>1</span> <span>{</span>\n            old <span>:=</span> re\n            re <span>=</span> re<span>.</span>Sub<span>[</span><span>0</span><span>]</span>\n            p<span>.</span><span>reuse</span><span>(</span>old<span>)</span>\n        <span>}</span>\n    <span>}</span>\n    <span>return</span> re\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br></div></div><p>前几行很好理解，先是处理了一种特殊情况。只有一个子表达式时，不需要任何操作，所以直接返回该表达式本身。有多个表达式时，创建了一个新的节点 <code>re</code> 。</p>\n<p>接下来是一个 <code>for</code> 循环。对于每一个子表达式 <code>sub</code> ，如果 <code>sub</code> 也是同样操作的节点， <code>sub.Op == op</code> ，那么 <code>sub</code> 会被分解， <code>sub</code> 的子表达式会被放入 <code>re</code> 中， <code>sub</code> 本身会被丢弃（使用 <code>reuse()</code> 进行废物利用）。如果 <code>sub</code> 不是同样操作的节点，那么直接把 <code>sub</code> 本身放入 <code>re</code> 中。现在还看不出来， <code>sub</code> 的子表达式不会仍然是一个同样操作的节点。</p>\n<p>如果需要进行的操作是选择操作，那么还需要进行进一步处理。首先， <code>collapse()</code> 调用了 <code>factor()</code> 方法。 <code>factor()</code> 方法能够提取各个选项之间的公共（或者部分公共）前缀，从而提升效率。举个例子，原来的表达式是 <code>ABC|ABD|AEF|BCX|BCY</code> ，那么经过处理之后应该是 <code>A(B(C|D)|EF)|BC(X|Y)</code> 。</p>\n<p><code>factor()</code> 方法有接近 200 行，读起来估计不容易，提取公共前缀这个操作本身实现起来也很麻烦。因此这次不会一次性贴出所有代码。</p>\n<div><pre><code><span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>factor</span><span>(</span>sub <span>[</span><span>]</span><span>*</span>Regexp<span>)</span> <span>[</span><span>]</span><span>*</span>Regexp <span>{</span>\n    <span>if</span> <span>len</span><span>(</span>sub<span>)</span> <span>&lt;</span> <span>2</span> <span>{</span>\n        <span>return</span> sub\n    <span>}</span>\n    <span>// to be continued...</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br></div></div><p>这一段看得懂，又是特殊情况的处理。子表达式的数量小于 2 时，不需要提取公共前缀。</p>\n<div><pre><code>    <span>// Round 1: Factor out common literal prefixes.</span>\n    <span>var</span> str <span>[</span><span>]</span><span>rune</span>\n    <span>var</span> strflags Flags\n    start <span>:=</span> <span>0</span>\n    out <span>:=</span> sub<span>[</span><span>:</span><span>0</span><span>]</span>\n    <span>for</span> i <span>:=</span> <span>0</span><span>;</span> i <span>&lt;=</span> <span>len</span><span>(</span>sub<span>)</span><span>;</span> i<span>++</span> <span>{</span>\n        <span>// Invariant: the Regexps that were in sub[0:start] have been</span>\n        <span>// used or marked for reuse, and the slice space has been reused</span>\n        <span>// for out (len(out) &lt;= start).</span>\n        <span>//</span>\n        <span>// Invariant: sub[start:i] consists of regexps that all begin</span>\n        <span>// with str as modified by strflags.</span>\n        <span>var</span> istr <span>[</span><span>]</span><span>rune</span>\n        <span>var</span> iflags Flags\n        <span>if</span> i <span>&lt;</span> <span>len</span><span>(</span>sub<span>)</span> <span>{</span>\n            istr<span>,</span> iflags <span>=</span> p<span>.</span><span>leadingString</span><span>(</span>sub<span>[</span>i<span>]</span><span>)</span>\n            <span>if</span> iflags <span>==</span> strflags <span>{</span>\n                same <span>:=</span> <span>0</span>\n                <span>for</span> same <span>&lt;</span> <span>len</span><span>(</span>str<span>)</span> <span>&amp;&amp;</span> same <span>&lt;</span> <span>len</span><span>(</span>istr<span>)</span> <span>&amp;&amp;</span> str<span>[</span>same<span>]</span> <span>==</span> istr<span>[</span>same<span>]</span> <span>{</span>\n                    same<span>++</span>\n                <span>}</span>\n                <span>if</span> same <span>></span> <span>0</span> <span>{</span>\n                    <span>// Matches at least one rune in current range.</span>\n                    <span>// Keep going around.</span>\n                    str <span>=</span> str<span>[</span><span>:</span>same<span>]</span>\n                    <span>continue</span>\n                <span>}</span>\n            <span>}</span>\n        <span>}</span>\n        <span>// to be continued...</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br></div></div><p>注意上面的代码只是 <code>for</code> 循环的一部分， <code>for</code> 循环还没有结束。不过注释还是很有帮助的。第一轮，提取公共字面量前缀。注释中的 <code>Invariant</code> 指的是循环不变性，有些算法书，比如 <em>Introduction to Algorithms</em> 中有讲过。循环不变性说的是在循环中保持不变的性质。所以这些注释对于看懂代码至关重要，现在马上来做阅读理解。</p>\n<p>首先， <code>sub[0:start]</code> 是检查过、不会再用的节点，但是还留在 <code>sub</code> 中等着废物利用。而 <code>out</code> 是 <code>sub[:len(out)]</code> ，并且保证 <code>len(out) &lt;= start</code> 。 <code>out</code> 中是已经被重新利用的废物节点。其次， <code>sub[start:i]</code> 中是以 <code>str</code> 为前缀的表达式。关于 <code>strflags</code> 的部分，目前还不知道其作用。</p>\n<p>大 <code>for</code> 循环的条件是 <code>i &lt;= len(sub)</code> 。现在还不知道 <code>=</code> 的意义，不过这一段显然与 <code>=</code> 无关，当 <code>i &lt; len(sub)</code> 时才需要执行这段内容，里面首先调用了 <code>leadingString()</code> 。</p>\n<div><pre><code><span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>leadingString</span><span>(</span>re <span>*</span>Regexp<span>)</span> <span>(</span><span>[</span><span>]</span><span>rune</span><span>,</span> Flags<span>)</span> <span>{</span>\n    <span>if</span> re<span>.</span>Op <span>==</span> OpConcat <span>&amp;&amp;</span> <span>len</span><span>(</span>re<span>.</span>Sub<span>)</span> <span>></span> <span>0</span> <span>{</span>\n        re <span>=</span> re<span>.</span>Sub<span>[</span><span>0</span><span>]</span>\n    <span>}</span>\n    <span>if</span> re<span>.</span>Op <span>!=</span> OpLiteral <span>{</span>\n        <span>return</span> <span>nil</span><span>,</span> <span>0</span>\n    <span>}</span>\n    <span>return</span> re<span>.</span>Rune<span>,</span> re<span>.</span>Flags <span>&amp;</span> FoldCase\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></div></div><p>如果节点 <code>re</code> 是多个节点的连接（ <code>re.Op == OpConcat</code> ），那么 <code>leadingString()</code> 会尝试读取 <code>re</code> 的第一个子表达式。然后，如果 <code>re</code> 不是字面量类型的节点，那么直接返回空。否则，返回节点中保存的字面量，以及大小写是否敏感的配置信息。</p>\n<p>回到 <code>factor()</code> 函数，继续读代码。如果当前子表达式的大小写敏感配置信息（ <code>iflags</code> ）与记录的相同（ <code>strflags</code> ）相同，那么继续检查字符串的具体内容，找出当前表达式的内容 <code>istr</code> 与 <code>str</code> 的最长的公共前缀。</p>\n<p>如果最长公共前缀的长度大于零，那么直接跳到下次循环，否则继续执行下面的代码。问题在于，第一次执行循环时， <code>str</code> 为空，必定需要执行后面的代码。</p>\n<div><pre><code>        <span>// Found end of a run with common leading literal string:</span>\n        <span>// sub[start:i] all begin with str[0:len(str)], but sub[i]</span>\n        <span>// does not even begin with str[0].</span>\n        <span>//</span>\n        <span>// Factor out common string and append factored expression to out.</span>\n        <span>if</span> i <span>==</span> start <span>{</span>\n            <span>// Nothing to do - run of length 0.</span>\n        <span>}</span> <span>else</span> <span>if</span> i <span>==</span> start<span>+</span><span>1</span> <span>{</span>\n            <span>// Just one: don't bother factoring.</span>\n            out <span>=</span> <span>append</span><span>(</span>out<span>,</span> sub<span>[</span>start<span>]</span><span>)</span>\n        <span>}</span> <span>else</span> <span>{</span>\n            <span>// Construct factored form: prefix(suffix1|suffix2|...)</span>\n            prefix <span>:=</span> p<span>.</span><span>newRegexp</span><span>(</span>OpLiteral<span>)</span>\n            prefix<span>.</span>Flags <span>=</span> strflags\n            prefix<span>.</span>Rune <span>=</span> <span>append</span><span>(</span>prefix<span>.</span>Rune<span>[</span><span>:</span><span>0</span><span>]</span><span>,</span> str<span>...</span><span>)</span>\n\n            <span>for</span> j <span>:=</span> start<span>;</span> j <span>&lt;</span> i<span>;</span> j<span>++</span> <span>{</span>\n                sub<span>[</span>j<span>]</span> <span>=</span> p<span>.</span><span>removeLeadingString</span><span>(</span>sub<span>[</span>j<span>]</span><span>,</span> <span>len</span><span>(</span>str<span>)</span><span>)</span>\n            <span>}</span>\n            suffix <span>:=</span> p<span>.</span><span>collapse</span><span>(</span>sub<span>[</span>start<span>:</span>i<span>]</span><span>,</span> OpAlternate<span>)</span> <span>// recurse</span>\n\n            re <span>:=</span> p<span>.</span><span>newRegexp</span><span>(</span>OpConcat<span>)</span>\n            re<span>.</span>Sub <span>=</span> <span>append</span><span>(</span>re<span>.</span>Sub<span>[</span><span>:</span><span>0</span><span>]</span><span>,</span> prefix<span>,</span> suffix<span>)</span>\n            out <span>=</span> <span>append</span><span>(</span>out<span>,</span> re<span>)</span>\n        <span>}</span>\n\n        <span>// Prepare for next iteration.</span>\n        start <span>=</span> i\n        str <span>=</span> istr\n        strflags <span>=</span> iflags\n    <span>}</span>\n    sub <span>=</span> out\n    <span>// to be continued...</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br></div></div><p>回忆前面的代码，当节点之间存在公共前缀时，就会使用 <code>continue</code> 语句跳过后面的部分，继续检查后面的节点是否与之前和节点之间存在公共前缀。总而言之，执行上面代码的条件有三种：第一，第一次循环，由于 <code>str</code> 为空，所以不存在公共前缀；第二，找到了一批节点，它们之间有公共前缀，然后遇到了一个与这批节点之间没有公共前缀的节点；第三，最后一次循环， <code>i == len(subs)</code> 。如果归纳一下，可以发现第一种和第三种其实都是第二种的特殊情况。</p>\n<p>彻底地归纳一下，每次执行到这里，都是因为 <code>subs[i]</code> 和 <code>sub[start:i]</code> 没有公共的前缀（或者是因为 <code>i == len(subs)</code> ）。</p>\n<p>于是此时分了三种情况，分别是 <code>if</code> 的三个分支。第一种情况，是 <code>sub[start:i]</code> 为空，也就是 <code>i == start</code> 。这种情况只可能发生在 <code>i == 0</code> 时，程序什么都不做，直接跳到 <code>if</code> 之后。</p>\n<p>第二种情况是 <code>sub[start:i]</code> 的长度为 1 ，此时不需要进行什么操作，直接把 <code>sub[start]</code> 放入了 <code>out</code> 中。此时浪费掉了一个节点的空间没有进行废物利用，可能是不值得吧。</p>\n<p>第三种情况是 <code>sub[start:i]</code> 的长度大于 1 。首先创建一个字面量节点 <code>prefix</code> ，然后通过 <code>removeLeadingString()</code> 把 <code>sub[start:i]</code> 中节点中的公共前缀 <code>str</code> 删掉。</p>\n<div><pre><code><span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>removeLeadingString</span><span>(</span>re <span>*</span>Regexp<span>,</span> n <span>int</span><span>)</span> <span>*</span>Regexp <span>{</span>\n    <span>if</span> re<span>.</span>Op <span>==</span> OpConcat <span>&amp;&amp;</span> <span>len</span><span>(</span>re<span>.</span>Sub<span>)</span> <span>></span> <span>0</span> <span>{</span>\n        <span>// Removing a leading string in a concatenation</span>\n        <span>// might simplify the concatenation.</span>\n        sub <span>:=</span> re<span>.</span>Sub<span>[</span><span>0</span><span>]</span>\n        sub <span>=</span> p<span>.</span><span>removeLeadingString</span><span>(</span>sub<span>,</span> n<span>)</span>\n        re<span>.</span>Sub<span>[</span><span>0</span><span>]</span> <span>=</span> sub\n        <span>if</span> sub<span>.</span>Op <span>==</span> OpEmptyMatch <span>{</span>\n            p<span>.</span><span>reuse</span><span>(</span>sub<span>)</span>\n            <span>switch</span> <span>len</span><span>(</span>re<span>.</span>Sub<span>)</span> <span>{</span>\n            <span>case</span> <span>0</span><span>,</span> <span>1</span><span>:</span>\n                <span>// Impossible but handle.</span>\n                re<span>.</span>Op <span>=</span> OpEmptyMatch\n                re<span>.</span>Sub <span>=</span> <span>nil</span>\n            <span>case</span> <span>2</span><span>:</span>\n                old <span>:=</span> re\n                re <span>=</span> re<span>.</span>Sub<span>[</span><span>1</span><span>]</span>\n                p<span>.</span><span>reuse</span><span>(</span>old<span>)</span>\n            <span>default</span><span>:</span>\n                <span>copy</span><span>(</span>re<span>.</span>Sub<span>,</span> re<span>.</span>Sub<span>[</span><span>1</span><span>:</span><span>]</span><span>)</span>\n                re<span>.</span>Sub <span>=</span> re<span>.</span>Sub<span>[</span><span>:</span><span>len</span><span>(</span>re<span>.</span>Sub<span>)</span><span>-</span><span>1</span><span>]</span>\n            <span>}</span>\n        <span>}</span>\n        <span>return</span> re\n    <span>}</span>\n\n    <span>if</span> re<span>.</span>Op <span>==</span> OpLiteral <span>{</span>\n        re<span>.</span>Rune <span>=</span> re<span>.</span>Rune<span>[</span><span>:</span><span>copy</span><span>(</span>re<span>.</span>Rune<span>,</span> re<span>.</span>Rune<span>[</span>n<span>:</span><span>]</span><span>)</span><span>]</span>\n        <span>if</span> <span>len</span><span>(</span>re<span>.</span>Rune<span>)</span> <span>==</span> <span>0</span> <span>{</span>\n            re<span>.</span>Op <span>=</span> OpEmptyMatch\n        <span>}</span>\n    <span>}</span>\n    <span>return</span> re\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br></div></div><p>从一个节点中删除前缀也不是那么容易。 <code>re</code> 如果是 <code>OpConcat</code> 类型的节点，那么 <code>re</code> 会有数个需要连接到一起的子节点。 <code>removeLeadingString()</code> 通过递归调用从 <code>re</code> 的第一个子节点 <code>re.sub[0]</code> 中删除前缀。公共前缀来源决定了其长度不可能超过第一个子节点中保存的字面量的长度。</p>\n<p>如果 <code>re.sub[0]</code> 中的所有字面量都被删掉了，那么它会被改成 <code>OpEmptyMatch</code> 类型。如果 <code>removeLeadingString()</code> 发现递归调用返回了一个 <code>OpEmptyMatch</code> 类型的节点，那么还需要去掉该 <code>OpEmptyMatch</code> 节点。</p>\n<p>这又分为三种情况，第一种情况是 <code>len(re.sub) == 0</code> 或 <code>len(re.sub) == 1</code> 。根据注释，这应该是不可能的。如果 <code>len(re.sub) == 0</code> ，上面直接访问 <code>re.sub[0]</code> 的代码会直接报错。如果 <code>len(re.sub) == 1</code> ，相当于需要被连接在一起的节点仅有一个，那么 <code>re</code> 根本就是多余的，可以用 <code>re.sub[0]</code> 直接替换 <code>re</code> 的位置。我猜 Go 的实现不会允许这样浪费的情况存在。</p>\n<p>第二种情况是 <code>len(re.sub) == 2</code> ， <code>removeLeadingString()</code> 会回收 <code>re</code> 和 <code>re.sub[0]</code> ，然后用 <code>re.sub[1]</code> 替换 <code>re</code> 原来的位置。第三种情况， <code>removeLeadingString()</code> 会把 <code>re.sub</code> 中的内容往前复制一个位置，然后把 <code>re.sub</code> 的长度缩小  1 。这又是一种避免内存操作的技巧。</p>\n<p>后面的 <code>if</code> 处理的是 <code>re</code> 是 <code>OpLiteral</code> 字面量类型的情况。比较简单就不解释了。回到 <code>factor()</code> 方法，它使用 <code>collapse()</code> 方法把所有剩下的后缀选择在一起。递归啦。</p>\n<p>做完这些以后， <code>factor()</code> 创建了一个 <code>OpConcat</code> 类型的新节点，把公共前缀和选择好的后缀装进去。最后，把新节点放入 <code>out</code> 中。所以 <code>out</code> 只是复用了数组的位置，并没有复用其中的节点。节点还是通过 <code>reuse()</code> 来废物利用的。</p>\n<p>最后是一些为下一次迭代做准备的操作。循环结束后，令 <code>sub = out</code> ，公共前缀就提取好了。问题是，不连续存在的分支的公共前缀并没有被提取到，例如 <code>ABC|XYZ|ABD</code> ，第一个和第三个的公共前缀并不会被提取到，因为它们之间隔了一个和它们之间不存在公共前缀的选项。</p>\n<div><pre><code>    <span>// Round 2: Factor out common simple prefixes,</span>\n    <span>// just the first piece of each concatenation.</span>\n    <span>// This will be good enough a lot of the time.</span>\n    <span>//</span>\n    <span>// Complex subexpressions (e.g. involving quantifiers)</span>\n    <span>// are not safe to factor because that collapses their</span>\n    <span>// distinct paths through the automaton, which affects</span>\n    <span>// correctness in some cases.</span>\n    start <span>=</span> <span>0</span>\n    out <span>=</span> sub<span>[</span><span>:</span><span>0</span><span>]</span>\n    <span>var</span> first <span>*</span>Regexp\n    <span>for</span> i <span>:=</span> <span>0</span><span>;</span> i <span>&lt;=</span> <span>len</span><span>(</span>sub<span>)</span><span>;</span> i<span>++</span> <span>{</span>\n        <span>// Invariant: the Regexps that were in sub[0:start] have been</span>\n        <span>// used or marked for reuse, and the slice space has been reused</span>\n        <span>// for out (len(out) &lt;= start).</span>\n        <span>//</span>\n        <span>// Invariant: sub[start:i] consists of regexps that all begin with ifirst.</span>\n        <span>var</span> ifirst <span>*</span>Regexp\n        <span>if</span> i <span>&lt;</span> <span>len</span><span>(</span>sub<span>)</span> <span>{</span>\n            ifirst <span>=</span> p<span>.</span><span>leadingRegexp</span><span>(</span>sub<span>[</span>i<span>]</span><span>)</span>\n            <span>if</span> first <span>!=</span> <span>nil</span> <span>&amp;&amp;</span> first<span>.</span><span>Equal</span><span>(</span>ifirst<span>)</span> <span>&amp;&amp;</span>\n                <span>// first must be a character class OR a fixed repeat of a character class.</span>\n                <span>(</span><span>isCharClass</span><span>(</span>first<span>)</span> <span>||</span> <span>(</span>first<span>.</span>Op <span>==</span> OpRepeat <span>&amp;&amp;</span> first<span>.</span>Min <span>==</span> first<span>.</span>Max <span>&amp;&amp;</span> <span>isCharClass</span><span>(</span>first<span>.</span>Sub<span>[</span><span>0</span><span>]</span><span>)</span><span>)</span><span>)</span> <span>{</span>\n                <span>continue</span>\n            <span>}</span>\n        <span>}</span>\n        <span>// to be continued...</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br></div></div><p>第二轮开始了，这次提取的是公共简单前缀，不一定是字面量。 <code>start</code> 、 <code>out</code> 等的作用和上面的还是一样。循环不变性也基本没变。这次寻找前缀时使用的方法是 <code>leadingRegexp()</code> 。</p>\n<div><pre><code><span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>leadingRegexp</span><span>(</span>re <span>*</span>Regexp<span>)</span> <span>*</span>Regexp <span>{</span>\n    <span>if</span> re<span>.</span>Op <span>==</span> OpEmptyMatch <span>{</span>\n        <span>return</span> <span>nil</span>\n    <span>}</span>\n    <span>if</span> re<span>.</span>Op <span>==</span> OpConcat <span>&amp;&amp;</span> <span>len</span><span>(</span>re<span>.</span>Sub<span>)</span> <span>></span> <span>0</span> <span>{</span>\n        sub <span>:=</span> re<span>.</span>Sub<span>[</span><span>0</span><span>]</span>\n        <span>if</span> sub<span>.</span>Op <span>==</span> OpEmptyMatch <span>{</span>\n            <span>return</span> <span>nil</span>\n        <span>}</span>\n        <span>return</span> sub\n    <span>}</span>\n    <span>return</span> re\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br></div></div><p>总的来说， <code>leadingRegexp()</code> 的思路是这样：首先选出一个候选者，如果 <code>re</code> 是 <code>OpConcat</code> 类型并且有子表达式，那么候选者是第一个子表达式；否则候选者是 <code>re</code> 自己。然后，如果候选者是 <code>OpEmptyMatch</code> 类型，那么返回 <code>nil</code> ，否则返回候选者。</p>\n<p>接下来的判断说明，公共简单前缀只能是字符类类型，或者重复次数固定的字符类类型。这个判断中，还调用了 <code>Regexp</code> 的 <code>equal()</code> 方法，判断两个节点的内容是否相同。</p>\n<div><pre><code><span>func</span> <span>(</span>x <span>*</span>Regexp<span>)</span> <span>Equal</span><span>(</span>y <span>*</span>Regexp<span>)</span> <span>bool</span> <span>{</span>\n    <span>if</span> x <span>==</span> <span>nil</span> <span>||</span> y <span>==</span> <span>nil</span> <span>{</span>\n        <span>return</span> x <span>==</span> y\n    <span>}</span>\n    <span>if</span> x<span>.</span>Op <span>!=</span> y<span>.</span>Op <span>{</span>\n        <span>return</span> <span>false</span>\n    <span>}</span>\n    <span>switch</span> x<span>.</span>Op <span>{</span>\n    <span>case</span> OpEndText<span>:</span>\n        <span>// The parse flags remember whether this is \\z or \\Z.</span>\n        <span>if</span> x<span>.</span>Flags<span>&amp;</span>WasDollar <span>!=</span> y<span>.</span>Flags<span>&amp;</span>WasDollar <span>{</span>\n            <span>return</span> <span>false</span>\n        <span>}</span>\n\n    <span>case</span> OpLiteral<span>,</span> OpCharClass<span>:</span>\n        <span>if</span> <span>len</span><span>(</span>x<span>.</span>Rune<span>)</span> <span>!=</span> <span>len</span><span>(</span>y<span>.</span>Rune<span>)</span> <span>{</span>\n            <span>return</span> <span>false</span>\n        <span>}</span>\n        <span>for</span> i<span>,</span> r <span>:=</span> <span>range</span> x<span>.</span>Rune <span>{</span>\n            <span>if</span> r <span>!=</span> y<span>.</span>Rune<span>[</span>i<span>]</span> <span>{</span>\n                <span>return</span> <span>false</span>\n            <span>}</span>\n        <span>}</span>\n\n    <span>case</span> OpAlternate<span>,</span> OpConcat<span>:</span>\n        <span>if</span> <span>len</span><span>(</span>x<span>.</span>Sub<span>)</span> <span>!=</span> <span>len</span><span>(</span>y<span>.</span>Sub<span>)</span> <span>{</span>\n            <span>return</span> <span>false</span>\n        <span>}</span>\n        <span>for</span> i<span>,</span> sub <span>:=</span> <span>range</span> x<span>.</span>Sub <span>{</span>\n            <span>if</span> <span>!</span>sub<span>.</span><span>Equal</span><span>(</span>y<span>.</span>Sub<span>[</span>i<span>]</span><span>)</span> <span>{</span>\n                <span>return</span> <span>false</span>\n            <span>}</span>\n        <span>}</span>\n\n    <span>case</span> OpStar<span>,</span> OpPlus<span>,</span> OpQuest<span>:</span>\n        <span>if</span> x<span>.</span>Flags<span>&amp;</span>NonGreedy <span>!=</span> y<span>.</span>Flags<span>&amp;</span>NonGreedy <span>||</span> <span>!</span>x<span>.</span>Sub<span>[</span><span>0</span><span>]</span><span>.</span><span>Equal</span><span>(</span>y<span>.</span>Sub<span>[</span><span>0</span><span>]</span><span>)</span> <span>{</span>\n            <span>return</span> <span>false</span>\n        <span>}</span>\n\n    <span>case</span> OpRepeat<span>:</span>\n        <span>if</span> x<span>.</span>Flags<span>&amp;</span>NonGreedy <span>!=</span> y<span>.</span>Flags<span>&amp;</span>NonGreedy <span>||</span> x<span>.</span>Min <span>!=</span> y<span>.</span>Min <span>||</span> x<span>.</span>Max <span>!=</span> y<span>.</span>Max <span>||</span> <span>!</span>x<span>.</span>Sub<span>[</span><span>0</span><span>]</span><span>.</span><span>Equal</span><span>(</span>y<span>.</span>Sub<span>[</span><span>0</span><span>]</span><span>)</span> <span>{</span>\n            <span>return</span> <span>false</span>\n        <span>}</span>\n\n    <span>case</span> OpCapture<span>:</span>\n        <span>if</span> x<span>.</span>Cap <span>!=</span> y<span>.</span>Cap <span>||</span> x<span>.</span>Name <span>!=</span> y<span>.</span>Name <span>||</span> <span>!</span>x<span>.</span>Sub<span>[</span><span>0</span><span>]</span><span>.</span><span>Equal</span><span>(</span>y<span>.</span>Sub<span>[</span><span>0</span><span>]</span><span>)</span> <span>{</span>\n            <span>return</span> <span>false</span>\n        <span>}</span>\n    <span>}</span>\n    <span>return</span> <span>true</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br></div></div><p>这段代码很长，但是逻辑比较简单，就不详细看了。</p>\n<div><pre><code>        <span>// Found end of a run with common leading regexp:</span>\n        <span>// sub[start:i] all begin with first but sub[i] does not.</span>\n        <span>//</span>\n        <span>// Factor out common regexp and append factored expression to out.</span>\n        <span>if</span> i <span>==</span> start <span>{</span>\n            <span>// Nothing to do - run of length 0.</span>\n        <span>}</span> <span>else</span> <span>if</span> i <span>==</span> start<span>+</span><span>1</span> <span>{</span>\n            <span>// Just one: don't bother factoring.</span>\n            out <span>=</span> <span>append</span><span>(</span>out<span>,</span> sub<span>[</span>start<span>]</span><span>)</span>\n        <span>}</span> <span>else</span> <span>{</span>\n            <span>// Construct factored form: prefix(suffix1|suffix2|...)</span>\n            prefix <span>:=</span> first\n            <span>for</span> j <span>:=</span> start<span>;</span> j <span>&lt;</span> i<span>;</span> j<span>++</span> <span>{</span>\n                reuse <span>:=</span> j <span>!=</span> start <span>// prefix came from sub[start]</span>\n                sub<span>[</span>j<span>]</span> <span>=</span> p<span>.</span><span>removeLeadingRegexp</span><span>(</span>sub<span>[</span>j<span>]</span><span>,</span> reuse<span>)</span>\n            <span>}</span>\n            suffix <span>:=</span> p<span>.</span><span>collapse</span><span>(</span>sub<span>[</span>start<span>:</span>i<span>]</span><span>,</span> OpAlternate<span>)</span> <span>// recurse</span>\n\n            re <span>:=</span> p<span>.</span><span>newRegexp</span><span>(</span>OpConcat<span>)</span>\n            re<span>.</span>Sub <span>=</span> <span>append</span><span>(</span>re<span>.</span>Sub<span>[</span><span>:</span><span>0</span><span>]</span><span>,</span> prefix<span>,</span> suffix<span>)</span>\n            out <span>=</span> <span>append</span><span>(</span>out<span>,</span> re<span>)</span>\n        <span>}</span>\n\n        <span>// Prepare for next iteration.</span>\n        start <span>=</span> i\n        first <span>=</span> ifirst\n    <span>}</span>\n    sub <span>=</span> out\n    <span>// to be continued...</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br></div></div><p>这段和上一轮逻辑重复了，不再重新说一遍了。但是去除公共简单前缀用的是 <code>removeLeadingRegexp()</code> ，这个方法不同，所以还是看一下下。</p>\n<div><pre><code><span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>removeLeadingRegexp</span><span>(</span>re <span>*</span>Regexp<span>,</span> reuse <span>bool</span><span>)</span> <span>*</span>Regexp <span>{</span>\n    <span>if</span> re<span>.</span>Op <span>==</span> OpConcat <span>&amp;&amp;</span> <span>len</span><span>(</span>re<span>.</span>Sub<span>)</span> <span>></span> <span>0</span> <span>{</span>\n        <span>if</span> reuse <span>{</span>\n            p<span>.</span><span>reuse</span><span>(</span>re<span>.</span>Sub<span>[</span><span>0</span><span>]</span><span>)</span>\n        <span>}</span>\n        re<span>.</span>Sub <span>=</span> re<span>.</span>Sub<span>[</span><span>:</span><span>copy</span><span>(</span>re<span>.</span>Sub<span>,</span> re<span>.</span>Sub<span>[</span><span>1</span><span>:</span><span>]</span><span>)</span><span>]</span>\n        <span>switch</span> <span>len</span><span>(</span>re<span>.</span>Sub<span>)</span> <span>{</span>\n        <span>case</span> <span>0</span><span>:</span>\n            re<span>.</span>Op <span>=</span> OpEmptyMatch\n            re<span>.</span>Sub <span>=</span> <span>nil</span>\n        <span>case</span> <span>1</span><span>:</span>\n            old <span>:=</span> re\n            re <span>=</span> re<span>.</span>Sub<span>[</span><span>0</span><span>]</span>\n            p<span>.</span><span>reuse</span><span>(</span>old<span>)</span>\n        <span>}</span>\n        <span>return</span> re\n    <span>}</span>\n    <span>if</span> reuse <span>{</span>\n        p<span>.</span><span>reuse</span><span>(</span>re<span>)</span>\n    <span>}</span>\n    <span>return</span> p<span>.</span><span>newRegexp</span><span>(</span>OpEmptyMatch<span>)</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br></div></div><p>这次加了一个开关 <code>reuse := j != start</code> ，也就是说 <code>j == start</code> 的时候不要把传进去的节点回收掉。原因已经写在注释里了，公共简单前缀就来自于 <code>sub[start]</code> 这个节点，回收掉就麻烦了。结果 <code>removeLeadingRegexp()</code> 挺简单的，没什么好看的。</p>\n<div><pre><code>    <span>// Round 3: Collapse runs of single literals into character classes.</span>\n    start <span>=</span> <span>0</span>\n    out <span>=</span> sub<span>[</span><span>:</span><span>0</span><span>]</span>\n    <span>for</span> i <span>:=</span> <span>0</span><span>;</span> i <span>&lt;=</span> <span>len</span><span>(</span>sub<span>)</span><span>;</span> i<span>++</span> <span>{</span>\n        <span>// Invariant: the Regexps that were in sub[0:start] have been</span>\n        <span>// used or marked for reuse, and the slice space has been reused</span>\n        <span>// for out (len(out) &lt;= start).</span>\n        <span>//</span>\n        <span>// Invariant: sub[start:i] consists of regexps that are either</span>\n        <span>// literal runes or character classes.</span>\n        <span>if</span> i <span>&lt;</span> <span>len</span><span>(</span>sub<span>)</span> <span>&amp;&amp;</span> <span>isCharClass</span><span>(</span>sub<span>[</span>i<span>]</span><span>)</span> <span>{</span>\n            <span>continue</span>\n        <span>}</span>\n\n        <span>// sub[i] is not a char or char class;</span>\n        <span>// emit char class for sub[start:i]...</span>\n        <span>if</span> i <span>==</span> start <span>{</span>\n            <span>// Nothing to do - run of length 0.</span>\n        <span>}</span> <span>else</span> <span>if</span> i <span>==</span> start<span>+</span><span>1</span> <span>{</span>\n            out <span>=</span> <span>append</span><span>(</span>out<span>,</span> sub<span>[</span>start<span>]</span><span>)</span>\n        <span>}</span> <span>else</span> <span>{</span>\n            <span>// Make new char class.</span>\n            <span>// Start with most complex regexp in sub[start].</span>\n            max <span>:=</span> start\n            <span>for</span> j <span>:=</span> start <span>+</span> <span>1</span><span>;</span> j <span>&lt;</span> i<span>;</span> j<span>++</span> <span>{</span>\n                <span>if</span> sub<span>[</span>max<span>]</span><span>.</span>Op <span>&lt;</span> sub<span>[</span>j<span>]</span><span>.</span>Op <span>||</span> sub<span>[</span>max<span>]</span><span>.</span>Op <span>==</span> sub<span>[</span>j<span>]</span><span>.</span>Op <span>&amp;&amp;</span> <span>len</span><span>(</span>sub<span>[</span>max<span>]</span><span>.</span>Rune<span>)</span> <span>&lt;</span> <span>len</span><span>(</span>sub<span>[</span>j<span>]</span><span>.</span>Rune<span>)</span> <span>{</span>\n                    max <span>=</span> j\n                <span>}</span>\n            <span>}</span>\n            sub<span>[</span>start<span>]</span><span>,</span> sub<span>[</span>max<span>]</span> <span>=</span> sub<span>[</span>max<span>]</span><span>,</span> sub<span>[</span>start<span>]</span>\n\n            <span>for</span> j <span>:=</span> start <span>+</span> <span>1</span><span>;</span> j <span>&lt;</span> i<span>;</span> j<span>++</span> <span>{</span>\n                <span>mergeCharClass</span><span>(</span>sub<span>[</span>start<span>]</span><span>,</span> sub<span>[</span>j<span>]</span><span>)</span>\n                p<span>.</span><span>reuse</span><span>(</span>sub<span>[</span>j<span>]</span><span>)</span>\n            <span>}</span>\n            <span>cleanAlt</span><span>(</span>sub<span>[</span>start<span>]</span><span>)</span>\n            out <span>=</span> <span>append</span><span>(</span>out<span>,</span> sub<span>[</span>start<span>]</span><span>)</span>\n        <span>}</span>\n\n        <span>// ... and then emit sub[i].</span>\n        <span>if</span> i <span>&lt;</span> <span>len</span><span>(</span>sub<span>)</span> <span>{</span>\n            out <span>=</span> <span>append</span><span>(</span>out<span>,</span> sub<span>[</span>i<span>]</span><span>)</span>\n        <span>}</span>\n        start <span>=</span> i <span>+</span> <span>1</span>\n    <span>}</span>\n    sub <span>=</span> out\n    <span>// to be continued...</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br></div></div><p>回到 <code>factor()</code> ，继续看第三轮。第三轮的目的是把连续的字面量和字符类节点合并。 <code>start</code> 、 <code>out</code> 和循环不变性的作用都基本没变。 <code>factor()</code> 使用了 <code>isCharClass()</code> 函数检查节点是不是字符类。</p>\n<div><pre><code><span>func</span> <span>isCharClass</span><span>(</span>re <span>*</span>Regexp<span>)</span> <span>bool</span> <span>{</span>\n    <span>return</span> re<span>.</span>Op <span>==</span> OpLiteral <span>&amp;&amp;</span> <span>len</span><span>(</span>re<span>.</span>Rune<span>)</span> <span>==</span> <span>1</span> <span>||</span>\n        re<span>.</span>Op <span>==</span> OpCharClass <span>||</span>\n        re<span>.</span>Op <span>==</span> OpAnyCharNotNL <span>||</span>\n        re<span>.</span>Op <span>==</span> OpAnyChar\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br></div></div><p>后面的 <code>if</code> 分支又是那么的熟悉，主要是看 <code>else</code> 分支。首先它遍历了找到的节点，寻找类型值最大的。合理猜测，字符类范围越大的类型值可能也是越大。</p>\n<div><pre><code><span>const</span> <span>(</span>\n    OpNoMatch        Op <span>=</span> <span>1</span> <span>+</span> <span>iota</span> <span>// matches no strings</span>\n    OpEmptyMatch                   <span>// matches empty string</span>\n    OpLiteral                      <span>// matches Runes sequence</span>\n    OpCharClass                    <span>// matches Runes interpreted as range pair list</span>\n    OpAnyCharNotNL                 <span>// matches any character except newline</span>\n    OpAnyChar                      <span>// matches any character</span>\n    <span>// to be continued...</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br></div></div><p>看了一下，确实。找到了范围最大的节点之后，把它和 <code>sub[start]</code> 交换，然后把 <code>sub[start+1:i]</code> 全部合并进 <code>sub[start]</code> 。再看一下 <code>mergeCharClass()</code> 内部。</p>\n<div><pre><code><span>func</span> <span>mergeCharClass</span><span>(</span>dst<span>,</span> src <span>*</span>Regexp<span>)</span> <span>{</span>\n    <span>switch</span> dst<span>.</span>Op <span>{</span>\n    <span>case</span> OpAnyChar<span>:</span>\n        <span>// src doesn't add anything.</span>\n    <span>case</span> OpAnyCharNotNL<span>:</span>\n        <span>// src might add \\n</span>\n        <span>if</span> <span>matchRune</span><span>(</span>src<span>,</span> <span>'\\n'</span><span>)</span> <span>{</span>\n            dst<span>.</span>Op <span>=</span> OpAnyChar\n        <span>}</span>\n    <span>case</span> OpCharClass<span>:</span>\n        <span>// src is simpler, so either literal or char class</span>\n        <span>if</span> src<span>.</span>Op <span>==</span> OpLiteral <span>{</span>\n            dst<span>.</span>Rune <span>=</span> <span>appendLiteral</span><span>(</span>dst<span>.</span>Rune<span>,</span> src<span>.</span>Rune<span>[</span><span>0</span><span>]</span><span>,</span> src<span>.</span>Flags<span>)</span>\n        <span>}</span> <span>else</span> <span>{</span>\n            dst<span>.</span>Rune <span>=</span> <span>appendClass</span><span>(</span>dst<span>.</span>Rune<span>,</span> src<span>.</span>Rune<span>)</span>\n        <span>}</span>\n    <span>case</span> OpLiteral<span>:</span>\n        <span>// both literal</span>\n        <span>if</span> src<span>.</span>Rune<span>[</span><span>0</span><span>]</span> <span>==</span> dst<span>.</span>Rune<span>[</span><span>0</span><span>]</span> <span>&amp;&amp;</span> src<span>.</span>Flags <span>==</span> dst<span>.</span>Flags <span>{</span>\n            <span>break</span>\n        <span>}</span>\n        dst<span>.</span>Op <span>=</span> OpCharClass\n        dst<span>.</span>Rune <span>=</span> <span>appendLiteral</span><span>(</span>dst<span>.</span>Rune<span>[</span><span>:</span><span>0</span><span>]</span><span>,</span> dst<span>.</span>Rune<span>[</span><span>0</span><span>]</span><span>,</span> dst<span>.</span>Flags<span>)</span>\n        dst<span>.</span>Rune <span>=</span> <span>appendLiteral</span><span>(</span>dst<span>.</span>Rune<span>,</span> src<span>.</span>Rune<span>[</span><span>0</span><span>]</span><span>,</span> src<span>.</span>Flags<span>)</span>\n    <span>}</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br></div></div><p><code>mergeCharClass()</code> 里面又调用了很多函数，我就不去看了。那些函数里有一些比较麻烦的处理大小写敏感的代码。返回到 <code>factor()</code> 函数，之后调用了 <code>cleanAlt()</code> 函数。</p>\n<div><pre><code><span>func</span> <span>cleanAlt</span><span>(</span>re <span>*</span>Regexp<span>)</span> <span>{</span>\n    <span>switch</span> re<span>.</span>Op <span>{</span>\n    <span>case</span> OpCharClass<span>:</span>\n        re<span>.</span>Rune <span>=</span> <span>cleanClass</span><span>(</span><span>&amp;</span>re<span>.</span>Rune<span>)</span>\n        <span>if</span> <span>len</span><span>(</span>re<span>.</span>Rune<span>)</span> <span>==</span> <span>2</span> <span>&amp;&amp;</span> re<span>.</span>Rune<span>[</span><span>0</span><span>]</span> <span>==</span> <span>0</span> <span>&amp;&amp;</span> re<span>.</span>Rune<span>[</span><span>1</span><span>]</span> <span>==</span> unicode<span>.</span>MaxRune <span>{</span>\n            re<span>.</span>Rune <span>=</span> <span>nil</span>\n            re<span>.</span>Op <span>=</span> OpAnyChar\n            <span>return</span>\n        <span>}</span>\n        <span>if</span> <span>len</span><span>(</span>re<span>.</span>Rune<span>)</span> <span>==</span> <span>4</span> <span>&amp;&amp;</span> re<span>.</span>Rune<span>[</span><span>0</span><span>]</span> <span>==</span> <span>0</span> <span>&amp;&amp;</span> re<span>.</span>Rune<span>[</span><span>1</span><span>]</span> <span>==</span> <span>'\\n'</span><span>-</span><span>1</span> <span>&amp;&amp;</span> re<span>.</span>Rune<span>[</span><span>2</span><span>]</span> <span>==</span> <span>'\\n'</span><span>+</span><span>1</span> <span>&amp;&amp;</span> re<span>.</span>Rune<span>[</span><span>3</span><span>]</span> <span>==</span> unicode<span>.</span>MaxRune <span>{</span>\n            re<span>.</span>Rune <span>=</span> <span>nil</span>\n            re<span>.</span>Op <span>=</span> OpAnyCharNotNL\n            <span>return</span>\n        <span>}</span>\n        <span>if</span> <span>cap</span><span>(</span>re<span>.</span>Rune<span>)</span><span>-</span><span>len</span><span>(</span>re<span>.</span>Rune<span>)</span> <span>></span> <span>100</span> <span>{</span>\n            <span>// re.Rune will not grow any more.</span>\n            <span>// Make a copy or inline to reclaim storage.</span>\n            re<span>.</span>Rune <span>=</span> <span>append</span><span>(</span>re<span>.</span>Rune0<span>[</span><span>:</span><span>0</span><span>]</span><span>,</span> re<span>.</span>Rune<span>...</span><span>)</span>\n        <span>}</span>\n    <span>}</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br></div></div><p><code>cleanAlt()</code> 里是一个迷幻的 <code>switch</code> ，只有一个分支，只有字符类的节点才会被处理。 <code>cleanAlt()</code> 首先调用了 <code>cleanClass()</code> 。</p>\n<div><pre><code><span>func</span> <span>cleanClass</span><span>(</span>rp <span>*</span><span>[</span><span>]</span><span>rune</span><span>)</span> <span>[</span><span>]</span><span>rune</span> <span>{</span>\n\n    <span>// Sort by lo increasing, hi decreasing to break ties.</span>\n    sort<span>.</span><span>Sort</span><span>(</span>ranges<span>{</span>rp<span>}</span><span>)</span>\n\n    r <span>:=</span> <span>*</span>rp\n    <span>if</span> <span>len</span><span>(</span>r<span>)</span> <span>&lt;</span> <span>2</span> <span>{</span>\n        <span>return</span> r\n    <span>}</span>\n\n    <span>// Merge abutting, overlapping.</span>\n    w <span>:=</span> <span>2</span> <span>// write index</span>\n    <span>for</span> i <span>:=</span> <span>2</span><span>;</span> i <span>&lt;</span> <span>len</span><span>(</span>r<span>)</span><span>;</span> i <span>+=</span> <span>2</span> <span>{</span>\n        lo<span>,</span> hi <span>:=</span> r<span>[</span>i<span>]</span><span>,</span> r<span>[</span>i<span>+</span><span>1</span><span>]</span>\n        <span>if</span> lo <span>&lt;=</span> r<span>[</span>w<span>-</span><span>1</span><span>]</span><span>+</span><span>1</span> <span>{</span>\n            <span>// merge with previous range</span>\n            <span>if</span> hi <span>></span> r<span>[</span>w<span>-</span><span>1</span><span>]</span> <span>{</span>\n                r<span>[</span>w<span>-</span><span>1</span><span>]</span> <span>=</span> hi\n            <span>}</span>\n            <span>continue</span>\n        <span>}</span>\n        <span>// new disjoint range</span>\n        r<span>[</span>w<span>]</span> <span>=</span> lo\n        r<span>[</span>w<span>+</span><span>1</span><span>]</span> <span>=</span> hi\n        w <span>+=</span> <span>2</span>\n    <span>}</span>\n\n    <span>return</span> r<span>[</span><span>:</span>w<span>]</span>\n<span>}</span>\n\n<span>type</span> ranges <span>struct</span> <span>{</span>\n    p <span>*</span><span>[</span><span>]</span><span>rune</span>\n<span>}</span>\n\n<span>func</span> <span>(</span>ra ranges<span>)</span> <span>Less</span><span>(</span>i<span>,</span> j <span>int</span><span>)</span> <span>bool</span> <span>{</span>\n    p <span>:=</span> <span>*</span>ra<span>.</span>p\n    i <span>*=</span> <span>2</span>\n    j <span>*=</span> <span>2</span>\n    <span>return</span> p<span>[</span>i<span>]</span> <span>&lt;</span> p<span>[</span>j<span>]</span> <span>||</span> p<span>[</span>i<span>]</span> <span>==</span> p<span>[</span>j<span>]</span> <span>&amp;&amp;</span> p<span>[</span>i<span>+</span><span>1</span><span>]</span> <span>></span> p<span>[</span>j<span>+</span><span>1</span><span>]</span>\n<span>}</span>\n\n<span>func</span> <span>(</span>ra ranges<span>)</span> <span>Len</span><span>(</span><span>)</span> <span>int</span> <span>{</span>\n    <span>return</span> <span>len</span><span>(</span><span>*</span>ra<span>.</span>p<span>)</span> <span>/</span> <span>2</span>\n<span>}</span>\n\n<span>func</span> <span>(</span>ra ranges<span>)</span> <span>Swap</span><span>(</span>i<span>,</span> j <span>int</span><span>)</span> <span>{</span>\n    p <span>:=</span> <span>*</span>ra<span>.</span>p\n    i <span>*=</span> <span>2</span>\n    j <span>*=</span> <span>2</span>\n    p<span>[</span>i<span>]</span><span>,</span> p<span>[</span>i<span>+</span><span>1</span><span>]</span><span>,</span> p<span>[</span>j<span>]</span><span>,</span> p<span>[</span>j<span>+</span><span>1</span><span>]</span> <span>=</span> p<span>[</span>j<span>]</span><span>,</span> p<span>[</span>j<span>+</span><span>1</span><span>]</span><span>,</span> p<span>[</span>i<span>]</span><span>,</span> p<span>[</span>i<span>+</span><span>1</span><span>]</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br></div></div><p>根据上面的代码，可以猜测字符类类型的节点中， <code>Rune</code> 中保存的字符是一对一对的，按照 <code>lo</code> 、 <code>hi</code> 、 <code>lo</code> 、 <code>hi</code> ……这样的规律排列。每一对 <code>lo</code> 、 <code>hi</code> 代表一个范围，范围内的所有字符都属于该字符类。所以 <code>ranges</code> 类型实现了 <code>sort.Interface</code> 接口，能够按照 <code>lo</code> 升序， <code>hi</code> 降序的顺序排序。</p>\n<p><code>cleanClass()</code> 先对 <code>Rune</code> 进行排序，然后消除范围之间的重叠，进行一个压缩。先回到 <code>cleanAlt()</code> ，还没看完呢。里面对达到某些条件的范围进行了类型提升操作，比如如果范围覆盖了所有字符，那么就把节点类型升级为 <code>OpAnyChar</code> 。</p>\n<p>再回到 <code>factor()</code> ，这一轮终于搞完了。</p>\n<div><pre><code>    <span>// Round 4: Collapse runs of empty matches into a single empty match.</span>\n    start <span>=</span> <span>0</span>\n    out <span>=</span> sub<span>[</span><span>:</span><span>0</span><span>]</span>\n    <span>for</span> i <span>:=</span> <span>range</span> sub <span>{</span>\n        <span>if</span> i<span>+</span><span>1</span> <span>&lt;</span> <span>len</span><span>(</span>sub<span>)</span> <span>&amp;&amp;</span> sub<span>[</span>i<span>]</span><span>.</span>Op <span>==</span> OpEmptyMatch <span>&amp;&amp;</span> sub<span>[</span>i<span>+</span><span>1</span><span>]</span><span>.</span>Op <span>==</span> OpEmptyMatch <span>{</span>\n            <span>continue</span>\n        <span>}</span>\n        out <span>=</span> <span>append</span><span>(</span>out<span>,</span> sub<span>[</span>i<span>]</span><span>)</span>\n    <span>}</span>\n    sub <span>=</span> out\n\n    <span>return</span> sub\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br></div></div><p>最后一次循环会把连续的空匹配类型节点合并。<code>factor()</code> 终于看完了，已经都不记得是从哪来的了。回到 <code>collapse()</code> ， <code>factor()</code> 之后就没有什么处理了。只是简单地检查了一下子节点的数量，如果只有一个子节点，那么就用子节点替代本节点的位置。</p>\n<p>再回到 <code>concat()</code> ，终于结束了，继续返回。回到 <code>parseRightParen()</code> 才发现原来到现在只看了一行而已！</p>\n<div><pre><code><span>func</span> <span>(</span>p <span>*</span>parser<span>)</span> <span>parseRightParen</span><span>(</span><span>)</span> <span>error</span> <span>{</span>\n    p<span>.</span><span>concat</span><span>(</span><span>)</span>\n    <span>if</span> p<span>.</span><span>swapVerticalBar</span><span>(</span><span>)</span> <span>{</span>\n        <span>// pop vertical bar</span>\n        p<span>.</span>stack <span>=</span> p<span>.</span>stack<span>[</span><span>:</span><span>len</span><span>(</span>p<span>.</span>stack<span>)</span><span>-</span><span>1</span><span>]</span>\n    <span>}</span>\n    p<span>.</span><span>alternate</span><span>(</span><span>)</span>\n\n    n <span>:=</span> <span>len</span><span>(</span>p<span>.</span>stack<span>)</span>\n    <span>if</span> n <span>&lt;</span> <span>2</span> <span>{</span>\n        <span>return</span> <span>&amp;</span>Error<span>{</span>ErrUnexpectedParen<span>,</span> p<span>.</span>wholeRegexp<span>}</span>\n    <span>}</span>\n    re1 <span>:=</span> p<span>.</span>stack<span>[</span>n<span>-</span><span>1</span><span>]</span>\n    re2 <span>:=</span> p<span>.</span>stack<span>[</span>n<span>-</span><span>2</span><span>]</span>\n    p<span>.</span>stack <span>=</span> p<span>.</span>stack<span>[</span><span>:</span>n<span>-</span><span>2</span><span>]</span>\n    <span>if</span> re2<span>.</span>Op <span>!=</span> opLeftParen <span>{</span>\n        <span>return</span> <span>&amp;</span>Error<span>{</span>ErrUnexpectedParen<span>,</span> p<span>.</span>wholeRegexp<span>}</span>\n    <span>}</span>\n    <span>// Restore flags at time of paren.</span>\n    p<span>.</span>flags <span>=</span> re2<span>.</span>Flags\n    <span>if</span> re2<span>.</span>Cap <span>==</span> <span>0</span> <span>{</span>\n        <span>// Just for grouping.</span>\n        p<span>.</span><span>push</span><span>(</span>re1<span>)</span>\n    <span>}</span> <span>else</span> <span>{</span>\n        re2<span>.</span>Op <span>=</span> OpCapture\n        re2<span>.</span>Sub <span>=</span> re2<span>.</span>Sub0<span>[</span><span>:</span><span>1</span><span>]</span>\n        re2<span>.</span>Sub<span>[</span><span>0</span><span>]</span> <span>=</span> re1\n        p<span>.</span><span>push</span><span>(</span>re2<span>)</span>\n    <span>}</span>\n    <span>return</span> <span>nil</span>\n<span>}</span>\n</code></pre>\n<div><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br></div></div>",
      "date_published": "2021-06-15T11:59:15.000Z",
      "date_modified": "2021-06-15T11:59:15.000Z",
      "authors": [
        {
          "name": "zenk"
        }
      ],
      "tags": [
        "编译器"
      ]
    }
  ]
}